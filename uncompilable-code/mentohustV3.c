/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2011 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Data declarations

extern _UNKNOWN start; // weak
extern char modes[3]; // idb
extern _UNKNOWN unk_8052403; // weak
extern char aSS[7]; // weak
extern char aRb[]; // idb
extern int dword_8052418[]; // weak
extern int dword_805241C[]; // weak
extern int dword_8054418[]; // weak
extern int dword_805441C[]; // weak
extern int dword_8054C18[]; // weak
extern int dword_8054C1C[]; // weak
extern int dword_8055418[]; // weak
extern int dword_805541C[]; // weak
extern int dword_8055C18[]; // weak
extern int dword_8055C1C[]; // weak
extern int dword_8056418[]; // weak
extern int dword_805641C[]; // weak
extern int dword_8056C18[]; // weak
extern int dword_8056C1C[]; // weak
extern int dword_8057418[]; // weak
extern int dword_805741C[]; // weak
extern int dword_8057C18[]; // weak
extern int dword_8057C1C[]; // weak
extern int dword_8058418[]; // weak
extern int dword_805841C[]; // weak
extern char s2[]; // idb
extern char a02x[5]; // weak
extern char src[]; // idb
extern char aW32n55_dll[]; // idb
extern char aSuconfig_dat[]; // idb
extern char aTitle[6]; // weak
extern char aPublic[7]; // weak
extern int (__cdecl *off_80584AC[5])(int, int); // weak
extern char byte_80584D1[]; // weak
extern char file[]; // idb
extern char aLibnotify_so_1[]; // idb
extern char aCiuxAlibnotify[68]; // weak
extern char name[]; // idb
extern char aNotify_notific[]; // idb
extern char aNotify_notif_0[]; // idb
extern char aNotify_notif_1[]; // idb
extern char aNotify_notif_2[]; // idb
extern char aFOlibnotifysoX[39]; // weak
extern char aMentohust[10]; // weak
extern char aMentohust_0[10]; // weak
extern char aXiaxzlxmclibno[32]; // weak
extern char aCiuxAlibpcapxd[66]; // weak
extern char aPcap_findallde[]; // idb
extern char aPcap_freeallde[]; // idb
extern char aPcap_open_live[]; // idb
extern char aPcap_compile[]; // idb
extern char aPcap_setfilter[]; // idb
extern char aPcap_geterr[]; // idb
extern char aPcap_freecode[]; // idb
extern char aPcap_loop[]; // idb
extern char aPcap_close[]; // idb
extern char aPcap_breakloop[]; // idb
extern char aPcap_sendpacke[]; // idb
extern char aFOlibpcapsoXpc[37]; // weak
extern char *off_805875C[5]; // weak
extern char aXxghlmxhzb[11]; // weak
extern char aCiasaicczfScca[55]; // weak
extern char a02x_0[6]; // weak
extern char aXovciClpciicMD[27]; // weak
extern char aMd5cznxnrS[18]; // weak
extern char aCXS8021x_exefB[59]; // weak
extern char aV2cabskmxaS[20]; // weak
extern char aCXSw32n55_dllf[60]; // weak
extern char aV3cabskmxaS[20]; // weak
extern char aD_D_D_D[12]; // weak
extern char aXiixXeccoexncx[27]; // weak
extern char aXIcSxnbSfKsoXp[34]; // weak
extern char aXIcSxnbSfKso_0[44]; // weak
extern char aCMcMacS[18]; // weak
extern char aFCfiipS[17]; // weak
extern char aXnrcScoicabS[21]; // weak
extern char aXIcSxnbSfKso_1[35]; // weak
extern char fromcode[]; // idb
extern char tocode[]; // idb
extern char aCmzxoCDsuconfi[41]; // weak
extern char s[]; // idb
extern int dword_80589C0; // weak
extern int dword_80589C4; // weak
extern int dword_80589C8; // weak
extern int dword_80589CC; // weak
extern _UNKNOWN unk_80589D0; // weak
extern _UNKNOWN unk_8058A10; // weak
extern _UNKNOWN unk_8058BD0; // weak
extern _UNKNOWN unk_8058C30; // weak
extern char *off_8058E30; // idb
extern char aCiFNxiCNxkbxsi[39]; // weak
extern char aXpssabcficiXrn[42]; // weak
extern char aXpssabxpjcabsE[39]; // weak
extern char aCnixasxunxFxme[42]; // weak
extern char aCngxIsoXpcip__[22]; // weak
extern char aCunfCUcaquav[20]; // weak
extern char aXpCiCNxkbxsi__[23]; // weak
extern char aXpssabcficiX_0[23]; // weak
extern char aXpssabxpjcab__[20]; // weak
extern char aSodspbcoicQMxA[33]; // weak
extern char aXpssabxGsXmefE[38]; // weak
extern _UNKNOWN unk_8058FA8; // weak
extern char aCqeciCSxnbxdSE[27]; // weak
extern char aAny[]; // idb
extern char aCSxnbDS[19]; // weak
extern char aCiFNxiCSxnbqB[23]; // weak
extern char a__SpSaiclicSxn[27]; // weak
extern char aCvisaiclifJcmm[36]; // weak
extern char aHttpCode_googl[47]; // weak
extern char a0_3_4[6]; // weak
extern char aCmvsOfCfimento[166]; // weak
extern char aUsername[9]; // weak
extern char aPassword[9]; // weak
extern char aNic[4]; // weak
extern char aDatafile[9]; // weak
extern char aDhcpscript[11]; // weak
extern char aVersion[8]; // weak
extern char aU_U[6]; // weak
extern char a255_255_255_25[]; // idb
extern char aIp[3]; // weak
extern char aMask[5]; // weak
extern char a0_0_0_0[]; // idb
extern char aGateway[8]; // weak
extern char aDns[4]; // weak
extern char aPinghost[9]; // weak
extern char aTimeout[8]; // weak
extern char aEchointerval[13]; // weak
extern char aRestartwait[12]; // weak
extern char aStartmode[10]; // weak
extern char aDhcpmode[9]; // weak
extern char aShownotify[11]; // weak
extern char aDaemonmode[11]; // weak
extern char aMaxfail[8]; // weak
extern char aHelp[]; // idb
extern char aCficXSSaisbXpv[1180]; // weak
extern char aSXeelibpcapxdS[46]; // weak
extern char aMentohustSfssp[25]; // weak
extern char aCiFNxiCSxnbq_0[19]; // weak
extern char a__SpSUxeecfici[24]; // weak
extern char a__SpSUxeexpjca[21]; // weak
extern char a__SpSaiclicDct[58]; // weak
extern char a__SpSaiclidhcp[73]; // weak
extern char aCiuxAsfbcczfXd[25]; // weak
extern char aSoXpccczfSfbxd[25]; // weak
extern char aXXpssabsaaxzFB[53]; // weak
extern char aCUcaqsIcilxdSE[]; // idb
extern char aCBcImentohustc[35]; // weak
extern char aMentohustxCPsR[35]; // weak
extern char aSIxeexroxpSRsb[64]; // weak
extern char aXroxpSRsbmxdSE[]; // idb
extern char aA[]; // idb
extern char aXkasfbxdSE[]; // idb
extern char aCunfSfbcczfXdS[56]; // weak
extern char aCficiXrnS[18]; // weak
extern char aCSxnbS[16]; // weak
extern char aCSxeXXaaS[21]; // weak
extern char aDnsxXaaS[18]; // weak
extern char aCsSgSznsUS[21]; // weak
extern char aSodspbsEccUczt[24]; // weak
extern char aXGsScSFUczt[24]; // weak
extern char aXdSEcnixEUczt[24]; // weak
extern char aXebsoXdSEUcmb[24]; // weak
extern char aCDctnxXaaS[21]; // weak
extern char aDhcpccXPS[19]; // weak
extern char aSaCqesEccDczt[24]; // weak
extern char aCxCnocczfS[21]; // weak
extern char aDhcpsdCMS[19]; // weak
extern char aSoXpcmacxXaaci[40]; // weak
extern char aDatafile_0[9]; // weak
extern char a0_00[]; // idb
extern char aFAxnssodspbxpv[37]; // weak
extern char aSodspbxpvcxXCi[38]; // weak
extern char *off_8059BD8[2]; // weak
extern char *off_8059BDC; // idb
extern char byte_8059BE0[]; // weak
extern char byte_8059C24[]; // weak
extern char *off_8059C70; // idb
extern char *off_8059C74; // idb
extern char *off_8059C78[7]; // weak
extern char *off_8059C88[3]; // weak
extern char aXpssabcxCnoxme[52]; // weak
extern char aXpssabcxCnox_0[48]; // weak
extern char aCCQcprcdS[21]; // weak
extern char aMentohustCCQcp[25]; // weak
extern char aSodspbmacS[18]; // weak
extern char aUserName[10]; // weak
extern char aSodspbcirxkq[18]; // weak
extern char aSodspbxdSE[18]; // weak
extern char aSUcNsodspbxdSE[46]; // weak
extern char aCSxeMacS[18]; // weak
extern char aArpSSS[13]; // weak
extern char aArpcmSkcS[18]; // weak
extern char aCmSkccRS[14]; // weak
extern char aMentohustArpcp[22]; // weak
extern char aSodspbxSaaxzUa[23]; // weak
extern int dword_805AF00; // weak
extern int dword_805AF08[]; // weak
extern _UNKNOWN unk_805AF0C; // weak
extern int dword_805AF10; // weak
extern _UNKNOWN unk_805B0E0; // weak
extern _UNKNOWN unk_805B0E4; // weak
extern _UNKNOWN unk_805B124; // weak
extern _UNKNOWN unk_805B164; // weak
extern int dword_805B1A4; // weak
extern char byte_805B1A8; // idb
extern char byte_805B1EC; // idb
extern char dest; // idb
extern char byte_805B23E[]; // weak
extern char filename; // idb
extern char command; // idb
extern int dword_805B440; // weak
extern int dword_805B444; // weak
extern int dword_805B448; // weak
extern int dword_805B44C; // weak
extern int fd; // idb
extern FILE *stderr; // idb
extern FILE *stdout; // idb
extern char byte_805B484; // weak
extern int dword_805B488; // weak
extern _UNKNOWN unk_805B48C; // weak
extern void *dword_805B49C; // idb
extern void *ptr; // idb
extern int dword_805B4A4; // weak
extern int dword_805B4A8; // weak
extern int dword_805B4AC; // weak
extern _UNKNOWN dword_805B4B0; // weak
extern void *handle; // idb
extern void *dword_805B4B8; // idb
extern int (__cdecl *dword_805B4BC)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__cdecl *dword_805B4C0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_805B4C4)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern size_t size; // idb
extern size_t dword_805B4CC; // idb
extern int dword_805B4D0; // weak
extern int dword_805B4D4; // weak
extern int dword_805B4D8; // weak
extern int dword_805B4DC; // weak
extern _UNKNOWN unk_805B4E0; // weak
extern _UNKNOWN unk_805B664; // weak
extern int dword_805B674; // weak
extern int dword_805B678; // weak
extern int dword_805B67C; // weak
extern int dword_805B680; // weak
extern int dword_805B684; // weak
extern __int16 word_805B688; // weak
extern int dword_805B68A; // weak
extern __int16 word_805B68E; // weak
extern int dword_805B690; // weak
extern __int16 word_805B694; // weak
extern char byte_805B696; // weak
extern char byte_805B697; // weak
extern __int16 word_805B698; // weak
extern char byte_805B69A[]; // weak
extern char byte_805B69B; // weak
extern _UNKNOWN unk_805B69C; // weak
extern _UNKNOWN unk_805B6AB; // weak
extern int dword_805B6AC; // weak
extern int dword_805B6B0; // weak
extern _UNKNOWN unk_805B6B4; // weak
extern int dword_805BA6C; // weak
extern int dword_805BA70; // weak
extern int dword_805BA74; // weak
extern int dword_805BA78; // weak
extern int dword_805BA7C; // weak
extern int dword_805BA80; // weak
extern int dword_805BA84; // weak
extern int status; // idb
extern int dword_805BA8C; // weak
extern int (__cdecl *dword_805BA90)(_DWORD, _DWORD); // weak
extern int (__cdecl *dword_805BA94)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__cdecl *dword_805BA98)(_DWORD); // weak
extern int dword_805BA9C; // weak
extern int dword_805BAA0; // weak
extern int dword_805BAA4; // weak
extern int (__fastcall *dword_805BAA8)(_DWORD, _DWORD); // weak
extern int (__cdecl *dword_805BAAC)(_DWORD); // weak
extern int dword_805BAB0; // weak
extern int dword_805BAB4; // weak
extern int dword_805BAB8; // weak
extern __int16 word_805BABC; // weak
extern int dword_805BAC0; // weak
extern __int16 word_805BAC4; // weak
extern int dword_805BAC8; // weak
extern __int16 word_805BACC; // weak
extern _DWORD dword_805BAD0; // idb
extern __int16 word_805BAD4; // weak
// extern _UNKNOWN _gmon_start__; weak

//-------------------------------------------------------------------------
// Function declarations

int __cdecl init_proc();
// int open(const char *file, int oflag, ...);
// __pid_t getpid(void);
// int __cdecl __cxa_atexit(_DWORD, _DWORD, _DWORD); weak
// int daemon(int nochdir, int noclose);
// int memcmp(const void *s1, const void *s2, size_t n);
// int __gmon_start__(void); weak
// iconv_t iconv_open(const char *tocode, const char *fromcode);
// void rewind(FILE *stream);
// int __isoc99_sscanf(_DWORD, const char *, ...); weak
// int __printf_chk(_DWORD, const char *, ...); weak
// in_addr_t inet_addr(const char *cp);
// int system(const char *command);
// char *strncpy(char *dest, const char *src, size_t n);
// ssize_t sendto(int fd, const void *buf, size_t n, int flags, const struct sockaddr *addr, socklen_t addr_len);
// int dlclose(void *handle);
// int setitimer(__itimer_which_t which, const struct itimerval *new, struct itimerval *old);
// int __cdecl __memcpy_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// char *strrchr(const char *s, int c);
// void perror(const char *s);
// int __cdecl __strcat_chk(_DWORD, _DWORD, _DWORD); weak
// void free(void *ptr);
// void *dlsym(void *handle, const char *name);
// int ioctl(int fd, unsigned __int32 request, ...);
// int socket(int domain, int type, int protocol);
// int fseek(FILE *stream, __int32 off, int whence);
// int fclose(FILE *stream);
// FILE *fopen(const char *filename, const char *modes);
// size_t iconv(iconv_t cd, char **inbuf, size_t *inbytesleft, char **outbuf, size_t *outbytesleft);
// FILE *freopen(const char *filename, const char *modes, FILE *stream);
// char *strcpy(char *dest, const char *src);
// void *dlopen(const char *file, int mode);
// __int32 ftell(FILE *stream);
// __uid_t getuid(void);
// int atoi(const char *nptr);
// int __cdecl __strcpy_chk(_DWORD, _DWORD, _DWORD); weak
// int close(int fd);
// size_t fwrite(const void *ptr, size_t size, size_t n, FILE *s);
// int setvbuf(FILE *stream, char *buf, int modes, size_t n);
// void *malloc(size_t size);
// int __fastcall __stack_chk_fail(_DWORD, _DWORD); weak
// int iconv_close(iconv_t cd);
// char *dlerror(void);
// int poll(struct pollfd *fds, nfds_t nfds, int timeout);
// int __isoc99_scanf(const char *, ...); weak
// int strncasecmp(const char *s1, const char *s2, size_t n);
// void *memmove(void *dest, const void *src, size_t n);
// int fcntl(int fd, int cmd, ...);
// int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...); weak
// size_t fread(void *ptr, size_t size, size_t n, FILE *stream);
// int seteuid(__uid_t uid);
// int kill(__pid_t pid, int sig);
// int strcmp(const char *s1, const char *s2);
// void exit(int status);
void __cdecl sub_8049020();
int __cdecl sub_8049080();
int __cdecl sub_80490A4(const void *stream, const char *filename);
// signed int __usercall sub_80490F9<eax>(int a1<eax>, const char *a2<edx>, const char *a3<ecx>, int a4, int a5, int a6);
void __cdecl sub_804920F(int *a1, const char *a2, const char *a3, const char *src);
int __cdecl sub_80494FC(int *a1, const char *a2, const char *a3, int a4);
signed int __cdecl sub_804955C(int a1, const char *a2, const char *a3, const char *src, char *dest, size_t n);
int __cdecl sub_80495D3(int a1, const char *a2, const char *a3, int a4);
__int32 __cdecl sub_804963D(void **a1, const char *filename);
// int __usercall sub_80496F9<eax>(int a1<eax>, int a2<edx>);
unsigned int __cdecl sub_8049E5B(int a1, const void *a2, unsigned int a3);
int __cdecl sub_8049EEF(int a1, int a2);
_UNKNOWN *__cdecl sub_8049FC5(const void *a1, unsigned int a2);
// int __usercall sub_804A06D<eax>(int a1<eax>, int a2<edx>);
unsigned int __cdecl sub_804A86D(int a1, const void *a2, unsigned int a3);
int __cdecl sub_804A901(int a1, int a2);
int __cdecl sub_804A9D7(const void *a1, int a2, unsigned int a3);
// int __usercall sub_804AA4C<eax>(int a1<eax>, int a2<edx>);
// int __usercall sub_804AD9F<eax>(int result<eax>, int a2<edx>, unsigned int a3<ecx>);
int __cdecl sub_804ADD9(int a1);
void __cdecl sub_804AE10(int a1, const void *a2, unsigned int a3);
int __cdecl sub_804AEED(int a1, int a2);
int __cdecl sub_804AF94(const void *a1, int a2, unsigned int a3);
int __cdecl sub_804AFE8(int a1);
int __cdecl sub_804B01D(int a1);
int __cdecl sub_804BC9B(int a1, int a2, unsigned int a3, int a4);
// int __usercall sub_804BD98<eax>(int a1<eax>, int a2<edx>, int a3<ecx>, int a4, int a5, __int64 a6);
// int __usercall sub_804BEE0<eax>(int a1<eax>, int a2<edx>, int a3<ecx>, int a4, __int64 a5);
// int __usercall sub_804BFB5<eax>(int result<eax>);
void __cdecl sub_804C1D1(int a1);
int __cdecl sub_804C34E(int a1);
int __cdecl sub_804C383(int a1, int a2, unsigned int a3, int a4);
int __cdecl sub_804C480(int a1);
int __cdecl sub_804DB51(int a1);
int __cdecl sub_804DBCC(int a1, int a2);
int __cdecl sub_804DC36(int a1, unsigned int a2, int a3, int a4);
int __cdecl sub_804DD86(int a1, int a2);
void __cdecl sub_804DE0D();
signed int __cdecl sub_804DE53(const char *filename);
// void *__usercall sub_804DFD3<eax>(const char *a1<eax>, size_t *a2<edx>);
// void *__usercall sub_804E0D7<eax>(const char *a1<eax>, size_t *a2<edx>, int a3<ecx>);
int __cdecl sub_804E1FD(int a1, int a2);
int __cdecl sub_804E3AD(const void *a1, int a2);
int __cdecl sub_804E50D(int a1, int a2);
int __cdecl sub_804E681(int a1, int a2);
int __cdecl sub_804E77E(int a1, int a2);
int __cdecl sub_804E82F(int a1, int a2);
// int __usercall sub_804E9B3<eax>(int a1<eax>, unsigned int a2<edx>, unsigned int a3<ecx>, int a4);
signed int __cdecl sub_804EAD1(const char *filename, unsigned int a2, int a3);
signed int __cdecl sub_804EB10(const char *a1);
char *__cdecl sub_804ECD0();
signed int __cdecl sub_804ECFC(int a1, int a2, int a3);
char *__cdecl sub_804EEE1();
signed int __cdecl sub_804EF0D();
// int __usercall sub_804F12C<eax>(int a1<eax>);
int __cdecl sub_804F1C4(int a1);
int __cdecl sub_804F21C(int a1);
int __cdecl sub_804F2B5(int a1);
// signed int __usercall sub_804F2DF<eax>(char a1<al>, const void *a2<edx>, unsigned int a3<ecx>);
_UNKNOWN *__cdecl sub_804F337(char a1, const void *a2, unsigned int a3);
// signed int __usercall sub_804F3E1<eax>(signed int a1<eax>);
int __cdecl sub_804F529();
int sub_804F612(void); // weak
int __cdecl sub_804F6B8();
_UNKNOWN *__cdecl sub_804F81D(int a1, signed int a2);
// signed int __usercall sub_804F87B<eax>(int a1<eax>);
_DWORD __cdecl sub_804F996(_DWORD); // weak
_UNKNOWN *__cdecl sub_804F9EA(int a1);
// signed int __usercall sub_804FA1E<eax>(int a1<edi>);
char *__cdecl sub_804FCA7(char *inbuf, size_t inbytesleft);
int __cdecl sub_804FD31(const char *filename);
signed int __fastcall sub_804FDC1(int a1);
// int __usercall sub_804FED8<eax>(__time_t a1<eax>);
int __cdecl sub_804FF04();
// __int16 __usercall sub_804FF3E<ax>(unsigned int a1<eax>);
// int __usercall sub_804FF8D<eax>(int a1<ecx>, int a2<edi>, signed int a3);
int sub_8050700(void); // weak
signed int __cdecl sub_80507EF();
// signed int __usercall sub_8050962<eax>(int a1<eax>);
// void __usercall sub_8050A90(char *a1<edi>, char a2, int a3);
// int __usercall sub_8051C26<eax>(int a1<ecx>, int a2<edi>, int a3);
// void __usercall sub_8051CBB(int a1<eax>, unsigned int a2<edx>);
int __fastcall sub_8051E1A(int a1, size_t a2, int a3, int a4, int a5);
// int __usercall sub_8052279<eax>(int a1<ecx>, int a2<edi>);
void __cdecl sub_8052300();
int *__cdecl sub_8052310();
void __cdecl sub_805236A();
int __cdecl sub_8052370(int a1);
void (*__cdecl sub_80523B0())(void);
void __cdecl term_proc();


//----- (08048C40) --------------------------------------------------------
int __cdecl init_proc()
{
  int v1; // [sp+0h] [bp-8h]@0

  if ( &_gmon_start__ )
    __gmon_start__();
  sub_8049080();
  sub_80523B0();
  return v1;
}
// 8048CE0: using guessed type int __gmon_start__(void);

//----- (08048FF0) --------------------------------------------------------
#error "8048FF3: positive sp value has been found (funcsize=2)"

//----- (08049020) --------------------------------------------------------
void __cdecl sub_8049020()
{
  int v0; // eax@2
  int i; // ebx@2

  if ( !byte_805B484 )
  {
    v0 = dword_805B488;
    for ( i = ((signed int)(&unk_805AF0C - (_UNKNOWN *)dword_805AF08) >> 2) - 1;
          dword_805B488 < (unsigned int)i;
          v0 = dword_805B488 )
    {
      dword_805B488 = v0 + 1;
      ((void (*)(void))dword_805AF08[v0 + 1])();
    }
    byte_805B484 = 1;
  }
}
// 805AF08: using guessed type int dword_805AF08[];
// 805B484: using guessed type char byte_805B484;
// 805B488: using guessed type int dword_805B488;

//----- (08049080) --------------------------------------------------------
int __cdecl sub_8049080()
{
  int result; // eax@1

  result = dword_805AF10;
  if ( dword_805AF10 )
    result = 0;
  return result;
}
// 805AF10: using guessed type int dword_805AF10;

//----- (080490A4) --------------------------------------------------------
int __cdecl sub_80490A4(const void *stream, const char *filename)
{
  int v2; // edi@1
  FILE *v3; // ebx@1

  v2 = -1;
  v3 = fopen(filename, "wb");
  if ( v3 )
  {
    v2 = -(fwrite(stream, strlen((const char *)stream), 1u, v3) < 1);
    fclose(v3);
  }
  return v2;
}

//----- (080490F9) --------------------------------------------------------
signed int __usercall sub_80490F9<eax>(int a1<eax>, const char *a2<edx>, const char *a3<ecx>, int a4, int a5, int a6)
{
  int v6; // esi@1
  int v7; // ebx@1
  const char *v8; // ecx@2
  const char v9; // al@3
  int v10; // edi@7
  char v11; // dl@9
  int v12; // edi@13
  int i; // eax@13
  char v14; // dl@16
  int v15; // edi@25
  int v16; // eax@25
  char v17; // dl@28
  int v18; // edi@31
  int v20; // [sp+Ch] [bp-2Ch]@7
  const char *s2; // [sp+14h] [bp-24h]@1
  const char *v22; // [sp+18h] [bp-20h]@1

  v6 = 0;
  v7 = a1;
  s2 = a2;
  v22 = a3;
  *(_DWORD *)a4 = -1;
LABEL_32:
  while ( 1 )
  {
    v8 = (const char *)(v7 + v6);
    if ( !*(_BYTE *)(v7 + v6) )
      return -1;
    while ( 1 )
    {
      v9 = *v8;
      if ( *v8 != 9 )
      {
        if ( v9 != 32 && v9 != 13 && v9 != 10 )
          break;
      }
      ++v6;
      ++v8;
    }
    v10 = v7 + v6;
    v20 = v6;
    while ( 1 )
    {
      v11 = *(_BYTE *)v10;
      if ( *(_BYTE *)v10 == 10 )
        break;
      if ( v11 == 13 )
        break;
      ++v10;
      if ( !v11 )
        break;
      ++v6;
    }
    if ( v9 == 91 )
    {
      v12 = v7 + v20;
      for ( i = v20 + 1; i < v6; ++i )
      {
        v14 = *(_BYTE *)(v12++ + 1);
        if ( v14 == 93 )
        {
          if ( !strncasecmp((const char *)(v7 + v20 + 1), s2, i - (v20 + 1)) )
          {
            *(_DWORD *)a4 = v20;
            if ( v22 )
              goto LABEL_32;
            return -1;
          }
          break;
        }
      }
      if ( *(_DWORD *)a4 == -1 )
        continue;
      return -1;
    }
    if ( *(_DWORD *)a4 != -1 && v9 != 35 && v9 != 59 )
    {
      v15 = v20 + 1;
      v16 = v7 + v20;
      while ( v15 < v6 )
      {
        v17 = *(_BYTE *)(v16++ + 1);
        if ( v17 == 61 )
          break;
        ++v15;
      }
      if ( v15 < v6 && !strncasecmp(v8, v22, v15 - v20) )
      {
        v18 = v15 + 1;
        *(_DWORD *)a5 = v18;
        *(_DWORD *)a6 = v6 - v18;
        return 0;
      }
    }
  }
}

//----- (0804920F) --------------------------------------------------------
void __cdecl sub_804920F(int *a1, const char *a2, const char *a3, const char *src)
{
  signed int v4; // eax@1
  int v5; // edx@2
  int v6; // edi@3
  signed int v7; // ecx@3
  char v8; // zf@5
  const char *v9; // edi@6
  signed int v10; // esi@6
  signed int v11; // ecx@6
  void *v12; // ST2C_4@10
  int v13; // ebx@13
  int i; // edx@13
  int v15; // ecx@14
  int v16; // esi@19
  int v17; // ecx@19
  signed int v18; // edi@19
  char v19; // al@21
  int v20; // esi@25
  int v21; // edi@25
  char v22; // dl@28
  signed int v23; // edx@29
  int v24; // edi@38
  signed int v25; // ecx@38
  const char *v26; // edi@41
  signed int v27; // edx@41
  signed int v28; // ecx@41
  void *v29; // eax@44
  const char *v30; // edi@44
  signed int v31; // ecx@44
  int v32; // esi@44
  int v33; // edi@50
  int v34; // ecx@50
  const char *v35; // edi@53
  int v36; // ecx@53
  const char *v37; // edi@56
  int v38; // edx@56
  int v39; // ecx@56
  int v40; // edx@56
  const char *v41; // edi@59
  int v42; // esi@59
  int v43; // ecx@59
  void *v44; // esi@62
  void *v45; // edi@62
  int v46; // ecx@62
  int v47; // [sp-Ch] [bp-48h]@9
  int v48; // [sp-8h] [bp-44h]@9
  size_t v49; // [sp-4h] [bp-40h]@9
  int v50; // [sp+8h] [bp-34h]@53
  int v51; // [sp+10h] [bp-2Ch]@11
  const char *v52; // [sp+10h] [bp-2Ch]@44
  int v53; // [sp+18h] [bp-24h]@1
  unsigned int v54; // [sp+1Ch] [bp-20h]@1
  int v55; // [sp+20h] [bp-1Ch]@1

  v4 = sub_80490F9(*a1, a2, a3, (int)&v55, (int)&v54, (int)&v53);
  if ( !v4 )
  {
    v5 = *a1;
    if ( src )
    {
      v12 = malloc(strlen(src) + 1 + strlen((const char *)*a1) + 1 - v53 - 1);
      memcpy(v12, (const void *)*a1, v54);
      strcpy((char *)v12 + v54, src);
      strcpy((char *)v12 + v54 + strlen(src), (const char *)(*a1 + v54 + v53));
      free((void *)*a1);
      *a1 = (int)v12;
      return;
    }
    v6 = *a1;
    v7 = -1;
    do
    {
      if ( !v7 )
        break;
      v8 = *(_BYTE *)v6++ == 0;
      --v7;
    }
    while ( !v8 );
    v9 = a3;
    v10 = v7;
    v11 = -1;
    do
    {
      if ( !v11 )
        break;
      v8 = *v9++ == 0;
      --v11;
    }
    while ( !v8 );
    v49 = ~v10 + 1 - v53 - v54 - 1;
    v48 = v5 + v53 + v54;
    v47 = v54 + v11 + 1 + v5;
LABEL_36:
    memmove((void *)v47, (const void *)v48, v49);
    return;
  }
  v51 = v55;
  if ( v55 == -1 )
  {
    if ( src && a3 )
    {
      v33 = *a1;
      v34 = v55;
      do
      {
        if ( !v34 )
          break;
        v8 = *(_BYTE *)v33++ == 0;
        --v34;
      }
      while ( !v8 );
      v35 = a2;
      v50 = v34;
      v36 = v55;
      do
      {
        if ( !v36 )
          break;
        v8 = *v35++ == 0;
        --v36;
      }
      while ( !v8 );
      v37 = a3;
      v38 = v36;
      v39 = v55;
      v40 = ~v38 - v50;
      do
      {
        if ( !v39 )
          break;
        v8 = *v37++ == 0;
        --v39;
      }
      while ( !v8 );
      v41 = src;
      v42 = v39;
      v43 = v55;
      do
      {
        if ( !v43 )
          break;
        v8 = *v41++ == 0;
        --v43;
      }
      while ( !v8 );
      v44 = malloc(~v43 - v42 + v40 + 2);
      v45 = v44;
      strcpy((char *)v44, (const char *)*a1);
      v46 = v51;
      do
      {
        if ( !v46 )
          break;
        v8 = *(_BYTE *)v45 == 0;
        v45 = (char *)v45 + 1;
        --v46;
      }
      while ( !v8 );
      __sprintf_chk((char *)v44 + ~v46 - 1, 1, -1, (const char *)&unk_8052403, a2);
      free((void *)*a1);
      *a1 = (int)v44;
    }
  }
  else
  {
    if ( !a3 )
    {
      v13 = *a1;
      for ( i = v55 + 3; ; i = v17 )
      {
        v15 = v13 + i;
        if ( !*(_BYTE *)(v13 + i) )
          break;
        while ( 1 )
        {
          LOBYTE(v4) = *(_BYTE *)v15;
          if ( *(_BYTE *)v15 != 9 )
          {
            if ( (_BYTE)v4 != 32 && (_BYTE)v4 != 13 && (_BYTE)v4 != 10 )
              break;
          }
          ++i;
          ++v15;
        }
        v16 = v13 + i;
        v17 = i;
        v18 = v4;
        while ( 1 )
        {
          v19 = *(_BYTE *)v16;
          if ( *(_BYTE *)v16 == 10 )
            break;
          if ( v19 == 13 )
            break;
          ++v16;
          if ( !v19 )
            break;
          ++v17;
        }
        v4 = v18;
        if ( (_BYTE)v18 == 91 )
        {
          v20 = i + 1;
          v21 = i;
          v4 = v13 + i;
          while ( v20 < v17 )
          {
            v22 = *(_BYTE *)(v4++ + 1);
            if ( v22 == 93 )
            {
              v23 = v21;
              goto LABEL_33;
            }
            ++v20;
          }
        }
      }
      v23 = -1;
LABEL_33:
      v54 = v23;
      if ( v23 <= v55 )
      {
        *(_BYTE *)(v13 + v55) = 0;
        return;
      }
      v49 = strlen((const char *)v13) + 1 - v23;
      v48 = v13 + v23;
      v47 = v55 + v13;
      goto LABEL_36;
    }
    if ( src )
    {
      v24 = *a1;
      v25 = -1;
      do
      {
        if ( !v25 )
          break;
        v8 = *(_BYTE *)v24++ == 0;
        --v25;
      }
      while ( !v8 );
      v26 = a3;
      v27 = v25;
      v28 = -1;
      do
      {
        if ( !v28 )
          break;
        v8 = *v26++ == 0;
        --v28;
      }
      while ( !v8 );
      v29 = malloc(strlen(src) + 1 + -v27 - v28 - 1);
      v30 = a2;
      v31 = -1;
      v32 = *a1;
      v52 = (const char *)v29;
      do
      {
        if ( !v31 )
          break;
        v8 = *v30++ == 0;
        --v31;
      }
      while ( !v8 );
      v53 = v55 - v31;
      memcpy(v29, (const void *)v32, v55 - v31);
      __sprintf_chk((char *)v29 + v53, 1, -1, "\n%s=%s", a3, src);
      strcpy((char *)&v52[strlen(v52)], (const char *)(v53 + *a1));
      free((void *)*a1);
      *a1 = (int)v52;
    }
  }
}
// 8048F90: using guessed type int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (080494FC) --------------------------------------------------------
int __cdecl sub_80494FC(int *a1, const char *a2, const char *a3, int a4)
{
  int v4; // edx@1
  int v5; // ecx@1
  int result; // eax@1
  char src; // [sp+23h] [bp-31h]@1
  int v8; // [sp+38h] [bp-1Ch]@1

  v8 = *MK_FP(__GS__, 20);
  __sprintf_chk(&src, 1, 21, "%d", a4);
  sub_804920F(a1, a2, a3, &src);
  result = *MK_FP(__GS__, 20) ^ v8;
  if ( *MK_FP(__GS__, 20) != v8 )
    __stack_chk_fail(v5, v4);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 8048F90: using guessed type int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0804955C) --------------------------------------------------------
signed int __cdecl sub_804955C(int a1, const char *a2, const char *a3, const char *src, char *dest, size_t n)
{
  signed int result; // eax@3
  size_t v7; // ecx@6
  char *v8; // edi@6
  size_t v9; // [sp+8h] [bp-24h]@1
  int v10; // [sp+Ch] [bp-20h]@1
  char v11; // [sp+10h] [bp-1Ch]@1

  if ( !sub_80490F9(a1, a2, a3, (int)&v11, (int)&v10, (int)&v9) && v9 )
  {
    if ( n - 1 < v9 )
      v9 = n - 1;
    v7 = n;
    v8 = dest;
    while ( v7 )
    {
      *v8++ = 0;
      --v7;
    }
    strncpy(dest, (const char *)(v10 + a1), v9);
    result = 0;
  }
  else
  {
    strncpy(dest, src, n);
    result = -1;
  }
  return result;
}

//----- (080495D3) --------------------------------------------------------
int __cdecl sub_80495D3(int a1, const char *a2, const char *a3, int a4)
{
  signed int v4; // ecx@1
  int v5; // ebx@1
  char *v6; // edi@1
  int v7; // ecx@4
  int result; // eax@6
  char dest; // [sp+Fh] [bp-21h]@1
  int v10; // [sp+24h] [bp-Ch]@1

  v4 = 21;
  v5 = a4;
  v10 = *MK_FP(__GS__, 20);
  v6 = &dest;
  while ( v4 )
  {
    *v6++ = 0;
    --v4;
  }
  sub_804955C(a1, a2, a3, "", &dest, 0x15u);
  if ( dest )
    v5 = atoi(&dest);
  result = v5;
  if ( *MK_FP(__GS__, 20) != v10 )
    __stack_chk_fail(v7, *MK_FP(__GS__, 20) ^ v10);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804963D) --------------------------------------------------------
__int32 __cdecl sub_804963D(void **a1, const char *filename)
{
  __int32 v2; // ebx@1
  FILE *v3; // eax@1
  FILE *v4; // esi@1
  void *v5; // eax@2

  v2 = -1;
  v3 = fopen(filename, "rb");
  v4 = v3;
  if ( v3 )
  {
    fseek(v3, 0, 2);
    v2 = ftell(v4);
    rewind(v4);
    v5 = malloc(v2 + 1);
    *a1 = v5;
    *((_BYTE *)v5 + v2) = 0;
    if ( !fread(v5, v2, 1u, v4) )
    {
      v2 = -1;
      free(*a1);
    }
    fclose(v4);
  }
  return v2;
}

//----- (080496F9) --------------------------------------------------------
int __usercall sub_80496F9<eax>(int a1<eax>, int a2<edx>)
{
  int v2; // ebx@1
  int v3; // esi@1
  int v4; // ecx@1
  int v5; // edx@3
  int v6; // edx@3
  int v7; // eax@3
  int v8; // eax@3
  int v9; // ecx@3
  int v10; // ecx@3
  int v11; // ebx@3
  int v12; // ebx@3
  int v13; // edx@3
  int v14; // edx@3
  int v15; // eax@3
  int v16; // eax@3
  int v17; // esi@3
  int v18; // esi@3
  int v19; // ecx@3
  int v20; // ecx@3
  int v21; // edx@3
  int v22; // edx@3
  int v23; // ebx@3
  int v24; // ebx@3
  int v25; // eax@3
  int v26; // eax@3
  int v27; // ecx@3
  int v28; // ecx@3
  int v29; // esi@3
  int v30; // esi@3
  int v31; // edx@3
  int v32; // edx@3
  int v33; // eax@3
  int v34; // eax@3
  int v35; // ecx@3
  int v36; // ecx@3
  int v37; // ebx@3
  int v38; // ebx@3
  int v39; // esi@3
  int v40; // esi@3
  int v41; // edx@3
  int v42; // edx@3
  int v43; // eax@3
  int v44; // eax@3
  int v45; // ebx@3
  int v46; // ebx@3
  int v47; // ecx@3
  int v48; // ecx@3
  int v49; // edx@3
  int v50; // edx@3
  int v51; // esi@3
  int v52; // esi@3
  int v53; // eax@3
  int v54; // eax@3
  int v55; // ecx@3
  int v56; // ecx@3
  int v57; // ebx@3
  int v58; // ebx@3
  int v59; // edx@3
  int v60; // edx@3
  int v61; // eax@3
  int v62; // eax@3
  int v63; // esi@3
  int v64; // esi@3
  int v65; // ecx@3
  int v66; // ecx@3
  int v67; // edx@3
  int v68; // edx@3
  int v69; // eax@3
  int v70; // eax@3
  int v71; // ebx@3
  int v72; // ebx@3
  int v73; // ecx@3
  int v74; // ecx@3
  int v75; // edx@3
  int v76; // edx@3
  int v77; // eax@3
  int v78; // eax@3
  int v79; // ebx@3
  int v80; // ebx@3
  int v81; // ecx@3
  int v82; // ecx@3
  int v83; // edx@3
  int v84; // edx@3
  int v85; // esi@3
  int v86; // esi@3
  int v87; // ebx@3
  int v88; // ebx@3
  int v89; // eax@3
  int v90; // eax@3
  int v91; // ecx@3
  int v92; // ecx@3
  int v93; // esi@3
  int v94; // esi@3
  int v95; // edx@3
  int v96; // edx@3
  int v97; // ebx@3
  int v98; // ebx@3
  int v99; // ecx@3
  int v100; // ecx@3
  int v101; // eax@3
  int v102; // eax@3
  int v103; // edx@3
  int v104; // edx@3
  int v105; // ebx@3
  int v106; // ebx@3
  int v107; // ecx@3
  int v108; // ecx@3
  int v109; // esi@3
  int v110; // esi@3
  int v111; // edx@3
  int v112; // edx@3
  int v113; // ebx@3
  int v114; // ebx@3
  int v115; // eax@3
  int v116; // eax@3
  int v117; // ecx@3
  int v118; // ecx@3
  int v119; // edx@3
  int v120; // edx@3
  int v121; // ebx@3
  int v122; // ebx@3
  int v123; // eax@3
  int v124; // eax@3
  int v125; // ecx@3
  int v126; // ecx@3
  int v127; // esi@3
  int v128; // esi@3
  int v129; // edx@3
  int v130; // edx@3
  int v131; // eax@3
  int result; // eax@3
  int v133; // [sp+0h] [bp-68h]@1
  int v134; // [sp+4h] [bp-64h]@1
  int v135; // [sp+10h] [bp-58h]@1
  int v136; // [sp+14h] [bp-54h]@1
  int v137; // [sp+18h] [bp-50h]@1
  int v138; // [sp+1Ch] [bp-4Ch]@2
  int v139; // [sp+20h] [bp-48h]@3
  int v140; // [sp+24h] [bp-44h]@3
  int v141; // [sp+28h] [bp-40h]@3
  int v142; // [sp+2Ch] [bp-3Ch]@3
  int v143; // [sp+30h] [bp-38h]@3
  int v144; // [sp+34h] [bp-34h]@3
  int v145; // [sp+38h] [bp-30h]@3
  int v146; // [sp+3Ch] [bp-2Ch]@3
  int v147; // [sp+40h] [bp-28h]@3
  int v148; // [sp+44h] [bp-24h]@3
  int v149; // [sp+48h] [bp-20h]@3
  int v150; // [sp+4Ch] [bp-1Ch]@3
  int v151; // [sp+50h] [bp-18h]@3
  int v152; // [sp+54h] [bp-14h]@3
  int v153; // [sp+58h] [bp-10h]@3

  v137 = a1;
  v135 = *(_DWORD *)a1;
  v2 = *(_DWORD *)(a1 + 4);
  v3 = *(_DWORD *)(a1 + 8);
  v133 = a1 + 8;
  v4 = 0;
  v134 = a1 + 12;
  v136 = *(_DWORD *)(a1 + 12);
  do
  {
    *(int *)((char *)&v138 + v4) = (*(_BYTE *)(a2 + v4 + 3) << 24) | *(_BYTE *)(a2 + v4) | (*(_BYTE *)(a2 + v4 + 2) << 16) | (*(_BYTE *)(a2 + v4 + 1) << 8);
    v4 += 4;
  }
  while ( v4 != 64 );
  v5 = __ROR__((v2 & v3 | v136 & ~v2) + v135 + v138 - 680876936, 25);
  v6 = v2 + v5;
  v7 = __ROR__(v136 + v139 - 389564586 + (v2 & v6 | v3 & ~v6), 20);
  v8 = v6 + v7;
  v9 = __ROR__(v3 + v140 + 606105819 + (v6 & v8 | v2 & ~v8), 15);
  v10 = v8 + v9;
  v11 = __ROR__(v2 + v141 - 1044525330 + (v8 & v10 | v6 & ~v10), 10);
  v12 = v10 + v11;
  v13 = __ROR__(v6 + v142 - 176418897 + (v10 & v12 | v8 & ~v12), 25);
  v14 = v12 + v13;
  v15 = __ROR__(v8 + v143 + 1200080426 + (v12 & v14 | v10 & ~v14), 20);
  v16 = v14 + v15;
  v17 = __ROR__((v14 & v16 | v12 & ~v16) + v10 + v144 - 1473231341, 15);
  v18 = v16 + v17;
  v19 = __ROR__(v12 + v145 - 45705983 + (v16 & v18 | v14 & ~v18), 10);
  v20 = v18 + v19;
  v21 = __ROR__(v14 + v146 + 1770035416 + (v18 & v20 | v16 & ~v20), 25);
  v22 = v20 + v21;
  v23 = __ROR__((v20 & v22 | v18 & ~v22) + v16 + v147 - 1958414417, 20);
  v24 = v22 + v23;
  v25 = __ROR__(v18 + v148 - 42063 + (v22 & v24 | v20 & ~v24), 15);
  v26 = v24 + v25;
  v27 = __ROR__(v20 + v149 - 1990404162 + (v24 & v26 | v22 & ~v26), 10);
  v28 = v26 + v27;
  v29 = __ROR__((v26 & v28 | v24 & ~v28) + v22 + v150 + 1804603682, 25);
  v30 = v28 + v29;
  v31 = __ROR__(v24 + v151 - 40341101 + (v28 & v30 | v26 & ~v30), 20);
  v32 = v30 + v31;
  v33 = __ROR__(v26 + v152 - 1502002290 + (v30 & v32 | v28 & ~v32), 15);
  v34 = v32 + v33;
  v35 = __ROR__(v28 + v153 + 1236535329 + (v32 & v34 | v30 & ~v34), 10);
  v36 = v34 + v35;
  v37 = __ROR__(v30 + v139 - 165796510 + (v34 & ~v32 | v32 & v36), 27);
  v38 = v36 + v37;
  v39 = __ROR__((v36 & ~v34 | v34 & v38) + v32 + v144 - 1069501632, 23);
  v40 = v38 + v39;
  v41 = __ROR__((v38 & ~v36 | v36 & v40) + v34 + v149 + 643717713, 18);
  v42 = v40 + v41;
  v43 = __ROR__(v36 + v138 - 373897302 + (v40 & ~v38 | v38 & v42), 12);
  v44 = v42 + v43;
  v45 = __ROR__((v42 & ~v40 | v40 & v44) + v38 + v143 - 701558691, 27);
  v46 = v44 + v45;
  v47 = __ROR__(v40 + v148 + 38016083 + (v44 & ~v42 | v42 & v46), 23);
  v48 = v46 + v47;
  v49 = __ROR__(v42 + v153 - 660478335 + (v46 & ~v44 | v44 & v48), 18);
  v50 = v48 + v49;
  v51 = __ROR__((v48 & ~v46 | v46 & v50) + v44 + v142 - 405537848, 12);
  v52 = v50 + v51;
  v53 = __ROR__(v46 + v147 + 568446438 + (v50 & ~v48 | v48 & v52), 27);
  v54 = v52 + v53;
  v55 = __ROR__(v48 + v152 - 1019803690 + (v52 & ~v50 | v50 & v54), 23);
  v56 = v54 + v55;
  v57 = __ROR__((v54 & ~v52 | v52 & v56) + v50 + v141 - 187363961, 18);
  v58 = v56 + v57;
  v59 = __ROR__(v52 + v146 + 1163531501 + (v56 & ~v54 | v54 & v58), 12);
  v60 = v58 + v59;
  v61 = __ROR__(v54 + v151 - 1444681467 + (v58 & ~v56 | v56 & v60), 27);
  v62 = v60 + v61;
  v63 = __ROR__((v60 & ~v58 | v58 & v62) + v56 + v140 - 51403784, 23);
  v64 = v62 + v63;
  v65 = __ROR__(v58 + v145 + 1735328473 + (v62 & ~v60 | v60 & v64), 18);
  v66 = v64 + v65;
  v67 = __ROR__(v60 + v150 - 1926607734 + (v64 & ~v62 | v62 & v66), 12);
  v68 = v66 + v67;
  v69 = __ROR__(v62 + v143 - 378558 + (v68 ^ v64 ^ v66), 28);
  v70 = v68 + v69;
  v71 = __ROR__(v64 + v146 - 2022574463 + (v70 ^ v66 ^ v68), 21);
  v72 = v70 + v71;
  v73 = __ROR__(v66 + v149 + 1839030562 + (v72 ^ v68 ^ v70), 16);
  v74 = v72 + v73;
  v75 = __ROR__(v68 + v152 - 35309556 + (v74 ^ v70 ^ v72), 9);
  v76 = v74 + v75;
  v77 = __ROR__(v70 + v139 - 1530992060 + (v76 ^ v72 ^ v74), 28);
  v78 = v76 + v77;
  v79 = __ROR__(v72 + v142 + 1272893353 + (v78 ^ v74 ^ v76), 21);
  v80 = v78 + v79;
  v81 = __ROR__(v74 + v145 - 155497632 + (v80 ^ v76 ^ v78), 16);
  v82 = v80 + v81;
  v83 = __ROR__(v76 + v148 - 1094730640 + (v82 ^ v78 ^ v80), 9);
  v84 = v82 + v83;
  v85 = __ROR__((v84 ^ v80 ^ v82) + v78 + v151 + 681279174, 28);
  v86 = v84 + v85;
  v87 = __ROR__((v86 ^ v82 ^ v84) + v80 + v138 - 358537222, 21);
  v88 = v86 + v87;
  v89 = __ROR__(v82 + v141 - 722521979 + (v88 ^ v84 ^ v86), 16);
  v90 = v88 + v89;
  v91 = __ROR__((v90 ^ v86 ^ v88) + v84 + v144 + 76029189, 9);
  v92 = v90 + v91;
  v93 = __ROR__((v92 ^ v88 ^ v90) + v86 + v147 - 640364487, 28);
  v94 = v92 + v93;
  v95 = __ROR__(v88 + v150 - 421815835 + (v94 ^ v90 ^ v92), 21);
  v96 = v94 + v95;
  v97 = __ROR__((v96 ^ v92 ^ v94) + v90 + v153 + 530742520, 16);
  v98 = v96 + v97;
  v99 = __ROR__((v98 ^ v94 ^ v96) + v92 + v140 - 995338651, 9);
  v100 = v98 + v99;
  v101 = __ROR__(v94 + v138 - 198630844 + (v98 ^ (v100 | ~v96)), 26);
  v102 = v100 + v101;
  v103 = __ROR__(v96 + v145 + 1126891415 + (v100 ^ (v102 | ~v98)), 22);
  v104 = v102 + v103;
  v105 = __ROR__(v98 + v152 - 1416354905 + (v102 ^ (v104 | ~v100)), 17);
  v106 = v104 + v105;
  v107 = __ROR__(v100 + v143 - 57434055 + (v104 ^ (v106 | ~v102)), 11);
  v108 = v106 + v107;
  v109 = __ROR__((v106 ^ (v108 | ~v104)) + v102 + v150 + 1700485571, 26);
  v110 = v108 + v109;
  v111 = __ROR__((v108 ^ (v110 | ~v106)) + v104 + v141 - 1894986606, 22);
  v112 = v110 + v111;
  v113 = __ROR__((v110 ^ (v112 | ~v108)) + v106 + v148 - 1051523, 17);
  v114 = v112 + v113;
  v115 = __ROR__(v108 + v139 - 2054922799 + (v112 ^ (v114 | ~v110)), 11);
  v116 = v114 + v115;
  v117 = __ROR__(v110 + v146 + 1873313359 + (v114 ^ (v116 | ~v112)), 26);
  v118 = v116 + v117;
  v119 = __ROR__(v112 + v153 - 30611744 + (v116 ^ (v118 | ~v114)), 22);
  v120 = v118 + v119;
  v121 = __ROR__(v114 + v144 - 1560198380 + (v118 ^ (v120 | ~v116)), 17);
  v122 = v120 + v121;
  v123 = __ROR__(v116 + v151 + 1309151649 + (v120 ^ (v122 | ~v118)), 11);
  v124 = v122 + v123;
  v125 = __ROR__(v118 + v142 - 145523070 + (v122 ^ (v124 | ~v120)), 26);
  v126 = v124 + v125;
  v127 = __ROR__((v124 ^ (v126 | ~v122)) + v120 + v149 - 1120210379, 22);
  v128 = v126 + v127;
  v129 = __ROR__(v122 + v140 + 718787259 + (v126 ^ (v128 | ~v124)), 17);
  v130 = v128 + v129;
  v131 = __ROR__(v124 + v147 - 343485551 + (v128 ^ (v130 | ~v126)), 11);
  *(_DWORD *)v137 += v126;
  *(_DWORD *)(v137 + 4) += v130 + v131;
  result = v133;
  *(_DWORD *)result += v130;
  *(_DWORD *)v134 += v128;
  return result;
}

//----- (08049E5B) --------------------------------------------------------
unsigned int __cdecl sub_8049E5B(int a1, const void *a2, unsigned int a3)
{
  int v3; // ecx@1
  int v4; // eax@1
  unsigned int v5; // esi@3
  int v6; // edi@4
  unsigned int v8; // [sp+0h] [bp-10h]@3

  v3 = 8 * a3 + *(_DWORD *)(a1 + 16);
  v4 = (*(_DWORD *)(a1 + 16) >> 3) & 0x3F;
  *(_DWORD *)(a1 + 16) = v3;
  if ( v3 < 8 * a3 )
    ++*(_DWORD *)(a1 + 20);
  v5 = 0;
  v8 = 64 - v4;
  *(_DWORD *)(a1 + 20) += a3 >> 29;
  if ( a3 >= 64 - v4 )
  {
    memcpy((void *)(a1 + 24 + v4), a2, v8);
    sub_80496F9(a1, a1 + 24);
    v6 = (int)((char *)a2 + v8);
    v5 = v8;
    while ( v5 + 63 < a3 )
    {
      sub_80496F9(a1, v6);
      v5 += 64;
      v6 += 64;
    }
    v4 = 0;
  }
  memcpy((void *)(a1 + v4 + 24), (char *)a2 + v5, a3 - v5);
  return v8;
}

//----- (08049EEF) --------------------------------------------------------
int __cdecl sub_8049EEF(int a1, int a2)
{
  unsigned int v2; // edx@1
  unsigned int v3; // eax@1
  int v4; // edx@1
  unsigned int v5; // ecx@1
  signed int v6; // eax@1
  int v7; // ecx@3
  int v8; // eax@3
  int v9; // edx@4
  int result; // eax@5
  char v11; // [sp+4h] [bp-14h]@1
  char v12; // [sp+5h] [bp-13h]@1
  char v13; // [sp+6h] [bp-12h]@1
  char v14; // [sp+7h] [bp-11h]@1
  char v15; // [sp+8h] [bp-10h]@1
  char v16; // [sp+9h] [bp-Fh]@1
  char v17; // [sp+Ah] [bp-Eh]@1
  char v18; // [sp+Bh] [bp-Dh]@1
  int v19; // [sp+Ch] [bp-Ch]@1

  v19 = *MK_FP(__GS__, 20);
  v2 = *(_DWORD *)(a2 + 16);
  v12 = *(_WORD *)(a2 + 16) >> 8;
  v13 = v2 >> 16;
  v11 = v2;
  v14 = BYTE3(v2);
  v3 = *(_DWORD *)(a2 + 20);
  v4 = (v2 >> 3) & 0x3F;
  v16 = *(_WORD *)(a2 + 20) >> 8;
  v5 = v3 >> 16;
  v15 = v3;
  v18 = BYTE3(v3);
  v6 = 56;
  v17 = v5;
  if ( (unsigned int)v4 > 0x37 )
    v6 = 120;
  sub_8049E5B(a2, &unk_805B0E4, v6 - v4);
  sub_8049E5B(a2, &v11, 8u);
  v8 = 0;
  do
  {
    *(_BYTE *)(a1 + v8) = *(_DWORD *)(a2 + v8);
    *(_BYTE *)(a1 + v8 + 1) = *(_WORD *)(a2 + v8) >> 8;
    *(_BYTE *)(a1 + v8 + 2) = *(_DWORD *)(a2 + v8) >> 16;
    v9 = *(_DWORD *)(a2 + v8) >> 24;
    *(_BYTE *)(a1 + v8 + 3) = v9;
    v8 += 4;
  }
  while ( v8 != 16 );
  LOBYTE(v8) = 0;
  memset32((void *)a2, v8, 0x16u);
  result = *MK_FP(__GS__, 20) ^ v19;
  if ( *MK_FP(__GS__, 20) != v19 )
    __stack_chk_fail(v7, v9);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (08049FC5) --------------------------------------------------------
_UNKNOWN *__cdecl sub_8049FC5(const void *a1, unsigned int a2)
{
  int v2; // ecx@1
  _UNKNOWN *result; // eax@1
  int v4; // [sp+4h] [bp-64h]@1
  int v5; // [sp+8h] [bp-60h]@1
  int v6; // [sp+Ch] [bp-5Ch]@1
  int v7; // [sp+10h] [bp-58h]@1
  int v8; // [sp+14h] [bp-54h]@1
  int v9; // [sp+18h] [bp-50h]@1
  int v10; // [sp+5Ch] [bp-Ch]@1

  v10 = *MK_FP(__GS__, 20);
  v9 = 0;
  v8 = 0;
  v4 = 1732584193;
  v5 = -271733879;
  v6 = -1732584194;
  v7 = 271733878;
  sub_8049E5B((int)&v4, a1, a2);
  sub_8049EEF((int)&unk_805B48C, (int)&v4);
  result = &unk_805B48C;
  if ( *MK_FP(__GS__, 20) != v10 )
    __stack_chk_fail(v2, *MK_FP(__GS__, 20) ^ v10);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804A06D) --------------------------------------------------------
int __usercall sub_804A06D<eax>(int a1<eax>, int a2<edx>)
{
  int v2; // ebx@1
  int v3; // edx@1
  int v4; // edi@1
  int v5; // eax@3
  int v6; // edx@3
  int v7; // eax@3
  int v8; // eax@3
  int v9; // ebx@3
  int v10; // ebx@3
  int v11; // ecx@3
  int v12; // ecx@3
  int v13; // edx@3
  int v14; // edx@3
  int v15; // eax@3
  int v16; // eax@3
  int v17; // ebx@3
  int v18; // ebx@3
  int v19; // ecx@3
  int v20; // ecx@3
  int v21; // edx@3
  int v22; // edx@3
  int v23; // eax@3
  int v24; // esi@3
  int v25; // eax@3
  int v26; // eax@3
  int v27; // ecx@3
  int v28; // ecx@3
  int v29; // edx@3
  int v30; // ebx@3
  int v31; // edx@3
  int v32; // edx@3
  int v33; // eax@3
  int v34; // eax@3
  int v35; // ecx@3
  int v36; // ecx@3
  int v37; // ebx@3
  int v38; // ebx@3
  int v39; // edx@3
  int v40; // esi@3
  int v41; // eax@3
  int v42; // edx@3
  int v43; // eax@3
  int v44; // eax@3
  int v45; // ecx@3
  int v46; // ebx@3
  int v47; // ecx@3
  int v48; // ecx@3
  int v49; // edx@3
  int v50; // edx@3
  int v51; // eax@3
  int v52; // esi@3
  int v53; // eax@3
  int v54; // eax@3
  int v55; // ecx@3
  int v56; // ecx@3
  int v57; // edx@3
  int v58; // ebx@3
  int v59; // edx@3
  int v60; // edx@3
  int v61; // eax@3
  int v62; // eax@3
  int v63; // ecx@3
  int v64; // esi@3
  int v65; // ecx@3
  int v66; // ecx@3
  int v67; // edx@3
  int v68; // ebx@3
  int v69; // eax@3
  int v70; // edx@3
  int v71; // eax@3
  int v72; // esi@3
  int v73; // eax@3
  int v74; // ecx@3
  int v75; // eax@3
  int v76; // eax@3
  int v77; // edx@3
  int v78; // ebx@3
  int v79; // edx@3
  int v80; // esi@3
  int v81; // edx@3
  int v82; // edx@3
  int v83; // eax@3
  int v84; // ecx@3
  int v85; // eax@3
  int v86; // ebx@3
  int v87; // eax@3
  int v88; // eax@3
  int v89; // edx@3
  int v90; // edx@3
  int v91; // ecx@3
  int v92; // esi@3
  int v93; // ecx@3
  int v94; // ebx@3
  int v95; // eax@3
  int v96; // ecx@3
  int v97; // eax@3
  int v98; // edx@3
  int v99; // eax@3
  int v100; // esi@3
  int v101; // eax@3
  int v102; // eax@3
  int v103; // ecx@3
  int v104; // ecx@3
  int v105; // edx@3
  int v106; // edx@3
  int v107; // ebx@3
  int v108; // ebx@3
  int v109; // eax@3
  int v110; // esi@3
  int v111; // eax@3
  int v112; // ecx@3
  int v113; // eax@3
  int v114; // edx@3
  int v115; // eax@3
  int v116; // eax@3
  int v117; // ebx@3
  int v118; // ebx@3
  int v119; // ecx@3
  int v120; // ecx@3
  int v121; // edx@3
  int v122; // edx@3
  int v123; // eax@3
  int v124; // eax@3
  int v125; // ebx@3
  int v126; // ebx@3
  int v127; // ecx@3
  int v128; // ecx@3
  int v129; // edx@3
  int v130; // edx@3
  int v131; // eax@3
  int result; // eax@3
  int v133; // [sp+0h] [bp-68h]@1
  int v134; // [sp+4h] [bp-64h]@1
  int v135; // [sp+Ch] [bp-5Ch]@1
  int v136; // [sp+10h] [bp-58h]@1
  int v137; // [sp+14h] [bp-54h]@1
  int v138; // [sp+18h] [bp-50h]@1
  int v139; // [sp+1Ch] [bp-4Ch]@2
  int v140; // [sp+20h] [bp-48h]@3
  int v141; // [sp+24h] [bp-44h]@3
  int v142; // [sp+28h] [bp-40h]@3
  int v143; // [sp+2Ch] [bp-3Ch]@3
  int v144; // [sp+30h] [bp-38h]@3
  int v145; // [sp+34h] [bp-34h]@3
  int v146; // [sp+38h] [bp-30h]@3
  int v147; // [sp+3Ch] [bp-2Ch]@3
  int v148; // [sp+40h] [bp-28h]@3
  int v149; // [sp+44h] [bp-24h]@3
  int v150; // [sp+48h] [bp-20h]@3
  int v151; // [sp+4Ch] [bp-1Ch]@3
  int v152; // [sp+50h] [bp-18h]@3
  int v153; // [sp+54h] [bp-14h]@3
  int v154; // [sp+58h] [bp-10h]@3

  v138 = a1;
  v136 = a2;
  v137 = *(_DWORD *)a1;
  v2 = *(_DWORD *)(a1 + 8);
  v133 = a1 + 8;
  v3 = 0;
  v4 = *(_DWORD *)(a1 + 12);
  v134 = a1 + 12;
  v135 = *(_DWORD *)(a1 + 4);
  do
  {
    *(int *)((char *)&v139 + v3) = (*(_BYTE *)(v136 + v3 + 3) << 24) | *(_BYTE *)(v136 + v3) | (*(_BYTE *)(v136 + v3 + 2) << 16) | (*(_BYTE *)(v136 + v3 + 1) << 8);
    v3 += 4;
  }
  while ( v3 != 64 );
  v5 = __ROR__(v137 + v139 - 680876936 + (v135 & v2 | v4 & ~v135), 25);
  v6 = v5 + v135 + 2;
  v7 = __ROR__(v4 + v140 - 389564586 + (v135 & v6 | v2 & ~v6), 20);
  v8 = v7 + v6 + 2;
  v9 = __ROR__(v2 + v141 + 606105819 + (v6 & v8 | v135 & ~v8), 15);
  v10 = v9 + v8 + 2;
  v11 = __ROR__(v135 + v142 - 1044525330 + (v8 & v10 | v6 & ~v10), 10);
  v12 = v11 + v10 + 2;
  v13 = __ROR__(v6 + v143 - 176418897 + (v10 & v12 | v8 & ~v12), 25);
  v14 = v13 + v12 + 2;
  v15 = __ROR__(v8 + v144 + 1200080426 + (v12 & v14 | v10 & ~v14), 20);
  v16 = v15 + v14 + 2;
  v17 = __ROR__(v10 + v145 - 1473231341 + (v14 & v16 | v12 & ~v16), 15);
  v18 = v17 + v16 + 2;
  v19 = __ROR__(v12 + v146 - 45705983 + (v16 & v18 | v14 & ~v18), 10);
  v20 = v19 + v18 + 2;
  v21 = __ROR__(v14 + v147 + 1770035416 + (v18 & v20 | v16 & ~v20), 25);
  v22 = v21 + v20 + 2;
  v23 = __ROR__(v16 + v148 - 1958414417 + (v20 & v22 | v18 & ~v22), 20);
  v24 = v23 + v22 + 2;
  v25 = __ROR__(v18 + v149 - 42063 + (v22 & v24 | v20 & ~(v23 + v22 + 2)), 15);
  v26 = v25 + v24 + 2;
  v27 = __ROR__(v20 + v150 - 1990404162 + (v24 & v26 | v22 & ~v26), 10);
  v28 = v27 + v26 + 2;
  v29 = __ROR__(v22 + v151 + 1804603682 + (v26 & v28 | v24 & ~v28), 25);
  v30 = v29 + v28 + 2;
  v31 = __ROR__(v24 + v152 - 40341149 + (v28 & v30 | v26 & ~(v29 + v28 + 2)), 20);
  v32 = v31 + v30 + 2;
  v33 = __ROR__(v26 + v153 - 1502002290 + (v30 & v32 | v28 & ~v32), 15);
  v34 = v33 + v32 + 2;
  v35 = __ROR__(v28 + v154 + 1236535329 + (v32 & v34 | v30 & ~v34), 10);
  v36 = v35 + v34 + 2;
  v37 = __ROR__(v30 + v140 - 165796510 + (v34 & ~v32 | v32 & v36), 27);
  v38 = v37 + v36 - 2;
  v39 = __ROR__(v32 + v145 - 1069501632 + (v36 & ~v34 | v34 & v38), 23);
  v40 = v39 + v38 - 2;
  v41 = __ROR__(v34 + v150 + 643717713 + (v38 & ~v36 | v36 & v40), 18);
  v42 = v41 + v40 - 2;
  v43 = __ROR__(v36 + v139 - 373897302 + (v40 & ~v38 | v38 & (v41 + v40 - 2)), 12);
  v44 = v43 + v42 - 2;
  v45 = __ROR__(v38 + v144 - 701558691 + (v42 & ~v40 | v40 & v44), 27);
  v46 = v45 + v44 - 2;
  v47 = __ROR__(v40 + v149 + 38020179 + (v44 & ~v42 | v42 & (v45 + v44 - 2)), 23);
  v48 = v47 + v46 - 2;
  v49 = __ROR__(v42 + v154 - 660478335 + (v46 & ~v44 | v44 & v48), 18);
  v50 = v49 + v48 - 2;
  v51 = __ROR__(v44 + v143 - 405537848 + (v48 & ~v46 | v46 & v50), 12);
  v52 = v51 + v50 - 2;
  v53 = __ROR__(v46 + v148 + 568446438 + (v50 & ~v48 | v48 & (v51 + v50 - 2)), 27);
  v54 = v53 + v52 - 2;
  v55 = __ROR__(v48 + v153 - 1019803690 + (v52 & ~v50 | v50 & v54), 23);
  v56 = v55 + v54 - 2;
  v57 = __ROR__(v50 + v142 - 187363961 + (v54 & ~v52 | v52 & v56), 18);
  v58 = v57 + v56 - 2;
  v59 = __ROR__(v52 + v147 + 1163531501 + (v56 & ~v54 | v54 & (v57 + v56 - 2)), 12);
  v60 = v59 + v58 - 2;
  v61 = __ROR__(v54 + v152 - 1444681467 + (v58 & ~v56 | v56 & v60), 27);
  v62 = v61 + v60 - 2;
  v63 = __ROR__(v56 + v141 - 51403784 + (v60 & ~v58 | v58 & v62), 23);
  v64 = v63 + v62 - 2;
  v65 = __ROR__(v58 + v146 + 1735328473 + (v62 & ~v60 | v60 & (v63 + v62 - 2)), 18);
  v66 = v65 + v64 - 2;
  v67 = __ROR__(v60 + v151 - 1926607734 + (v64 & ~v62 | v62 & v66), 12);
  v68 = v67 + v66 - 2;
  v69 = __ROR__(v62 + v144 - 379758 + (v68 ^ v64 ^ v66), 27);
  v70 = v69 + v68 - 1;
  v71 = __ROR__(v64 + v147 - 2022574463 + (v70 ^ v66 ^ v68), 21);
  v72 = v71 + v70 - 1;
  v73 = __ROR__(v66 + v150 + 1839030562 + (v72 ^ v68 ^ v70), 16);
  v74 = v73 + v72 - 1;
  v75 = __ROR__(v68 + v153 - 35309556 + (v74 ^ v70 ^ v72), 9);
  v76 = v75 + v74 - 1;
  v77 = __ROR__(v70 + v140 - 1530992060 + (v76 ^ v72 ^ v74), 27);
  v78 = v77 + v76 - 1;
  v79 = __ROR__(v72 + v143 + 1272893353 + (v78 ^ v74 ^ v76), 21);
  v80 = v79 + v78 - 1;
  v81 = __ROR__(v74 + v146 - 155497632 + (v80 ^ v76 ^ v78), 16);
  v82 = v81 + v80 - 1;
  v83 = __ROR__(v76 + v149 - 1094730640 + (v82 ^ v78 ^ v80), 9);
  v84 = v83 + v82 - 1;
  v85 = __ROR__(v78 + v152 + 681279174 + (v84 ^ v80 ^ v82), 27);
  v86 = v85 + v84 - 1;
  v87 = __ROR__(v80 + v139 - 358537222 + (v86 ^ v82 ^ v84), 21);
  v88 = v87 + v86 - 1;
  v89 = __ROR__(v82 + v142 - 722521979 + (v88 ^ v84 ^ v86), 16);
  v90 = v89 + v88 - 1;
  v91 = __ROR__((v90 ^ v86 ^ v88) + v145 + *(_BYTE *)(v136 + 9) + 76029189 + v84, 9);
  v92 = v91 + v90 - 1;
  v93 = __ROR__(v86 + v148 - 640364487 + (v92 ^ v88 ^ v90), 27);
  v94 = v93 + v92 - 1;
  v95 = __ROR__(v88 + v151 - 421815835 + (v94 ^ v90 ^ v92), 21);
  v96 = v95 + v94 - 1;
  v97 = __ROR__(v90 + v154 + 530742520 + (v96 ^ v92 ^ v94), 16);
  v98 = v97 + v96 - 1;
  v99 = __ROR__(v92 + v141 - 995338651 + (v98 ^ v94 ^ v96), 9);
  v100 = v99 + v98 - 1;
  v101 = __ROR__(v94 + v139 - 198630844 + (v98 ^ (v100 | ~v96)), 26);
  v102 = v101 + v100 + 1;
  v103 = __ROR__(v96 + v146 + 1126891415 + (v100 ^ (v102 | ~v98)), 22);
  v104 = v103 + v102 + 1;
  v105 = __ROR__(v98 + v153 - 1416354905 + (v102 ^ (v104 | ~v100)), 17);
  v106 = v105 + v104 + 1;
  v107 = __ROR__(v100 + v144 - 57434055 + (v104 ^ (v106 | ~v102)), 13);
  v108 = v107 + v106 + 1;
  v109 = __ROR__(v102 + v151 + 1700157891 + (v106 ^ (v108 | ~v104)), 26);
  v110 = v109 + v108 + 1;
  v111 = __ROR__(v104 + v142 - 1894986606 + (v108 ^ (v110 | ~v106)), 22);
  v112 = v111 + v110 + 1;
  v113 = __ROR__(v106 + v149 - 1051523 + (v110 ^ (v112 | ~v108)), 17);
  v114 = v113 + v112 + 1;
  v115 = __ROR__(v108 + v140 - 2054922799 + (v112 ^ (v114 | ~v110)), 13);
  v116 = v115 + v114 + 1;
  v117 = __ROR__(v110 + v147 + 1873313359 + (v114 ^ (v116 | ~v112)), 26);
  v118 = v117 + v116 + 1;
  v119 = __ROR__(v112 + v154 - 30611744 + (v116 ^ (v118 | ~v114)), 22);
  v120 = v119 + v118 + 1;
  v121 = __ROR__(v114 + v145 - 1560198380 + (v118 ^ (v120 | ~v116)), 17);
  v122 = v121 + v120 + 1;
  v123 = __ROR__(v116 + v152 + 1309151649 + (v120 ^ (v122 | ~v118)), 13);
  v124 = v123 + v122 + 1;
  v125 = __ROR__(v118 + v143 - 145523070 + (v122 ^ (v124 | ~v120)), 26);
  v126 = v125 + v124 + 1;
  v127 = __ROR__(v120 + v150 - 1120210123 + (v124 ^ (v126 | ~v122)), 22);
  v128 = v127 + v126 + 1;
  v129 = __ROR__(v122 + v141 + 718787259 + (v126 ^ (v128 | ~v124)), 17);
  v130 = v129 + v128 + 1;
  v131 = __ROR__(v124 + v148 - 343514223 + (v128 ^ (v130 | ~v126)), 13);
  *(_DWORD *)v138 += v126;
  *(_DWORD *)(v138 + 4) += v130 + v131 + 1;
  result = v134;
  *(_DWORD *)v133 += v130;
  *(_DWORD *)result += v128;
  return result;
}

//----- (0804A86D) --------------------------------------------------------
unsigned int __cdecl sub_804A86D(int a1, const void *a2, unsigned int a3)
{
  int v3; // ecx@1
  int v4; // eax@1
  unsigned int v5; // esi@3
  int v6; // edi@4
  unsigned int v8; // [sp+0h] [bp-10h]@3

  v3 = 8 * a3 + *(_DWORD *)(a1 + 16);
  v4 = (*(_DWORD *)(a1 + 16) >> 3) & 0x3F;
  *(_DWORD *)(a1 + 16) = v3;
  if ( v3 < 8 * a3 )
    ++*(_DWORD *)(a1 + 20);
  v5 = 0;
  v8 = 64 - v4;
  *(_DWORD *)(a1 + 20) += a3 >> 29;
  if ( a3 >= 64 - v4 )
  {
    memcpy((void *)(a1 + 24 + v4), a2, v8);
    sub_804A06D(a1, a1 + 24);
    v6 = (int)((char *)a2 + v8);
    v5 = v8;
    while ( v5 + 63 < a3 )
    {
      sub_804A06D(a1, v6);
      v5 += 64;
      v6 += 64;
    }
    v4 = 0;
  }
  memcpy((void *)(a1 + v4 + 24), (char *)a2 + v5, a3 - v5);
  return v8;
}

//----- (0804A901) --------------------------------------------------------
int __cdecl sub_804A901(int a1, int a2)
{
  unsigned int v2; // edx@1
  unsigned int v3; // eax@1
  int v4; // edx@1
  unsigned int v5; // ecx@1
  signed int v6; // eax@1
  int v7; // ecx@3
  int v8; // eax@3
  int v9; // edx@4
  int result; // eax@5
  char v11; // [sp+4h] [bp-14h]@1
  char v12; // [sp+5h] [bp-13h]@1
  char v13; // [sp+6h] [bp-12h]@1
  char v14; // [sp+7h] [bp-11h]@1
  char v15; // [sp+8h] [bp-10h]@1
  char v16; // [sp+9h] [bp-Fh]@1
  char v17; // [sp+Ah] [bp-Eh]@1
  char v18; // [sp+Bh] [bp-Dh]@1
  int v19; // [sp+Ch] [bp-Ch]@1

  v19 = *MK_FP(__GS__, 20);
  v2 = *(_DWORD *)(a2 + 16);
  v12 = *(_WORD *)(a2 + 16) >> 8;
  v13 = v2 >> 16;
  v11 = v2;
  v14 = BYTE3(v2);
  v3 = *(_DWORD *)(a2 + 20);
  v4 = (v2 >> 3) & 0x3F;
  v16 = *(_WORD *)(a2 + 20) >> 8;
  v5 = v3 >> 16;
  v15 = v3;
  v18 = BYTE3(v3);
  v6 = 56;
  v17 = v5;
  if ( (unsigned int)v4 > 0x37 )
    v6 = 120;
  sub_804A86D(a2, &unk_805B124, v6 - v4);
  sub_804A86D(a2, &v11, 8u);
  v8 = 0;
  do
  {
    *(_BYTE *)(a1 + v8) = *(_DWORD *)(a2 + v8);
    *(_BYTE *)(a1 + v8 + 1) = *(_WORD *)(a2 + v8) >> 8;
    *(_BYTE *)(a1 + v8 + 2) = *(_DWORD *)(a2 + v8) >> 16;
    v9 = *(_DWORD *)(a2 + v8) >> 24;
    *(_BYTE *)(a1 + v8 + 3) = v9;
    v8 += 4;
  }
  while ( v8 != 16 );
  LOBYTE(v8) = 0;
  memset32((void *)a2, v8, 0x16u);
  result = *MK_FP(__GS__, 20) ^ v19;
  if ( *MK_FP(__GS__, 20) != v19 )
    __stack_chk_fail(v7, v9);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804A9D7) --------------------------------------------------------
int __cdecl sub_804A9D7(const void *a1, int a2, unsigned int a3)
{
  int v3; // edx@1
  int v4; // ecx@1
  int result; // eax@1
  int v6; // [sp+4h] [bp-64h]@1
  int v7; // [sp+8h] [bp-60h]@1
  int v8; // [sp+Ch] [bp-5Ch]@1
  int v9; // [sp+10h] [bp-58h]@1
  int v10; // [sp+14h] [bp-54h]@1
  int v11; // [sp+18h] [bp-50h]@1
  int v12; // [sp+5Ch] [bp-Ch]@1

  v12 = *MK_FP(__GS__, 20);
  v11 = 0;
  v10 = 0;
  v6 = 1343451718;
  v7 = -1966105154;
  v8 = -907039507;
  v9 = 627339283;
  sub_804A86D((int)&v6, a1, a3);
  sub_804A901(a2, (int)&v6);
  result = *MK_FP(__GS__, 20) ^ v12;
  if ( *MK_FP(__GS__, 20) != v12 )
    __stack_chk_fail(v4, v3);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804AA4C) --------------------------------------------------------
int __usercall sub_804AA4C<eax>(int a1<eax>, int a2<edx>)
{
  int v2; // ebx@1
  char *v3; // edi@3
  char *v4; // ebx@3
  int v5; // edx@4
  int v6; // edx@5
  int v7; // ebx@5
  int v8; // esi@5
  int v9; // edx@6
  int v10; // eax@6
  int v11; // ST18_4@6
  int v12; // edx@6
  int v13; // esi@6
  int v14; // edx@6
  int v15; // edi@8
  char *v16; // esi@8
  int v17; // ebx@8
  int i; // edx@8
  int v19; // eax@9
  int v20; // eax@9
  int v21; // ST1C_4@9
  int v22; // eax@9
  int v23; // ST14_4@9
  int v24; // ST1C_4@9
  int v25; // edi@9
  int v26; // eax@9
  int v27; // esi@11
  char *v28; // edi@11
  int v29; // ebx@12
  int v30; // eax@12
  int v31; // ST18_4@12
  int v32; // eax@12
  int v33; // ebx@12
  int v34; // edx@12
  int v35; // ebx@12
  int v36; // edx@14
  int *v37; // edi@14
  int v38; // ecx@14
  int j; // ebx@14
  int v40; // esi@15
  int v41; // eax@15
  int v42; // esi@15
  int v43; // esi@15
  int v44; // ecx@15
  int result; // eax@17
  int v46; // [sp+0h] [bp-188h]@1
  int v47; // [sp+4h] [bp-184h]@5
  int v48; // [sp+8h] [bp-180h]@5
  int v49; // [sp+Ch] [bp-17Ch]@8
  int v50; // [sp+10h] [bp-178h]@6
  int v51; // [sp+10h] [bp-178h]@12
  int v52; // [sp+14h] [bp-174h]@5
  int v53; // [sp+14h] [bp-174h]@9
  int v54; // [sp+14h] [bp-174h]@15
  int v55; // [sp+18h] [bp-170h]@6
  int v56; // [sp+18h] [bp-170h]@12
  int v57; // [sp+1Ch] [bp-16Ch]@5
  int v58; // [sp+1Ch] [bp-16Ch]@9
  int v59; // [sp+1Ch] [bp-16Ch]@15
  char v60[80]; // [sp+2Ch] [bp-15Ch]@2
  char v61; // [sp+7Ch] [bp-10Ch]@6
  char v62; // [sp+CCh] [bp-BCh]@9
  char v63; // [sp+120h] [bp-68h]@12
  char v64; // [sp+12Ch] [bp-5Ch]@4
  int v65; // [sp+16Ch] [bp-1Ch]@1

  v2 = 0;
  v65 = *MK_FP(__GS__, 20);
  v46 = *(_BYTE *)a2 + 380542443;
  do
  {
    v60[4 * v2 + 3] = *(_BYTE *)(a2 + 4 * v2);
    v60[4 * v2 + 2] = *(_BYTE *)(a2 + 4 * v2 + 1);
    v60[4 * v2 + 1] = *(_BYTE *)(a2 + 4 * v2 + 2);
    v60[4 * v2] = *(_BYTE *)(a2 + 4 * v2 + 3);
    ++v2;
  }
  while ( v2 != 16 );
  v3 = v60;
  v4 = v60;
  do
  {
    v5 = __ROL__(*((_DWORD *)v4 + 2) ^ *(_DWORD *)v4 ^ *((_DWORD *)v4 + 13) ^ *((_DWORD *)v4 + 8), 1);
    *((_DWORD *)v4 + 16) = v5;
    v4 += 4;
  }
  while ( v4 != &v64 );
  v47 = a1;
  v57 = *(_DWORD *)(a1 + 8);
  v48 = *(_DWORD *)a1;
  v6 = *(_DWORD *)(a1 + 16);
  v7 = *(_DWORD *)(a1 + 12);
  v52 = *(_DWORD *)a1;
  v8 = *(_DWORD *)(a1 + 4);
  while ( 1 )
  {
    v9 = *(_DWORD *)v3 + v6;
    v3 += 4;
    v10 = __ROR__(v52, 27);
    v11 = v9 + v10 - 1567270100;
    v12 = v8 & v57 | v7 & ~v8;
    v13 = __ROR__(v8, 2);
    v14 = v11 + v12;
    v55 = v13;
    v8 = v52;
    v50 = v14;
    v6 = v7;
    if ( v3 == &v61 )
      break;
    v7 = v57;
    v57 = v55;
    v52 = v50;
  }
  v49 = v7;
  v15 = v52;
  v16 = &v61;
  v17 = v57;
  for ( i = v50; ; i = v26 )
  {
    v19 = *(_DWORD *)v16 + v46;
    v16 += 4;
    v20 = v49 + v19;
    v49 = v17;
    v21 = v20;
    v22 = __ROR__(i, 27);
    v23 = v22 + v21;
    v24 = v17 ^ v15 ^ v55;
    v25 = __ROR__(v15, 2);
    v26 = v24 + v23;
    v53 = v25;
    v15 = i;
    v58 = v26;
    if ( v16 == &v62 )
      break;
    v17 = v55;
    v55 = v53;
  }
  v27 = v55;
  v28 = &v62;
  while ( 1 )
  {
    v29 = *(_DWORD *)v28 + v17;
    v28 += 4;
    v30 = __ROR__(v58, 27);
    v31 = v29 + v30 - 872623688;
    v32 = i & v53;
    v33 = v27 & (i | v53);
    v34 = __ROR__(i, 2);
    v35 = v31 + (v32 | v33);
    v56 = v34;
    i = v58;
    v51 = v35;
    v17 = v27;
    if ( v28 == &v63 )
      break;
    v27 = v53;
    v53 = v56;
    v58 = v51;
  }
  v36 = v53;
  v37 = (int *)&v63;
  v38 = v58;
  for ( j = v51; ; j = v54 )
  {
    v40 = *v37 + v27;
    ++v37;
    v41 = v40;
    v42 = __ROR__(j, 27);
    v43 = v41 + v42 - 1557372563 + (v36 ^ v38 ^ v56);
    v44 = __ROR__(v38, 2);
    v54 = v43;
    v27 = v36;
    v59 = v44;
    v38 = j;
    if ( v37 == &v65 )
      break;
    v36 = v56;
    v56 = v59;
  }
  result = v47;
  *(_DWORD *)(result + 4) += j;
  *(_DWORD *)v47 = v54 + v48 + 1;
  *(_DWORD *)(result + 8) += v59;
  *(_DWORD *)(result + 12) += v56;
  *(_DWORD *)(result + 16) += v36;
  if ( *MK_FP(__GS__, 20) != v65 )
    __stack_chk_fail(v59, v36);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804AA4C: using guessed type char var_15C[80];

//----- (0804AD9F) --------------------------------------------------------
int __usercall sub_804AD9F<eax>(int result<eax>, int a2<edx>, unsigned int a3<ecx>)
{
  unsigned int i; // ebx@1

  for ( i = 0; i < a3; i += 4 )
  {
    *(_BYTE *)(result + i + 3) = *(_DWORD *)(a2 + i);
    *(_BYTE *)(result + i + 2) = *(_WORD *)(a2 + i) >> 8;
    *(_BYTE *)(result + i + 1) = *(_DWORD *)(a2 + i) >> 16;
    *(_BYTE *)(result + i) = *(_DWORD *)(a2 + i) >> 24;
  }
  return result;
}

//----- (0804ADD9) --------------------------------------------------------
int __cdecl sub_804ADD9(int a1)
{
  int result; // eax@1

  result = 0;
  memset((void *)a1, 0, 0x60u);
  *(_DWORD *)a1 = 839341078;
  *(_DWORD *)(a1 + 4) = -119871044;
  *(_DWORD *)(a1 + 8) = 1934889568;
  *(_DWORD *)(a1 + 12) = -1966367234;
  *(_DWORD *)(a1 + 16) = -49533413;
  return result;
}

//----- (0804AE10) --------------------------------------------------------
void __cdecl sub_804AE10(int a1, const void *a2, unsigned int a3)
{
  int v3; // edx@2
  unsigned int v4; // edx@4
  int v5; // eax@4
  int v6; // esi@6
  int v7; // edx@6
  unsigned int v8; // ecx@11
  unsigned int v9; // edi@11
  int v10; // edx@12
  unsigned int v11; // [sp+0h] [bp-28h]@12
  int v12; // [sp+4h] [bp-24h]@6
  int v13; // [sp+Ch] [bp-1Ch]@6

  if ( a3 )
  {
    v3 = 8 * a3 + *(_DWORD *)(a1 + 20);
    *(_DWORD *)(a1 + 20) = v3;
    if ( v3 < 8 * a3 )
      ++*(_DWORD *)(a1 + 24);
    v4 = a3;
    *(_DWORD *)(a1 + 24) += a3 >> 29;
    v5 = *(_DWORD *)(a1 + 28);
    if ( a3 > 64 - v5 )
      v4 = 64 - v5;
    v13 = a3 - v4;
    memcpy((void *)(a1 + 32 + v5), a2, v4);
    v6 = (int)((char *)a2 + v4);
    v7 = *(_DWORD *)(a1 + 28) + v4;
    v12 = v6;
    *(_DWORD *)(a1 + 28) = v7;
    if ( v7 == 64 )
      *(_DWORD *)(a1 + 28) = 0;
    if ( !*(_DWORD *)(a1 + 28) )
      sub_804AA4C(a1, a1 + 32);
    if ( (unsigned int)v13 > 0x3F )
    {
      v8 = (unsigned int)v13 >> 6;
      v9 = (unsigned int)v13 >> 6;
      do
      {
        v10 = v6;
        v11 = v8;
        v6 += 64;
        sub_804AA4C(a1, v10);
        --v9;
        v8 = v11;
      }
      while ( v9 );
      v6 = v12 + (v11 << 6);
      v13 += -64 * v11;
    }
    if ( v13 )
    {
      memcpy((void *)(a1 + 32), (const void *)v6, v13);
      *(_DWORD *)(a1 + 28) = v13;
    }
  }
}

//----- (0804AEED) --------------------------------------------------------
int __cdecl sub_804AEED(int a1, int a2)
{
  signed int v2; // edx@1
  int v3; // eax@1
  int v4; // edx@3
  int result; // eax@3
  char v6; // [sp+4h] [bp-24h]@1
  char v7; // [sp+8h] [bp-20h]@1
  int v8; // [sp+Ch] [bp-1Ch]@1

  v8 = *MK_FP(__GS__, 20);
  sub_804AD9F((int)&v7, a1 + 20, 4u);
  sub_804AD9F((int)&v6, a1 + 24, 4u);
  v2 = 56;
  v3 = (*(_DWORD *)(a1 + 20) >> 3) & 0x3F;
  if ( (unsigned int)v3 > 0x37 )
    v2 = 120;
  sub_804AE10(a1, &unk_805B164, v2 - v3);
  sub_804AE10(a1, &v6, 8u);
  sub_804AD9F(a2, a1, 0x14u);
  memset((void *)a1, 0, 0x60u);
  result = *MK_FP(__GS__, 20) ^ v8;
  if ( *MK_FP(__GS__, 20) != v8 )
    __stack_chk_fail(0, v4);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804AF94) --------------------------------------------------------
int __cdecl sub_804AF94(const void *a1, int a2, unsigned int a3)
{
  int v3; // ecx@1
  int result; // eax@1
  char v5; // [sp+Ch] [bp-7Ch]@1
  int v6; // [sp+6Ch] [bp-1Ch]@1

  v6 = *MK_FP(__GS__, 20);
  sub_804ADD9((int)&v5);
  sub_804AE10((int)&v5, a1, a3);
  sub_804AEED((int)&v5, a2);
  result = 0;
  if ( *MK_FP(__GS__, 20) != v6 )
    __stack_chk_fail(v3, *MK_FP(__GS__, 20) ^ v6);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804AFE8) --------------------------------------------------------
int __cdecl sub_804AFE8(int a1)
{
  int result; // eax@1

  result = 0;
  memset((void *)(a1 + 16), 0, 0x40u);
  *(_DWORD *)a1 = 270890038;
  *(_DWORD *)(a1 + 4) = -1463968514;
  *(_DWORD *)(a1 + 8) = -1627607669;
  *(_DWORD *)(a1 + 12) = 305615968;
  return result;
}

//----- (0804B01D) --------------------------------------------------------
int __cdecl sub_804B01D(int a1)
{
  int result; // eax@1
  int v2; // ST4C_4@1
  int v3; // ST30_4@1
  int v4; // esi@1
  int v5; // ecx@1
  int v6; // edx@1
  int v7; // ebx@1
  int v8; // esi@1
  int v9; // ecx@1
  int v10; // edx@1
  int v11; // ebx@1
  int v12; // esi@1
  int v13; // ecx@1
  int v14; // edx@1
  int v15; // ebx@1
  int v16; // esi@1
  int v17; // ecx@1
  int v18; // edx@1
  int v19; // ebx@1
  int v20; // edi@1
  int v21; // ecx@1
  int v22; // edx@1
  int v23; // ebx@1
  int v24; // esi@1
  int v25; // ecx@1
  int v26; // edx@1
  int v27; // ebx@1
  int v28; // esi@1
  int v29; // ecx@1
  int v30; // edi@1
  int v31; // ebx@1
  int v32; // edx@1
  int v33; // ecx@1
  int v34; // edi@1
  int v35; // ebx@1
  int v36; // edx@1
  int v37; // ecx@1
  int v38; // esi@1
  int v39; // ebx@1
  int v40; // edx@1
  int v41; // edi@1
  int v42; // esi@1
  int v43; // ecx@1
  int v44; // ebx@1
  int v45; // edi@1
  int v46; // edx@1
  int v47; // esi@1
  int v48; // ebx@1
  int v49; // ecx@1
  int v50; // edi@1
  int v51; // esi@1
  int v52; // edx@1
  int v53; // ecx@1
  int v54; // edi@1
  int v55; // ebx@1
  int v56; // esi@1
  int v57; // edx@1
  int v58; // ecx@1
  int v59; // ebx@1
  int v60; // esi@1
  int v61; // edx@1
  int v62; // ecx@1
  int v63; // ebx@1
  int v64; // esi@1
  int v65; // ST58_4@1
  int v66; // esi@1
  int v67; // ST50_4@1
  int v68; // edx@1
  int v69; // ST40_4@1
  int v70; // ST2C_4@1
  int v71; // esi@1
  int v72; // edx@1
  int v73; // ebx@1
  int v74; // ecx@1
  int v75; // esi@1
  int v76; // edx@1
  int v77; // ebx@1
  int v78; // ecx@1
  int v79; // esi@1
  int v80; // edx@1
  int v81; // ebx@1
  int v82; // ecx@1
  int v83; // esi@1
  int v84; // edx@1
  int v85; // ebx@1
  int v86; // ecx@1
  int v87; // edi@1
  int v88; // esi@1
  int v89; // ebx@1
  int v90; // ecx@1
  int v91; // edx@1
  int v92; // esi@1
  int v93; // ebx@1
  int v94; // ecx@1
  int v95; // edx@1
  int v96; // esi@1
  int v97; // ebx@1
  int v98; // ecx@1
  int v99; // edx@1
  int v100; // esi@1
  int v101; // ebx@1
  int v102; // ecx@1
  int v103; // edx@1
  int v104; // esi@1
  int v105; // ebx@1
  int v106; // ecx@1
  int v107; // edx@1
  int v108; // esi@1
  int v109; // ebx@1
  int v110; // ecx@1
  int v111; // edx@1
  int v112; // esi@1
  int v113; // ebx@1
  int v114; // ecx@1
  int v115; // edx@1
  int v116; // esi@1
  int v117; // ebx@1
  int v118; // ecx@1
  int v119; // edx@1
  int v120; // esi@1
  int v121; // ebx@1
  int v122; // ecx@1
  int v123; // edx@1
  int v124; // esi@1
  int v125; // ebx@1
  int v126; // ecx@1
  int v127; // edx@1
  int v128; // esi@1
  int v129; // ebx@1
  int v130; // ecx@1
  int v131; // edx@1
  int v132; // edi@1
  int v133; // ebx@1
  int v134; // ecx@1
  int v135; // et0@1
  int v136; // ebx@1
  int v137; // [sp+5Ch] [bp-4Ch]@1
  int v138; // [sp+60h] [bp-48h]@1
  int v139; // [sp+64h] [bp-44h]@1
  int v140; // [sp+68h] [bp-40h]@1
  int v141; // [sp+6Ch] [bp-3Ch]@1
  int v142; // [sp+70h] [bp-38h]@1
  int v143; // [sp+74h] [bp-34h]@1
  int v144; // [sp+78h] [bp-30h]@1
  int v145; // [sp+7Ch] [bp-2Ch]@1
  int v146; // [sp+80h] [bp-28h]@1
  int v147; // [sp+84h] [bp-24h]@1
  int v148; // [sp+88h] [bp-20h]@1
  int v149; // [sp+8Ch] [bp-1Ch]@1
  int v150; // [sp+90h] [bp-18h]@1
  int v151; // [sp+94h] [bp-14h]@1
  int v152; // [sp+98h] [bp-10h]@1

  result = a1;
  memcpy(&v137, (const void *)(a1 + 16), 0x40u);
  v2 = *(_DWORD *)(a1 + 4);
  v3 = v2 ^ *(_DWORD *)(a1 + 8);
  v4 = __ROR__((v3 ^ *(_DWORD *)(result + 12)) + *(_DWORD *)result + v137 + 2, 21);
  v5 = __ROR__((v4 ^ v3) + *(_DWORD *)(a1 + 12) + v138 + 2, 18);
  v6 = __ROR__(*(_DWORD *)(a1 + 8) + v139 + 2 + (v5 ^ v4 ^ v2), 17);
  v7 = __ROR__(v2 + v140 + 2 + (v6 ^ v4 ^ v5), 20);
  v8 = __ROR__((v7 ^ v5 ^ v6) + v141 + 2 + v4, 27);
  v9 = __ROR__((v8 ^ v6 ^ v7) + v142 + 2 + v5, 24);
  v10 = __ROR__(v6 + v143 + 2 + (v9 ^ v7 ^ v8), 25);
  v11 = __ROR__((v10 ^ v8 ^ v9) + v144 + 2 + v7, 23);
  v12 = __ROR__((v11 ^ v9 ^ v10) + v145 + 2 + v8, 21);
  v13 = __ROR__((v12 ^ v10 ^ v11) + v146 + 2 + v9, 19);
  v14 = __ROR__((v13 ^ v11 ^ v12) + v147 + 2 + v10, 18);
  v15 = __ROR__((v14 ^ v12 ^ v13) + v148 + 2 + v11, 17);
  v16 = __ROR__((v15 ^ v13 ^ v14) + v149 + 2 + v12, 26);
  v17 = __ROR__((v16 ^ v14 ^ v15) + v150 + 2 + v13, 25);
  v18 = __ROR__((v17 ^ v15 ^ v16) + v151 + 2 + v14, 23);
  v19 = __ROR__((v16 ^ v17 ^ v18) + v152 + 2 + v15, 24);
  v20 = __ROR__(v16 + v144 + 844863905 + (v17 ^ v19 & (v17 ^ v18)), 25);
  v21 = __ROR__((v18 ^ v20 & (v18 ^ v19)) + v141 + 2 + v17, 26);
  v22 = __ROR__(v18 + v150 + 844863905 + (v19 ^ v21 & (v19 ^ v20)), 24);
  v23 = __ROR__((v20 ^ v22 & (v20 ^ v21)) + v138 + 844863905 + v19, 19);
  v24 = __ROR__(v20 + v147 + 844863905 + (v21 ^ v23 & (v21 ^ v22)), 21);
  v25 = __ROR__((v22 ^ v24 & (v22 ^ v23)) + v143 + 844863905 + v21, 23);
  v26 = __ROR__(v22 + v152 + 844863905 + (v23 ^ v25 & (v23 ^ v24)), 25);
  v27 = __ROR__(v23 + v140 - 1126387207 + (v24 ^ v26 & (v24 ^ v25)), 17);
  v28 = __ROR__(v24 + v149 + 844863905 + (v25 ^ v27 & (v25 ^ v26)), 25);
  v29 = __ROR__((v26 ^ v28 & (v26 ^ v27)) + v137 + 2 + v25, 20);
  v30 = __ROR__((v27 ^ v29 & (v27 ^ v28)) + v26 + v146 + 844863905, 17);
  v31 = __ROR__((v28 ^ v30 & (v28 ^ v29)) + v27 + v142 + 844863905, 23);
  v32 = __ROR__(v28 + v139 + 844863905 + (v29 ^ v31 & (v29 ^ v30)), 21);
  v33 = __ROR__(v29 + v151 + 844863905 + (v30 ^ v32 & (v30 ^ v31)), 25);
  v34 = __ROR__((v31 ^ v33 & (v31 ^ v32)) + v148 + 844863905 + v30, 19);
  v35 = __ROR__((v32 ^ v34 & (v32 ^ v33)) + v145 + 2 + v31, 20);
  v36 = __ROR__((v33 ^ (v35 | ~v34)) + v140 + 464443036 + v32, 21);
  v37 = __ROR__(v33 + v147 + 464443036 + (v34 ^ (v36 | ~v35)), 19);
  v38 = __ROR__(v34 + v151 + 464443036 + (v35 ^ (v37 | ~v36)), 26);
  v39 = __ROR__(v35 + v141 + 464443036 + (v36 ^ (v38 | ~v37)), 25);
  v40 = __ROR__(v36 + v146 + 464443036 + (v37 ^ (v39 | ~v38)), 18);
  v41 = __ROR__((v38 ^ (v40 | ~v39)) + v37 + v152 + 464443036, 23);
  v42 = __ROR__((v39 ^ (v41 | ~v40)) + v38 + v145 + 464443036, 19);
  v43 = __ROR__(v39 + v138 + 464443036 + (v40 ^ (v42 | ~v41)), 17);
  v44 = __ROR__((v41 ^ (v43 | ~v42)) + v40 + v139 + 464443036, 18);
  v45 = __ROR__((v42 ^ (v44 | ~v43)) + v41 + v144 + 464443036, 24);
  v46 = __ROR__(v42 + v137 + 464443036 + (v43 ^ (v45 | ~v44)), 19);
  v47 = __ROR__(v143 + 844863905 + v43 + (v44 ^ (v46 | ~v45)), 26);
  v48 = __ROR__((v45 ^ (v47 | ~v46)) + v44 + v150 + 464443036, 27);
  v49 = __ROR__(v45 + v148 - 1126387206 + (v46 ^ (v48 | ~v47)), 20);
  v50 = __ROR__((v47 ^ (v49 | ~v48)) + v46 + v142 + 464443036, 25);
  v51 = __ROR__((v48 ^ (v50 | ~v49)) + v47 + v149 + 464443036, 27);
  v52 = __ROR__(v48 + v138 - 1126387207 + (v50 ^ v49 & (v50 ^ v51)), 21);
  v53 = __ROR__(v49 + v146 - 1126387207 + (v51 ^ v50 & (v51 ^ v52)), 20);
  v54 = __ROR__((v52 ^ v51 & (v52 ^ v53)) + v148 + 844863905 + v50, 18);
  v55 = __ROR__(v51 + v147 - 1126387207 + (v53 ^ v52 & (v53 ^ v54)), 17);
  v56 = __ROR__((v54 ^ v53 & (v54 ^ v55)) + v52 + v137 - 1126387207, 18);
  v57 = __ROR__(v53 + v145 - 1126387205 + (v55 ^ v54 & (v55 ^ v56)), 17);
  v58 = __ROR__(v54 + v149 - 1126387207 + (v56 ^ v55 & (v56 ^ v57)), 23);
  v59 = __ROR__(v55 + v141 - 1126387207 + (v57 ^ v56 & (v57 ^ v58)), 24);
  v60 = __ROR__(v56 + v150 - 1126387207 + (v58 ^ v57 & (v58 ^ v59)), 23);
  v61 = __ROR__((v59 ^ v58 & (v59 ^ v60)) + v140 + 464443036 + v57, 18);
  v62 = __ROR__(v58 + v144 - 1126387207 + (v60 ^ v59 & (v60 ^ v61)), 27);
  v63 = __ROR__((v61 ^ v60 & (v61 ^ v62)) + v152 + 2 + v59, 26);
  v64 = __ROR__(v60 + v151 - 1126387207 + (v62 ^ v61 & (v62 ^ v63)), 24);
  v65 = v64;
  v66 = __ROR__(v142 - 1126387207 + v61 + (v63 ^ v62 & (v63 ^ v64)), 26);
  v67 = v66;
  v68 = __ROR__(v62 + v143 - 1126387207 + (v65 ^ v63 & (v66 ^ v65)), 27);
  v69 = v68;
  v70 = v63 + v139 - 1126387204 + (v66 ^ v65 & (v66 ^ v68));
  v71 = __ROR__(*(_DWORD *)result + v142 + 1518500234 + (*(_DWORD *)(result + 8) ^ *(_DWORD *)(result + 12) & v3), 24);
  v72 = __ROR__(*(_DWORD *)(result + 12) + v151 + 1518500234 + (v2 ^ *(_DWORD *)(result + 8) & (v71 ^ v2)), 23);
  v73 = __ROR__((v71 ^ v2 & (v71 ^ v72)) + *(_DWORD *)(a1 + 8) + v144 + 1518500234, 23);
  v74 = __ROR__(v2 + v137 + 1518500234 + (v72 ^ v71 & (v72 ^ v73)), 21);
  v75 = __ROR__(v71 + v146 + 1518500234 + (v73 ^ v72 & (v73 ^ v74)), 19);
  v76 = __ROR__(v72 + v139 + 1518500234 + (v74 ^ v73 & (v74 ^ v75)), 17);
  v77 = __ROR__((v75 ^ v74 & (v75 ^ v76)) + v148 + 844863905 + v73, 17);
  v78 = __ROR__(v74 + v141 + 1518500234 + (v76 ^ v75 & (v76 ^ v77)), 27);
  v79 = __ROR__(v75 + v150 + 1518500234 + (v77 ^ v76 & (v77 ^ v78)), 25);
  v80 = __ROR__(v76 + v143 + 1518500234 + (v78 ^ v77 & (v78 ^ v79)), 25);
  v81 = __ROR__(v77 + v152 - 1126387207 + (v79 ^ v78 & (v79 ^ v80)), 24);
  v82 = __ROR__((v80 ^ v79 & (v80 ^ v81)) + v145 + 1518500234 + v78, 21);
  v83 = __ROR__(v79 + v138 + 1518500234 + (v81 ^ v80 & (v81 ^ v82)), 18);
  v84 = __ROR__(v80 + v147 + 1518500234 + (v82 ^ v81 & (v82 ^ v83)), 18);
  v85 = __ROR__(v81 + v140 - 1126387204 + (v83 ^ v82 & (v83 ^ v84)), 20);
  v86 = __ROR__(v82 + v149 + 1518500234 + (v84 ^ v83 & (v84 ^ v85)), 26);
  v87 = __ROR__((v84 ^ (v86 | ~v85)) + v83 + v143 + 1104424285, 23);
  v88 = __ROR__((v85 ^ (v87 | ~v86)) + v84 + v148 + 1104424285, 19);
  v89 = __ROR__((v86 ^ (v88 | ~v87)) + v85 + v140 + 1104424285, 17);
  v90 = __ROR__((v87 ^ (v89 | ~v88)) + v86 + v144 + 1104424285, 25);
  v91 = __ROR__(v87 + v137 + 1104424285 + (v88 ^ (v90 | ~v89)), 20);
  v92 = __ROR__(v88 + v150 + 1104424285 + (v89 ^ (v91 | ~v90)), 24);
  v93 = __ROR__((v90 ^ (v92 | ~v91)) + v142 - 1126387207 + v89, 23);
  v94 = __ROR__(v90 + v147 - 1126387203 + (v91 ^ (v93 | ~v92)), 21);
  v95 = __ROR__(v91 + v151 + 1104424285 + (v92 ^ (v94 | ~v93)), 25);
  v96 = __ROR__(v92 + v152 + 1104424285 + (v93 ^ (v95 | ~v94)), 25);
  v97 = __ROR__(v93 + v145 + 1104424285 + (v94 ^ (v96 | ~v95)), 20);
  v98 = __ROR__(v94 + v149 + 1104424285 + (v95 ^ (v97 | ~v96)), 25);
  v99 = __ROR__((v96 ^ (v98 | ~v97)) + v141 + 1104424285 + v95, 26);
  v100 = __ROR__(v96 + v146 + 1104424285 + (v97 ^ (v99 | ~v98)), 17);
  v101 = __ROR__((v98 ^ (v100 | ~v99)) + v138 + 844863905 + v97, 19);
  v102 = __ROR__(v98 + v139 + 1104424285 + (v99 ^ (v101 | ~v100)), 21);
  v103 = __ROR__(v99 + v152 + 820854632 + (v100 ^ v102 & (v100 ^ v101)), 23);
  v104 = __ROR__(v100 + v142 + 820854632 + (v101 ^ v103 & (v101 ^ v102)), 25);
  v105 = __ROR__(v101 + v138 + 820854632 + (v102 ^ v104 & (v102 ^ v103)), 17);
  v106 = __ROR__(v102 + v140 + 820854632 + (v103 ^ v105 & (v103 ^ v104)), 21);
  v107 = __ROR__(v103 + v144 + 820854632 + (v104 ^ v106 & (v104 ^ v105)), 24);
  v108 = __ROR__(v104 + v151 + 820854632 + (v105 ^ v107 & (v105 ^ v106)), 26);
  v109 = __ROR__((v106 ^ v108 & (v106 ^ v107)) + v143 - 1126387202 + v105, 26);
  v110 = __ROR__(v106 + v146 + 820854632 + (v107 ^ v109 & (v107 ^ v108)), 18);
  v111 = __ROR__(v107 + v148 + 820854632 + (v108 ^ v110 & (v108 ^ v109)), 20);
  v112 = __ROR__((v109 ^ v111 & (v109 ^ v110)) + v145 + 1518500234 + v108, 19);
  v113 = __ROR__(v109 + v149 + 820854632 + (v110 ^ v112 & (v110 ^ v111)), 27);
  v114 = __ROR__(v110 + v139 + 820854632 + (v111 ^ v113 & (v111 ^ v112)), 18);
  v115 = __ROR__(v111 + v147 + 820854632 + (v112 ^ v114 & (v112 ^ v113)), 19);
  v116 = __ROR__(v112 + v137 + 820854632 + (v113 ^ v115 & (v113 ^ v114)), 19);
  v117 = __ROR__((v114 ^ v116 & (v114 ^ v115)) + v141 + 1104424285 + v113, 25);
  v118 = __ROR__(v114 + v150 + 820854632 + (v115 ^ v117 & (v115 ^ v116)), 27);
  v119 = __ROR__((v118 ^ v116 ^ v117) + v145 + 2 + v115, 17);
  v120 = __ROR__((v119 ^ v117 ^ v118) + v143 - 1126387202 + v116, 27);
  v121 = __ROR__((v120 ^ v118 ^ v119) + v141 + 2 + v117, 24);
  v122 = __ROR__(v118 + v138 + 2 + (v121 ^ v119 ^ v120), 21);
  v123 = __ROR__(v119 + v140 + 2 + (v122 ^ v120 ^ v121), 18);
  v124 = __ROR__((v123 ^ v121 ^ v122) + v148 + 2 + v120, 18);
  v125 = __ROR__((v124 ^ v122 ^ v123) + v152 + 2 + v121, 26);
  v126 = __ROR__((v125 ^ v123 ^ v124) + v137 + 2 + v122, 18);
  v127 = __ROR__((v126 ^ v124 ^ v125) + v142 + 2 + v123, 26);
  v128 = __ROR__((v127 ^ v125 ^ v126) + v149 + 2 + v124, 23);
  v129 = __ROR__(v125 + v139 + 2 + (v128 ^ v126 ^ v127), 20);
  v130 = __ROR__((v129 ^ v127 ^ v128) + v150 + 2 + v126, 23);
  v131 = __ROR__((v130 ^ v128 ^ v129) + v146 + 2 + v127, 20);
  v132 = __ROR__(v144 + 2 + v128 + (v131 ^ v129 ^ v130), 27);
  v133 = __ROR__((v132 ^ v130 ^ v131) + v147 + 2 + v129, 17);
  v134 = (v133 ^ v131 ^ v132) + v151 + 2 + v130;
  *(_DWORD *)(result + 4) = v67 + *(_DWORD *)(result + 8) + v131;
  v134 = __ROR__(v134, 24);
  v135 = __ROR__(v70, 20);
  v136 = v135 + *(_DWORD *)a1 + v133;
  *(_DWORD *)(result + 8) = v65 + *(_DWORD *)(result + 12) + 1 + v134;
  *(_DWORD *)(a1 + 12) = v136;
  *(_DWORD *)a1 = v69 + v2 + v132;
  return result;
}

//----- (0804BC9B) --------------------------------------------------------
int __cdecl sub_804BC9B(int a1, int a2, unsigned int a3, int a4)
{
  int v4; // ecx@1
  int v5; // edx@1
  unsigned int v6; // ebx@3
  int result; // eax@8
  char v8[56]; // [sp+2Ch] [bp-5Ch]@1
  __int16 v9; // [sp+64h] [bp-24h]@4
  char v10; // [sp+66h] [bp-22h]@4
  char v11; // [sp+67h] [bp-21h]@4
  int v12; // [sp+6Ch] [bp-1Ch]@1

  v12 = *MK_FP(__GS__, 20);
  memset(v8, 0, 0x40u);
  __memcpy_chk(v8, a2, a3, 64);
  v5 = a1;
  if ( a3 > 0x40 )
    goto LABEL_8;
  if ( a3 == 64 )
    goto LABEL_6;
  v8[a3] = -128;
  v6 = 8 * a4;
  if ( a3 - 56 > 7 )
  {
    v9 = 8 * a4;
    v10 = v6 >> 16;
    v11 = (unsigned int)(8 * a4) >> 24;
LABEL_6:
    memcpy((void *)(a1 + 16), v8, 0x40u);
    goto LABEL_7;
  }
  memcpy((void *)(a1 + 16), v8, 0x40u);
  sub_804B01D(a1);
  memset(v8, 0, 0x40u);
  v9 = 8 * a4;
  v10 = v6 >> 16;
  v11 = (unsigned int)(8 * a4) >> 24;
  memcpy((void *)(a1 + 16), v8, 0x40u);
  v5 = a1;
LABEL_7:
  sub_804B01D(v5);
LABEL_8:
  result = *MK_FP(__GS__, 20) ^ v12;
  if ( *MK_FP(__GS__, 20) != v12 )
    __stack_chk_fail(v4, v5);
  return result;
}
// 8048DA0: using guessed type int __cdecl __memcpy_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804BC9B: using guessed type char var_5C[56];

//----- (0804BD98) --------------------------------------------------------
int __usercall sub_804BD98<eax>(int a1<eax>, int a2<edx>, int a3<ecx>, int a4, int a5, __int64 a6)
{
  int v6; // ST04_4@1
  int v7; // ST00_4@1
  int v8; // edx@1
  unsigned __int64 v9; // qax@1
  int v10; // edi@1
  int v11; // ebx@1
  int v12; // esi@1
  int v13; // ebx@1
  int v14; // edi@1
  int v15; // ebx@1
  unsigned __int8 v16; // cf@1
  unsigned __int64 v17; // qcx@1
  int v18; // esi@1
  int v19; // esi@1
  unsigned __int64 v20; // qcx@1
  unsigned __int64 v21; // qax@1

  v6 = a1;
  v7 = a2;
  v8 = *(_DWORD *)(a3 + 4);
  LODWORD(v9) = a4 ^ *(_DWORD *)a3;
  *(_DWORD *)a3 = v9;
  HIDWORD(v9) = a5 ^ v8;
  v10 = BYTE4(v9) + 512;
  v11 = (unsigned __int8)(v9 >> 16) + 256;
  *(_DWORD *)(a3 + 4) = HIDWORD(v9);
  v12 = dword_8052418[2 * v10] ^ dword_8052418[2 * v11];
  v13 = dword_805241C[2 * (unsigned __int8)v9] ^ dword_805241C[2 * v10] ^ dword_805241C[2 * v11];
  v14 = ((HIDWORD(v9) >> 16) & 0xFF) + 768;
  HIDWORD(v9) = v13 ^ dword_805241C[2 * v14];
  v15 = v6;
  LODWORD(v9) = dword_8052418[2 * (unsigned __int8)v9] ^ v12 ^ dword_8052418[2 * v14];
  v16 = *(_DWORD *)v6 < (unsigned int)v9;
  *(_DWORD *)v15 -= v9;
  *(_DWORD *)(v15 + 4) -= v16 + HIDWORD(v9);
  v17 = *(_QWORD *)a3;
  LODWORD(v9) = BYTE1(v17) + 768;
  v18 = (unsigned __int8)(v17 >> 24) + 512;
  HIDWORD(v9) = dword_8052418[2 * (HIDWORD(v17) >> 24)] ^ dword_8052418[2 * v18] ^ dword_8052418[2 * (signed int)v9];
  LODWORD(v9) = dword_805241C[2 * (HIDWORD(v17) >> 24)] ^ dword_805241C[2 * v18] ^ dword_805241C[2 * (signed int)v9];
  v19 = BYTE5(v17) + 256;
  HIDWORD(v17) = v9 ^ dword_805241C[2 * v19];
  LODWORD(v17) = HIDWORD(v9) ^ dword_8052418[2 * v19];
  v20 = *(_QWORD *)v7 + v17;
  v21 = (unsigned int)v20 * (unsigned __int64)(unsigned int)a6;
  *(_DWORD *)v7 = v20 * a6;
  *(_DWORD *)(v7 + 4) = v20 * HIDWORD(a6) + HIDWORD(v20) * a6 + HIDWORD(v21);
  return v21;
}
// 8052418: using guessed type int dword_8052418[];
// 805241C: using guessed type int dword_805241C[];

//----- (0804BEE0) --------------------------------------------------------
int __usercall sub_804BEE0<eax>(int a1<eax>, int a2<edx>, int a3<ecx>, int a4, __int64 a5)
{
  int v5; // edi@1
  int v6; // ST28_4@1
  int v7; // ST24_4@1
  int v8; // ST20_4@1

  v5 = a4;
  v6 = a1;
  v7 = a2;
  v8 = a3;
  sub_804BD98(a1, a2, a3, *(_DWORD *)a4, *(_DWORD *)(a4 + 4), a5);
  sub_804BD98(v7, v8, v6, *(_DWORD *)(v5 + 8), *(_DWORD *)(v5 + 12), a5);
  sub_804BD98(v8, v6, v7, *(_DWORD *)(v5 + 16), *(_DWORD *)(v5 + 20), a5);
  sub_804BD98(v6, v7, v8, *(_DWORD *)(v5 + 24), *(_DWORD *)(v5 + 28), a5);
  sub_804BD98(v7, v8, v6, *(_DWORD *)(v5 + 32), *(_DWORD *)(v5 + 36), a5);
  sub_804BD98(v8, v6, v7, *(_DWORD *)(v5 + 40), *(_DWORD *)(v5 + 44), a5);
  sub_804BD98(v6, v7, v8, *(_DWORD *)(v5 + 48), *(_DWORD *)(v5 + 52), a5);
  return sub_804BD98(v7, v8, v6, *(_DWORD *)(v5 + 56), *(_DWORD *)(v5 + 60), a5);
}

//----- (0804BFB5) --------------------------------------------------------
int __usercall sub_804BFB5<eax>(int result<eax>)
{
  __int64 v1; // qcx@1
  __int64 v2; // ST20_8@1
  __int64 v3; // ST20_8@1
  __int64 v4; // ST28_8@1
  int v5; // esi@1
  __int64 v6; // qcx@1
  int v7; // ST0C_4@1
  unsigned __int64 v8; // ST18_8@1
  unsigned __int64 v9; // ST30_8@1
  int v10; // esi@1
  unsigned __int64 v11; // qcx@1
  unsigned int v12; // ST08_4@1
  unsigned __int64 v13; // qt0@1
  unsigned int v14; // esi@1
  int v15; // edi@1
  unsigned int v16; // ST38_4@1
  unsigned __int8 v17; // cf@1
  unsigned __int64 v18; // ST38_8@1
  int v19; // edi@1
  unsigned int v20; // esi@1
  unsigned __int64 v21; // qcx@1
  int v22; // edi@1
  int v23; // edi@1
  int v24; // kr18_4@1
  int v25; // edi@1

  LODWORD(v1) = *(_DWORD *)(result + 56) ^ 0xA5A5A7A5;
  HIDWORD(v2) = *(_DWORD *)(result + 4);
  HIDWORD(v1) = *(_DWORD *)(result + 60) ^ 0xA5A5B5A5;
  LODWORD(v2) = *(_DWORD *)result;
  v3 = v2 - v1;
  LODWORD(v1) = *(_DWORD *)(result + 8) ^ v3;
  v4 = *(_QWORD *)(result + 8) ^ v3;
  v5 = *(_DWORD *)(result + 8) ^ v3;
  *(_DWORD *)(result + 12) = HIDWORD(v4);
  HIDWORD(v1) = HIDWORD(v4);
  v6 = *(_QWORD *)(result + 16) + v1;
  v7 = v6;
  *(_QWORD *)(result + 16) = v6;
  v8 = *(_QWORD *)(result + 24) - (v6 ^ (__PAIR__(~*(_DWORD *)(result + 12), ~v5) << 19));
  v9 = *(_QWORD *)(result + 32) ^ v8;
  v10 = *(_DWORD *)(result + 32) ^ v8;
  *(_QWORD *)(result + 32) = v9;
  v11 = *(_QWORD *)(result + 40) + v9;
  v12 = *(_DWORD *)(result + 40) + v9;
  *(_QWORD *)(result + 40) = v11;
  LODWORD(v13) = ~v10;
  HIDWORD(v13) = ~*(_DWORD *)(result + 36);
  v14 = v11 ^ (v13 >> 23);
  v15 = HIDWORD(v11) ^ (HIDWORD(v13) >> 23);
  HIDWORD(v11) = *(_DWORD *)(result + 52);
  v16 = *(_DWORD *)(result + 48);
  v17 = v16 < v14;
  v18 = __PAIR__(HIDWORD(v11), v16) - __PAIR__(v15, v14);
  LODWORD(v11) = *(_DWORD *)(result + 56) ^ v18;
  HIDWORD(v11) = *(_DWORD *)(result + 60) ^ (HIDWORD(v11) - (v17 + v15));
  *(_DWORD *)(result + 56) = v11;
  v19 = (v11 + v3) >> 32;
  v20 = v11 + v3;
  *(_QWORD *)result = v11 + v3;
  *(_DWORD *)(result + 60) = HIDWORD(v11);
  LODWORD(v11) = ~(_DWORD)v11;
  HIDWORD(v13) = ~*(_DWORD *)(result + 60);
  LODWORD(v13) = v11;
  v21 = v4 - __PAIR__(v19 ^ (unsigned int)(v13 >> 13), v20 ^ ((_DWORD)v11 << 19));
  *(_QWORD *)(result + 8) = v21;
  v22 = *(_DWORD *)(result + 20) ^ HIDWORD(v21);
  *(_DWORD *)(result + 16) = v21 ^ v7;
  *(_QWORD *)(result + 24) = __PAIR__(v22, (unsigned int)v21 ^ v7) + v8;
  *(_DWORD *)(result + 20) = v22;
  LODWORD(v13) = ~(v21 ^ v7);
  HIDWORD(v13) = ~*(_DWORD *)(result + 20);
  v24 = v9 - (((v21 ^ v7) + (_DWORD)v8) ^ (v13 >> 23));
  v23 = (v9
       - __PAIR__(
           (unsigned int)((__PAIR__(v22, (unsigned int)v21 ^ v7) + v8) >> 32) ^ (~*(_DWORD *)(result + 20) >> 23),
           ((v21 ^ v7) + (_DWORD)v8) ^ (v13 >> 23))) >> 32;
  *(_DWORD *)(result + 32) = v24;
  *(_DWORD *)(result + 36) = v23;
  v25 = v23 ^ *(_DWORD *)(result + 44);
  *(_DWORD *)(result + 40) = v24 ^ v12;
  *(_DWORD *)(result + 44) = v25;
  *(_QWORD *)(result + 48) = v18 + __PAIR__(v25, v24 ^ v12);
  v17 = *(_DWORD *)(result + 56) < (((unsigned int)v18 + (v24 ^ v12)) ^ 0x89ABCDEF);
  *(_DWORD *)(result + 56) -= (v18 + (v24 ^ v12)) ^ 0x89ABCDEF;
  *(_DWORD *)(result + 60) -= v17 + (((v18 + __PAIR__(v25, v24 ^ v12)) >> 32) ^ 0x1234567);
  return result;
}

//----- (0804C1D1) --------------------------------------------------------
void __cdecl sub_804C1D1(int a1)
{
  int v1; // edx@2
  int v2; // eax@3
  int v3; // edi@3
  int v4; // edx@4
  __int64 v5; // qax@4
  __int64 v6; // qax@4
  unsigned __int8 v7; // cf@4
  int v8; // [sp+4h] [bp-7Ch]@2
  int v9; // [sp+18h] [bp-68h]@3
  int v10[15]; // [sp+1Ch] [bp-64h]@3
  int v11; // [sp+58h] [bp-28h]@4
  int v12; // [sp+5Ch] [bp-24h]@4
  __int64 v13; // [sp+60h] [bp-20h]@4
  int v14; // [sp+68h] [bp-18h]@4
  int v15; // [sp+6Ch] [bp-14h]@4

  if ( a1 )
  {
    v1 = 0;
    v8 = a1 + 24;
    do
    {
      v2 = ((unsigned __int64)*(_BYTE *)(v8 + 8 * v1 + 2) >> 16) | ((unsigned __int64)*(_BYTE *)(a1 + 8 * v1 + 27) >> 8) | *(_BYTE *)(v8 + 8 * v1 + 4) | (*(_BYTE *)(a1 + 8 * v1 + 29) << 8) | (*(_BYTE *)(a1 + 8 * v1 + 30) << 16) | (*(_BYTE *)(a1 + 8 * v1 + 31) << 24);
      v3 = (unsigned __int64)*(_BYTE *)(a1 + 8 * v1 + 25) >> 24;
      *(&v9 + 2 * v1) = (*(_BYTE *)(a1 + 8 * v1 + 25) << 8) | (*(_BYTE *)(v8 + 8 * v1 + 2) << 16) | (*(_BYTE *)(a1 + 8 * v1 + 27) << 24) | *(_BYTE *)(v8 + 8 * v1);
      v10[2 * v1++] = v3 | v2;
    }
    while ( v1 != 8 );
    v4 = *(_DWORD *)(a1 + 4);
    v14 = *(_DWORD *)a1;
    LODWORD(v5) = *(_DWORD *)(a1 + 8);
    v15 = v4;
    HIDWORD(v5) = *(_DWORD *)(a1 + 12);
    v13 = v5;
    HIDWORD(v5) = *(_DWORD *)(a1 + 20);
    v11 = *(_DWORD *)(a1 + 16);
    v12 = HIDWORD(v5);
    sub_804BEE0((int)&v14, (int)&v13, (int)&v11, (int)&v9, 5LL);
    sub_804BFB5((int)&v9);
    sub_804BEE0((int)&v11, (int)&v14, (int)&v13, (int)&v9, 7LL);
    sub_804BFB5((int)&v9);
    sub_804BEE0((int)&v13, (int)&v11, (int)&v14, (int)&v9, 9LL);
    *(_DWORD *)a1 ^= v14;
    *(_DWORD *)(a1 + 4) ^= v15;
    v6 = v13 - *(_QWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 8) = v6;
    LODWORD(v6) = v11;
    *(_DWORD *)(a1 + 12) = HIDWORD(v6);
    HIDWORD(v6) = v12;
    v7 = __CFADD__((_DWORD)v6, *(_DWORD *)(a1 + 16));
    *(_DWORD *)(a1 + 16) += v6;
    *(_DWORD *)(a1 + 20) += HIDWORD(v6) + v7;
  }
}
// 804C1D1: using guessed type int var_64[15];

//----- (0804C34E) --------------------------------------------------------
int __cdecl sub_804C34E(int a1)
{
  int result; // eax@1

  result = a1;
  if ( a1 )
  {
    *(_DWORD *)a1 = -915733537;
    *(_DWORD *)(a1 + 4) = 361644666;
    *(_DWORD *)(a1 + 8) = -1902270588;
    *(_DWORD *)(a1 + 12) = -265961157;
    *(_DWORD *)(a1 + 16) = -1008592012;
    *(_DWORD *)(a1 + 20) = -1232032955;
  }
  return result;
}

//----- (0804C383) --------------------------------------------------------
int __cdecl sub_804C383(int a1, int a2, unsigned int a3, int a4)
{
  int v4; // ecx@1
  int v5; // edx@1
  unsigned int v6; // ebx@3
  int result; // eax@8
  char v8[56]; // [sp+2Ch] [bp-5Ch]@1
  __int16 v9; // [sp+64h] [bp-24h]@4
  char v10; // [sp+66h] [bp-22h]@4
  char v11; // [sp+67h] [bp-21h]@4
  int v12; // [sp+6Ch] [bp-1Ch]@1

  v12 = *MK_FP(__GS__, 20);
  memset(v8, 0, 0x40u);
  __memcpy_chk(v8, a2, a3, 64);
  v5 = a1;
  if ( a3 > 0x40 )
    goto LABEL_8;
  if ( a3 == 64 )
    goto LABEL_6;
  v8[a3] = 1;
  v6 = 8 * a4;
  if ( a3 - 56 > 7 )
  {
    v9 = 8 * a4;
    v10 = v6 >> 16;
    v11 = (unsigned int)(8 * a4) >> 24;
LABEL_6:
    memcpy((void *)(a1 + 24), v8, 0x40u);
    goto LABEL_7;
  }
  memcpy((void *)(a1 + 24), v8, 0x40u);
  sub_804C1D1(a1);
  memset(v8, 0, 0x40u);
  v9 = 8 * a4;
  v10 = v6 >> 16;
  v11 = (unsigned int)(8 * a4) >> 24;
  memcpy((void *)(a1 + 24), v8, 0x40u);
  v5 = a1;
LABEL_7:
  sub_804C1D1(v5);
LABEL_8:
  result = *MK_FP(__GS__, 20) ^ v12;
  if ( *MK_FP(__GS__, 20) != v12 )
    __stack_chk_fail(v4, v5);
  return result;
}
// 8048DA0: using guessed type int __cdecl __memcpy_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804C383: using guessed type char var_5C[56];

//----- (0804C480) --------------------------------------------------------
int __cdecl sub_804C480(int a1)
{
  int v1; // ecx@1
  int v2; // edx@2
  int v3; // ebx@2
  unsigned int v4; // esi@2
  int v5; // ecx@4
  int v6; // edx@4
  int v7; // eax@4
  int v8; // ecx@4
  int v9; // edx@4
  int v10; // eax@4
  int v11; // ecx@4
  int v12; // edx@4
  int v13; // eax@4
  int v14; // ecx@4
  int v15; // STC0_4@4
  int v16; // STC4_4@4
  int v17; // ecx@4
  int v18; // STC4_4@4
  int v19; // STC0_4@4
  int v20; // ecx@4
  int v21; // STC0_4@4
  int v22; // STC4_4@4
  int v23; // ecx@4
  int v24; // STC8_4@4
  int v25; // STCC_4@4
  int v26; // ecx@4
  int v27; // STC8_4@4
  int v28; // STCC_4@4
  int v29; // ecx@4
  int v30; // STCC_4@4
  int v31; // STC8_4@4
  int v32; // ecx@4
  int v33; // STD0_4@4
  int v34; // STD4_4@4
  int v35; // ecx@4
  int v36; // STD4_4@4
  int v37; // STD0_4@4
  int v38; // ecx@4
  int v39; // STD0_4@4
  int v40; // STD4_4@4
  int v41; // ecx@4
  int v42; // STD8_4@4
  int v43; // STDC_4@4
  int v44; // ecx@4
  int v45; // STD8_4@4
  int v46; // STDC_4@4
  int v47; // ecx@4
  int v48; // STDC_4@4
  int v49; // STD8_4@4
  int v50; // ecx@4
  int v51; // STE4_4@4
  int v52; // STE0_4@4
  int v53; // ecx@4
  int v54; // STE0_4@4
  int v55; // STE4_4@4
  int v56; // ecx@4
  int v57; // STE0_4@4
  int v58; // STE4_4@4
  int v59; // ecx@4
  int v60; // STE8_4@4
  int v61; // STEC_4@4
  int v62; // ecx@4
  int v63; // STE8_4@4
  int v64; // STEC_4@4
  int v65; // ecx@4
  int v66; // STEC_4@4
  int v67; // STE8_4@4
  int v68; // esi@4
  int v69; // ecx@4
  int v70; // ST120_4@4
  int v71; // esi@4
  int v72; // ST120_4@4
  int v73; // ecx@4
  int v74; // esi@4
  int v75; // ecx@4
  int v76; // STBC_4@4
  int v77; // STF0_4@4
  int v78; // ecx@4
  int v79; // STBC_4@4
  int v80; // STF0_4@4
  int v81; // ecx@4
  int v82; // STF0_4@4
  int v83; // STBC_4@4
  int v84; // ecx@4
  int v85; // STF8_4@4
  int v86; // ST100_4@4
  int v87; // ecx@4
  int v88; // ST100_4@4
  int v89; // STF8_4@4
  int v90; // ecx@4
  int v91; // ST100_4@4
  int v92; // STF8_4@4
  int v93; // esi@4
  int v94; // ecx@4
  int v95; // ST120_4@4
  int v96; // esi@4
  int v97; // ecx@4
  int v98; // ST120_4@4
  int v99; // esi@4
  __int64 v100; // ST50_8@4
  int v101; // ecx@4
  int v102; // ST108_4@4
  int v103; // ST110_4@4
  int v104; // ecx@4
  int v105; // ST110_4@4
  int v106; // ST108_4@4
  int v107; // ecx@4
  int v108; // ST108_4@4
  int v109; // ST110_4@4
  int v110; // ecx@4
  int v111; // ST118_4@4
  int v112; // ST120_4@4
  int v113; // ecx@4
  int v114; // ST118_4@4
  int v115; // ST120_4@4
  int v116; // ecx@4
  int v117; // ST120_4@4
  int v118; // ST118_4@4
  int v119; // esi@4
  int v120; // ecx@4
  int v121; // ST04_4@4
  int v122; // esi@4
  int v123; // ecx@4
  int v124; // ST04_4@4
  int v125; // esi@4
  __int64 v126; // ST58_8@4
  int v127; // esi@4
  int v128; // ecx@4
  int v129; // ST04_4@4
  int v130; // esi@4
  int v131; // ecx@4
  int v132; // ST04_4@4
  int v133; // esi@4
  int v134; // ST04_4@4
  int v135; // ST64_4@4
  int v136; // esi@4
  int v137; // ecx@4
  int v138; // ST70_4@4
  int v139; // esi@4
  int v140; // ecx@4
  int v141; // ST70_4@4
  int v142; // esi@4
  int v143; // edi@4
  int result; // eax@6
  int v145; // ecx@6
  int v146; // edx@6
  int v147; // ecx@6
  int v148; // edx@6
  int v149; // ecx@6
  int v150; // edx@6
  int v151; // ecx@6
  int v152; // edx@6
  int v153; // ecx@6
  int v154; // edx@6
  int v155; // ecx@6
  int v156; // edx@6
  int v157; // ecx@6
  int v158; // edx@6
  int v159; // [sp+10h] [bp-168h]@3
  int v160; // [sp+18h] [bp-160h]@3
  unsigned __int64 v161; // [sp+1Ch] [bp-15Ch]@3
  unsigned __int64 v162; // [sp+24h] [bp-154h]@3
  unsigned __int64 v163; // [sp+2Ch] [bp-14Ch]@3
  unsigned __int64 v164; // [sp+34h] [bp-144h]@3
  unsigned __int64 v165; // [sp+3Ch] [bp-13Ch]@3
  int v166; // [sp+44h] [bp-134h]@3
  int v167; // [sp+48h] [bp-130h]@3
  signed int v168; // [sp+6Ch] [bp-10Ch]@3
  unsigned __int64 v169; // [sp+70h] [bp-108h]@3
  __int64 v170; // [sp+78h] [bp-100h]@3
  __int64 v171; // [sp+80h] [bp-F8h]@3
  __int64 v172; // [sp+88h] [bp-F0h]@3
  __int64 v173; // [sp+90h] [bp-E8h]@3
  __int64 v174; // [sp+98h] [bp-E0h]@3
  __int64 v175; // [sp+A0h] [bp-D8h]@3
  unsigned __int64 v176; // [sp+A8h] [bp-D0h]@3
  __int64 v177; // [sp+B0h] [bp-C8h]@3
  int v178; // [sp+ECh] [bp-8Ch]@1
  unsigned __int64 v179; // [sp+F0h] [bp-88h]@3
  unsigned __int64 v180; // [sp+F8h] [bp-80h]@3
  unsigned __int64 v181; // [sp+100h] [bp-78h]@3
  unsigned __int64 v182; // [sp+108h] [bp-70h]@3
  unsigned __int64 v183; // [sp+110h] [bp-68h]@3
  unsigned __int64 v184; // [sp+118h] [bp-60h]@3
  unsigned __int64 v185; // [sp+120h] [bp-58h]@3
  __int64 v186; // [sp+128h] [bp-50h]@2
  __int64 v187; // [sp+130h] [bp-48h]@3
  __int64 v188; // [sp+138h] [bp-40h]@3
  __int64 v189; // [sp+140h] [bp-38h]@3
  __int64 v190; // [sp+148h] [bp-30h]@3
  __int64 v191; // [sp+150h] [bp-28h]@3
  __int64 v192; // [sp+158h] [bp-20h]@3
  __int64 v193; // [sp+160h] [bp-18h]@3

  v178 = 0;
  v1 = a1 + 64;
  do
  {
    v2 = ((unsigned __int64)*(_BYTE *)(v1 + 5) >> 16) ^ ((unsigned __int64)*(_BYTE *)(v1 + 4) >> 8) ^ *(_BYTE *)(v1 + 3) ^ (*(_BYTE *)(v1 + 2) << 8) ^ (*(_BYTE *)(v1 + 1) << 16) ^ (*(_BYTE *)v1 << 24);
    v3 = (*(_BYTE *)(v1 + 5) << 16) ^ (*(_BYTE *)(v1 + 4) << 24) ^ *(_BYTE *)(v1 + 7);
    v4 = *(_BYTE *)(v1 + 6);
    v1 += 8;
    *((_DWORD *)&v186 + 2 * v178) = (v4 << 8) ^ v3;
    *((_DWORD *)&v186 + 2 * v178++ + 1) = ((unsigned __int64)v4 >> 24) ^ v2;
  }
  while ( v178 != 8 );
  v159 = HIDWORD(v187);
  v185 = *(_QWORD *)a1;
  v167 = HIDWORD(v186) ^ (*(_QWORD *)a1 >> 32);
  v184 = *(_QWORD *)(a1 + 8);
  v175 = v187 ^ v184;
  v160 = HIDWORD(v188);
  v161 = __PAIR__(HIDWORD(v189), (unsigned int)v188);
  v183 = *(_QWORD *)(a1 + 16);
  v172 = v188 ^ v183;
  v162 = __PAIR__(HIDWORD(v190), (unsigned int)v189);
  v182 = *(_QWORD *)(a1 + 24);
  v163 = __PAIR__(HIDWORD(v191), (unsigned int)v190);
  v174 = v189 ^ v182;
  v181 = *(_QWORD *)(a1 + 32);
  v164 = __PAIR__(HIDWORD(v192), (unsigned int)v191);
  v173 = v190 ^ v181;
  v180 = *(_QWORD *)(a1 + 40);
  v171 = v191 ^ v180;
  v165 = __PAIR__(HIDWORD(v193), (unsigned int)v192);
  v179 = *(_QWORD *)(a1 + 48);
  v170 = v192 ^ v179;
  v169 = v186 ^ __PAIR__(*(_QWORD *)a1 >> 32, *(_DWORD *)a1);
  v166 = v193;
  LODWORD(v176) = *(_DWORD *)(a1 + 56);
  v168 = 1;
  HIDWORD(v176) = *(_DWORD *)(a1 + 60);
  v177 = v193 ^ v176;
  while ( v168 != 11 )
  {
    v5 = (HIDWORD(v176) >> 16) & 0xFF;
    v6 = dword_8054C18[2 * v5] ^ dword_8058418[2 * v168] ^ dword_8057C18[2 * (unsigned __int8)v184] ^ dword_8054418[2 * (HIDWORD(v185) >> 24)];
    v7 = dword_8055C1C[2 * BYTE4(v180)] ^ dword_805541C[2 * BYTE5(v179)] ^ dword_8054C1C[2 * v5] ^ dword_805841C[2 * v168] ^ dword_8057C1C[2 * (unsigned __int8)v184] ^ dword_805441C[2 * (HIDWORD(v185) >> 24)];
    v8 = (unsigned __int8)(v181 >> 24);
    v9 = dword_8056418[2 * v8] ^ dword_8055C18[2 * BYTE4(v180)] ^ dword_8055418[2 * BYTE5(v179)] ^ v6;
    v10 = dword_805641C[2 * v8] ^ v7;
    v11 = (unsigned __int8)(v182 >> 16);
    v12 = dword_8057418[2 * BYTE1(v183)] ^ dword_8056C18[2 * v11] ^ v9;
    v13 = dword_805741C[2 * BYTE1(v183)] ^ dword_8056C1C[2 * v11] ^ v10;
    v14 = (HIDWORD(v185) >> 16) & 0xFF;
    v15 = dword_8055C1C[2 * BYTE4(v179)] ^ dword_805541C[2 * BYTE5(v176)] ^ dword_8054C1C[2 * v14] ^ dword_805441C[2 * (HIDWORD(v184) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v183];
    v16 = dword_8055C18[2 * BYTE4(v179)] ^ dword_8055418[2 * BYTE5(v176)] ^ dword_8054C18[2 * v14] ^ dword_8054418[2 * (HIDWORD(v184) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v183];
    v17 = (unsigned __int8)(v180 >> 24);
    v18 = dword_8056418[2 * v17] ^ v16;
    v19 = dword_805641C[2 * v17] ^ v15;
    v20 = (unsigned __int8)(v181 >> 16);
    v21 = dword_805741C[2 * BYTE1(v182)] ^ dword_8056C1C[2 * v20] ^ v19;
    v22 = dword_8057418[2 * BYTE1(v182)] ^ dword_8056C18[2 * v20] ^ v18;
    v23 = (HIDWORD(v184) >> 16) & 0xFF;
    v24 = dword_8055C1C[2 * BYTE4(v176)] ^ dword_805541C[2 * BYTE5(v185)] ^ dword_8054C1C[2 * v23] ^ dword_805441C[2 * (HIDWORD(v183) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v182];
    v25 = dword_8055C18[2 * BYTE4(v176)] ^ dword_8055418[2 * BYTE5(v185)] ^ dword_8054C18[2 * v23] ^ dword_8054418[2 * (HIDWORD(v183) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v182];
    v26 = (unsigned __int8)(v179 >> 24);
    v27 = dword_805641C[2 * v26] ^ v24;
    v28 = dword_8056418[2 * v26] ^ v25;
    v29 = (unsigned __int8)(v180 >> 16);
    v30 = dword_8057418[2 * BYTE1(v181)] ^ dword_8056C18[2 * v29] ^ v28;
    v31 = dword_805741C[2 * BYTE1(v181)] ^ dword_8056C1C[2 * v29] ^ v27;
    v32 = (HIDWORD(v183) >> 16) & 0xFF;
    v33 = dword_8055C1C[2 * BYTE4(v185)] ^ dword_805541C[2 * BYTE5(v184)] ^ dword_8054C1C[2 * v32] ^ dword_805441C[2 * (HIDWORD(v182) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v181];
    v34 = dword_8055C18[2 * BYTE4(v185)] ^ dword_8055418[2 * BYTE5(v184)] ^ dword_8054C18[2 * v32] ^ dword_8054418[2 * (HIDWORD(v182) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v181];
    v35 = (unsigned __int8)(v176 >> 24);
    v36 = dword_8056418[2 * v35] ^ v34;
    v37 = dword_805641C[2 * v35] ^ v33;
    v38 = (unsigned __int8)(v179 >> 16);
    v39 = dword_805741C[2 * BYTE1(v180)] ^ dword_8056C1C[2 * v38] ^ v37;
    v40 = dword_8057418[2 * BYTE1(v180)] ^ dword_8056C18[2 * v38] ^ v36;
    v41 = (HIDWORD(v182) >> 16) & 0xFF;
    v42 = dword_8055C1C[2 * BYTE4(v184)] ^ dword_805541C[2 * BYTE5(v183)] ^ dword_8054C1C[2 * v41] ^ dword_805441C[2 * (HIDWORD(v181) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v180];
    v43 = dword_8055C18[2 * BYTE4(v184)] ^ dword_8055418[2 * BYTE5(v183)] ^ dword_8054C18[2 * v41] ^ dword_8054418[2 * (HIDWORD(v181) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v180];
    v44 = (unsigned __int8)(v185 >> 24);
    v45 = dword_805641C[2 * v44] ^ v42;
    v46 = dword_8056418[2 * v44] ^ v43;
    v47 = (unsigned __int8)(v176 >> 16);
    v48 = dword_8057418[2 * BYTE1(v179)] ^ dword_8056C18[2 * v47] ^ v46;
    v49 = dword_805741C[2 * BYTE1(v179)] ^ dword_8056C1C[2 * v47] ^ v45;
    v50 = (HIDWORD(v181) >> 16) & 0xFF;
    v51 = dword_8055C18[2 * BYTE4(v183)] ^ dword_8055418[2 * BYTE5(v182)] ^ dword_8054C18[2 * v50] ^ dword_8054418[2 * (HIDWORD(v180) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v179];
    v52 = dword_8055C1C[2 * BYTE4(v183)] ^ dword_805541C[2 * BYTE5(v182)] ^ dword_8054C1C[2 * v50] ^ dword_805441C[2 * (HIDWORD(v180) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v179];
    v53 = (unsigned __int8)(v184 >> 24);
    v54 = dword_805641C[2 * v53] ^ v52;
    v55 = dword_8056418[2 * v53] ^ v51;
    v56 = (unsigned __int8)(v185 >> 16);
    v57 = dword_805741C[2 * BYTE1(v176)] ^ dword_8056C1C[2 * v56] ^ v54;
    v58 = dword_8057418[2 * BYTE1(v176)] ^ dword_8056C18[2 * v56] ^ v55;
    v59 = (HIDWORD(v180) >> 16) & 0xFF;
    v60 = dword_8055C1C[2 * BYTE4(v182)] ^ dword_805541C[2 * BYTE5(v181)] ^ dword_8054C1C[2 * v59] ^ dword_805441C[2 * (HIDWORD(v179) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v176];
    v61 = dword_8055C18[2 * BYTE4(v182)] ^ dword_8055418[2 * BYTE5(v181)] ^ dword_8054C18[2 * v59] ^ dword_8054418[2 * (HIDWORD(v179) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v176];
    v62 = (unsigned __int8)(v183 >> 24);
    v63 = dword_805641C[2 * v62] ^ v60;
    v64 = dword_8056418[2 * v62] ^ v61;
    v65 = (unsigned __int8)(v184 >> 16);
    v66 = dword_8057418[2 * BYTE1(v185)] ^ dword_8056C18[2 * v65] ^ v64;
    v67 = dword_805741C[2 * BYTE1(v185)] ^ dword_8056C1C[2 * v65] ^ v63;
    v68 = (HIDWORD(v179) >> 16) & 0xFF;
    v69 = dword_8055C1C[2 * BYTE4(v181)] ^ dword_805541C[2 * BYTE5(v180)] ^ dword_8054C1C[2 * v68] ^ dword_805441C[2 * (HIDWORD(v176) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v185];
    v70 = dword_8055C18[2 * BYTE4(v181)] ^ dword_8055418[2 * BYTE5(v180)] ^ dword_8054C18[2 * v68] ^ dword_8054418[2 * (HIDWORD(v176) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v185];
    v71 = (unsigned __int8)(v182 >> 24);
    v72 = dword_8056418[2 * v71] ^ v70;
    v73 = dword_805641C[2 * v71] ^ v69;
    v74 = (unsigned __int8)(v183 >> 16);
    LODWORD(v176) = dword_8057418[2 * BYTE1(v184)] ^ dword_8056C18[2 * v74] ^ v72;
    HIDWORD(v176) = dword_805741C[2 * BYTE1(v184)] ^ dword_8056C1C[2 * v74] ^ v73;
    v75 = (HIDWORD(v177) >> 16) & 0xFF;
    v76 = dword_8055C1C[2 * BYTE4(v171)] ^ dword_805541C[2 * BYTE5(v170)] ^ dword_8054C1C[2 * v75] ^ dword_805441C[2 * (HIDWORD(v169) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v175];
    v77 = dword_8055C18[2 * BYTE4(v171)] ^ dword_8055418[2 * BYTE5(v170)] ^ dword_8054C18[2 * v75] ^ dword_8054418[2 * (HIDWORD(v169) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v175];
    v78 = (unsigned __int8)((unsigned __int64)v173 >> 24);
    v79 = dword_805641C[2 * v78] ^ v76;
    v80 = dword_8056418[2 * v78] ^ v77;
    v81 = (unsigned __int8)((unsigned __int64)v174 >> 16);
    v82 = dword_8057418[2 * BYTE1(v172)] ^ dword_8056C18[2 * v81] ^ v80;
    v83 = dword_805741C[2 * BYTE1(v172)] ^ dword_8056C1C[2 * v81] ^ v79;
    v84 = (HIDWORD(v169) >> 16) & 0xFF;
    v85 = dword_8055C1C[2 * BYTE4(v170)] ^ dword_805541C[2 * BYTE5(v177)] ^ dword_8054C1C[2 * v84] ^ dword_805441C[2 * (HIDWORD(v175) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v172];
    v86 = dword_8055C18[2 * BYTE4(v170)] ^ dword_8055418[2 * BYTE5(v177)] ^ dword_8054C18[2 * v84] ^ dword_8054418[2 * (HIDWORD(v175) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v172];
    v87 = (unsigned __int8)((unsigned __int64)v171 >> 24);
    v88 = dword_8056418[2 * v87] ^ v86;
    v89 = dword_805641C[2 * v87] ^ v85;
    v90 = (unsigned __int8)((unsigned __int64)v173 >> 16);
    v91 = dword_8057418[2 * BYTE1(v174)] ^ dword_8056C18[2 * v90] ^ v88;
    v92 = dword_805741C[2 * BYTE1(v174)] ^ dword_8056C1C[2 * v90] ^ v89;
    v93 = (HIDWORD(v175) >> 16) & 0xFF;
    v94 = dword_805541C[2 * BYTE5(v169)] ^ dword_8054C1C[2 * v93] ^ dword_805441C[2 * (HIDWORD(v172) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v174];
    v95 = dword_8055C18[2 * BYTE4(v177)] ^ dword_8055418[2 * BYTE5(v169)] ^ dword_8054C18[2 * v93] ^ dword_8054418[2 * (HIDWORD(v172) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v174];
    v96 = (unsigned __int8)((unsigned __int64)v170 >> 24);
    v97 = dword_805641C[2 * v96] ^ dword_8055C1C[2 * BYTE4(v177)] ^ v94;
    v98 = dword_8056418[2 * v96] ^ v95;
    v99 = (unsigned __int8)((unsigned __int64)v171 >> 16);
    HIDWORD(v100) = v31 ^ dword_805741C[2 * BYTE1(v173)] ^ dword_8056C1C[2 * v99] ^ v97;
    LODWORD(v100) = v30 ^ dword_8057418[2 * BYTE1(v173)] ^ dword_8056C18[2 * v99] ^ v98;
    v101 = (HIDWORD(v172) >> 16) & 0xFF;
    v102 = dword_8055C1C[2 * BYTE4(v169)] ^ dword_805541C[2 * BYTE5(v175)] ^ dword_8054C1C[2 * v101] ^ dword_805441C[2 * (HIDWORD(v174) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v173];
    v103 = dword_8055C18[2 * BYTE4(v169)] ^ dword_8055418[2 * BYTE5(v175)] ^ dword_8054C18[2 * v101] ^ dword_8054418[2 * (HIDWORD(v174) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v173];
    v104 = (unsigned __int8)((unsigned __int64)v177 >> 24);
    v105 = dword_8056418[2 * v104] ^ v103;
    v106 = dword_805641C[2 * v104] ^ v102;
    v107 = (unsigned __int8)((unsigned __int64)v170 >> 16);
    v108 = dword_805741C[2 * BYTE1(v171)] ^ dword_8056C1C[2 * v107] ^ v106;
    v109 = dword_8057418[2 * BYTE1(v171)] ^ dword_8056C18[2 * v107] ^ v105;
    v110 = (HIDWORD(v174) >> 16) & 0xFF;
    v111 = dword_8055C1C[2 * BYTE4(v175)] ^ dword_805541C[2 * BYTE5(v172)] ^ dword_8054C1C[2 * v110] ^ dword_805441C[2 * (HIDWORD(v173) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v171];
    v112 = dword_8055C18[2 * BYTE4(v175)] ^ dword_8055418[2 * BYTE5(v172)] ^ dword_8054C18[2 * v110] ^ dword_8054418[2 * (HIDWORD(v173) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v171];
    v113 = (unsigned __int8)(v169 >> 24);
    v114 = dword_805641C[2 * v113] ^ v111;
    v115 = dword_8056418[2 * v113] ^ v112;
    v116 = (unsigned __int8)((unsigned __int64)v177 >> 16);
    v117 = dword_8057418[2 * BYTE1(v170)] ^ dword_8056C18[2 * v116] ^ v115;
    v118 = dword_805741C[2 * BYTE1(v170)] ^ dword_8056C1C[2 * v116] ^ v114;
    v119 = (HIDWORD(v173) >> 16) & 0xFF;
    v120 = dword_8055C1C[2 * BYTE4(v172)] ^ dword_805541C[2 * BYTE5(v174)] ^ dword_8054C1C[2 * v119] ^ dword_805441C[2 * (HIDWORD(v171) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v170];
    v121 = dword_8055C18[2 * BYTE4(v172)] ^ dword_8055418[2 * BYTE5(v174)] ^ dword_8054C18[2 * v119] ^ dword_8054418[2 * (HIDWORD(v171) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v170];
    v122 = (unsigned __int8)((unsigned __int64)v175 >> 24);
    v123 = dword_805641C[2 * v122] ^ v120;
    v124 = dword_8056418[2 * v122] ^ v121;
    v125 = (unsigned __int8)(v169 >> 16);
    HIDWORD(v126) = v57 ^ dword_805741C[2 * BYTE1(v177)] ^ dword_8056C1C[2 * v125] ^ v123;
    LODWORD(v126) = v58 ^ dword_8057418[2 * BYTE1(v177)] ^ dword_8056C18[2 * v125] ^ v124;
    v127 = (HIDWORD(v171) >> 16) & 0xFF;
    v128 = dword_805541C[2 * BYTE5(v173)] ^ dword_8054C1C[2 * v127] ^ dword_805441C[2 * (HIDWORD(v170) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v177];
    v129 = dword_8055C18[2 * BYTE4(v174)] ^ dword_8055418[2 * BYTE5(v173)] ^ dword_8054C18[2 * v127] ^ dword_8054418[2 * (HIDWORD(v170) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v177];
    v130 = (unsigned __int8)((unsigned __int64)v172 >> 24);
    v131 = dword_805641C[2 * v130] ^ dword_8055C1C[2 * BYTE4(v174)] ^ v128;
    v132 = dword_8056418[2 * v130] ^ v129;
    v133 = (unsigned __int8)((unsigned __int64)v175 >> 16);
    v134 = dword_8057418[2 * BYTE1(v169)] ^ dword_8056C18[2 * v133] ^ v132;
    v135 = v67 ^ dword_805741C[2 * BYTE1(v169)] ^ dword_8056C1C[2 * v133] ^ v131;
    v136 = (HIDWORD(v170) >> 16) & 0xFF;
    v137 = dword_8055C1C[2 * BYTE4(v173)] ^ dword_805541C[2 * BYTE5(v171)] ^ dword_8054C1C[2 * v136] ^ dword_805441C[2 * (HIDWORD(v177) >> 24)] ^ dword_8057C1C[2 * (unsigned __int8)v169];
    v138 = dword_8055C18[2 * BYTE4(v173)] ^ dword_8055418[2 * BYTE5(v171)] ^ dword_8054C18[2 * v136] ^ dword_8054418[2 * (HIDWORD(v177) >> 24)] ^ dword_8057C18[2 * (unsigned __int8)v169];
    v139 = (unsigned __int8)((unsigned __int64)v174 >> 24);
    v140 = dword_805641C[2 * v139] ^ v137;
    v141 = dword_8056418[2 * v139] ^ v138;
    v142 = (unsigned __int8)((unsigned __int64)v172 >> 16);
    LODWORD(v177) = v176 ^ dword_8057418[2 * BYTE1(v175)] ^ dword_8056C18[2 * v142] ^ v141;
    HIDWORD(v177) = HIDWORD(v176) ^ dword_805741C[2 * BYTE1(v175)] ^ dword_8056C1C[2 * v142] ^ v140;
    v172 = v100 + 1;
    v171 = v126 + 1;
    v170 = __PAIR__(v135, v66 ^ (unsigned int)v134) + 1;
    LODWORD(v169) = v12 ^ v82;
    LODWORD(v175) = v22 ^ v91;
    HIDWORD(v175) = v21 ^ v92;
    HIDWORD(v169) = v13 ^ v83;
    LODWORD(v174) = v40 ^ v109;
    HIDWORD(v174) = v39 ^ v108;
    v143 = v49 ^ v118;
    ++v168;
    LODWORD(v173) = v48 ^ v117;
    v184 = __PAIR__(v21, v22);
    HIDWORD(v173) = v143;
    v185 = __PAIR__(v13, v12);
    v183 = __PAIR__(v31, v30);
    v181 = __PAIR__(v49, v48);
    v182 = __PAIR__(v39, v40);
    v180 = __PAIR__(v57, v58);
    v179 = __PAIR__(v67, v66);
  }
  result = a1;
  v145 = *(_DWORD *)(a1 + 8) ^ v187;
  *(_DWORD *)a1 ^= v169 ^ (unsigned int)v186;
  *(_DWORD *)(a1 + 4) = HIDWORD(v169) ^ v167;
  v146 = *(_DWORD *)(a1 + 12) ^ v159;
  *(_DWORD *)(a1 + 8) = v175 ^ v145;
  v147 = v172 ^ *(_DWORD *)(a1 + 16) ^ v161;
  *(_DWORD *)(a1 + 12) = HIDWORD(v175) ^ v146;
  v148 = *(_DWORD *)(a1 + 20) ^ v160;
  *(_DWORD *)(a1 + 16) = v147;
  v149 = v174 ^ *(_DWORD *)(a1 + 24) ^ v162;
  *(_DWORD *)(a1 + 20) = HIDWORD(v172) ^ v148;
  v150 = *(_DWORD *)(a1 + 28) ^ HIDWORD(v161);
  *(_DWORD *)(a1 + 24) = v149;
  v151 = v173 ^ *(_DWORD *)(a1 + 32) ^ v163;
  *(_DWORD *)(a1 + 28) = HIDWORD(v174) ^ v150;
  v152 = *(_DWORD *)(a1 + 36) ^ HIDWORD(v162);
  *(_DWORD *)(a1 + 32) = v151;
  v153 = v171 ^ *(_DWORD *)(a1 + 40) ^ v164;
  *(_DWORD *)(a1 + 36) = HIDWORD(v173) ^ v152;
  v154 = HIDWORD(v171) ^ *(_DWORD *)(a1 + 44) ^ HIDWORD(v163);
  *(_DWORD *)(a1 + 40) = v153;
  v155 = *(_DWORD *)(a1 + 48) ^ v165;
  *(_DWORD *)(a1 + 44) = v154;
  v156 = HIDWORD(v170) ^ *(_DWORD *)(a1 + 52) ^ HIDWORD(v164);
  *(_DWORD *)(a1 + 48) = v170 ^ v155;
  v157 = *(_DWORD *)(a1 + 56) ^ v166;
  *(_DWORD *)(a1 + 52) = v156;
  v158 = HIDWORD(v177) ^ *(_DWORD *)(a1 + 60) ^ HIDWORD(v165);
  *(_DWORD *)(a1 + 56) = v177 ^ v157;
  *(_DWORD *)(a1 + 60) = v158;
  return result;
}
// 8054418: using guessed type int dword_8054418[];
// 805441C: using guessed type int dword_805441C[];
// 8054C18: using guessed type int dword_8054C18[];
// 8054C1C: using guessed type int dword_8054C1C[];
// 8055418: using guessed type int dword_8055418[];
// 805541C: using guessed type int dword_805541C[];
// 8055C18: using guessed type int dword_8055C18[];
// 8055C1C: using guessed type int dword_8055C1C[];
// 8056418: using guessed type int dword_8056418[];
// 805641C: using guessed type int dword_805641C[];
// 8056C18: using guessed type int dword_8056C18[];
// 8056C1C: using guessed type int dword_8056C1C[];
// 8057418: using guessed type int dword_8057418[];
// 805741C: using guessed type int dword_805741C[];
// 8057C18: using guessed type int dword_8057C18[];
// 8057C1C: using guessed type int dword_8057C1C[];
// 8058418: using guessed type int dword_8058418[];
// 805841C: using guessed type int dword_805841C[];

//----- (0804DB51) --------------------------------------------------------
int __cdecl sub_804DB51(int a1)
{
  int result; // eax@1

  result = a1;
  *(_BYTE *)(a1 + 64) = 0;
  *(_DWORD *)a1 = 0;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 3;
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 16) = 5;
  *(_DWORD *)(a1 + 20) = 0;
  *(_DWORD *)(a1 + 24) = 2;
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 32) = 1;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 40) = 7;
  *(_DWORD *)(a1 + 44) = 0;
  *(_DWORD *)(a1 + 48) = 4;
  *(_DWORD *)(a1 + 52) = 0;
  *(_DWORD *)(a1 + 56) = 6;
  *(_DWORD *)(a1 + 60) = 0;
  return result;
}

//----- (0804DBCC) --------------------------------------------------------
int __cdecl sub_804DBCC(int a1, int a2)
{
  int result; // eax@1
  int v3; // edx@1
  int v4; // ebx@2

  result = 0;
  v3 = a2;
  do
  {
    *(_BYTE *)v3 = *(_BYTE *)(a1 + 8 * result + 7);
    *(_BYTE *)(v3 + 1) = *(_WORD *)(a1 + 8 * result + 6);
    *(_BYTE *)(v3 + 2) = *(_WORD *)(a1 + 8 * result + 4) >> 8;
    *(_BYTE *)(v3 + 3) = *(_DWORD *)(a1 + 8 * result + 4);
    *(_BYTE *)(v3 + 4) = *(_QWORD *)(a1 + 8 * result) >> 24;
    *(_BYTE *)(v3 + 5) = *(_QWORD *)(a1 + 8 * result) >> 16;
    *(_BYTE *)(v3 + 6) = *(_WORD *)(a1 + 8 * result) >> 8;
    v4 = *(_DWORD *)(a1 + 8 * result++);
    *(_BYTE *)(v3 + 7) = v4;
    v3 += 8;
  }
  while ( result != 8 );
  return result;
}

//----- (0804DC36) --------------------------------------------------------
int __cdecl sub_804DC36(int a1, unsigned int a2, int a3, int a4)
{
  int v4; // ecx@1
  int v5; // edx@1
  unsigned int v6; // ebx@3
  int result; // eax@8
  char v8[59]; // [sp+2Ch] [bp-5Ch]@1
  char v9; // [sp+67h] [bp-21h]@5
  char v10; // [sp+68h] [bp-20h]@4
  char v11; // [sp+69h] [bp-1Fh]@4
  char v12; // [sp+6Ah] [bp-1Eh]@4
  char v13; // [sp+6Bh] [bp-1Dh]@4
  int v14; // [sp+6Ch] [bp-1Ch]@1

  v14 = *MK_FP(__GS__, 20);
  memset(v8, 0, 0x40u);
  __memcpy_chk(v8, a1, a2, 64);
  v5 = a4;
  if ( a2 > 0x40 )
    goto LABEL_8;
  if ( a2 == 64 )
    goto LABEL_6;
  v8[a2] = -128;
  v6 = 8 * a3;
  if ( a2 - 32 > 0x1F )
  {
    v12 = BYTE1(v6);
    v13 = 8 * a3;
    v11 = v6 >> 16;
    v10 = (unsigned int)(8 * a3) >> 24;
    v9 = 0;
LABEL_6:
    memcpy((void *)(a4 + 64), v8, 0x40u);
    goto LABEL_7;
  }
  memcpy((void *)(a4 + 64), v8, 0x40u);
  sub_804C480(a4);
  memset(v8, 0, 0x40u);
  v12 = BYTE1(v6);
  v13 = 8 * a3;
  v11 = v6 >> 16;
  v10 = (unsigned int)(8 * a3) >> 24;
  memcpy((void *)(a4 + 64), v8, 0x40u);
  v5 = a4;
LABEL_7:
  sub_804C480(v5);
LABEL_8:
  result = *MK_FP(__GS__, 20) ^ v14;
  if ( *MK_FP(__GS__, 20) != v14 )
    __stack_chk_fail(v4, v5);
  return result;
}
// 8048DA0: using guessed type int __cdecl __memcpy_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804DC36: using guessed type char var_5C[59];

//----- (0804DD86) --------------------------------------------------------
int __cdecl sub_804DD86(int a1, int a2)
{
  int v2; // eax@1
  int v3; // edx@2
  int result; // eax@3
  char v5[64]; // [sp+14h] [bp-4Ch]@1
  int v6; // [sp+54h] [bp-Ch]@1

  v6 = *MK_FP(__GS__, 20);
  off_80584AC[(*(_BYTE *)(a1 + 3) + (signed int)*(_BYTE *)a1) % 5u](a1, (int)v5);
  v2 = 0;
  do
  {
    *(_BYTE *)(a2 + 2 * v2) = byte_80584D1[(unsigned __int8)v5[v2] >> 4];
    v3 = v5[v2] & 0xF;
    LOBYTE(v3) = byte_80584D1[v3];
    *(_BYTE *)(a2 + 2 * v2++ + 1) = v3;
  }
  while ( v2 != 64 );
  *(_BYTE *)(a2 + 128) = 0;
  result = *MK_FP(__GS__, 20) ^ v6;
  if ( *MK_FP(__GS__, 20) != v6 )
    __stack_chk_fail(v5, v3);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 80584AC: using guessed type int (__cdecl *off_80584AC[5])(int, int);
// 804DD86: using guessed type char var_4C[64];

//----- (0804DE0D) --------------------------------------------------------
void __cdecl sub_804DE0D()
{
  if ( ptr )
  {
    free(ptr);
    ptr = 0;
  }
  if ( dword_805B49C )
  {
    free(dword_805B49C);
    dword_805B49C = 0;
  }
}

//----- (0804DE53) --------------------------------------------------------
signed int __cdecl sub_804DE53(const char *filename)
{
  FILE *v1; // esi@1
  void *v2; // edi@2
  void *v3; // ebx@2
  int v4; // ecx@3
  int v5; // edx@3
  int v6; // ST34_4@4
  int v7; // eax@4
  int v8; // ebx@5
  size_t v9; // ST3C_4@5
  void *v10; // edi@5
  signed int i; // eax@6
  signed int v12; // ebx@9
  int v13; // eax@13
  void *v14; // ST10_4@15
  int v16; // [sp+18h] [bp-28h]@4
  int v17; // [sp+20h] [bp-20h]@3
  int v18; // [sp+20h] [bp-20h]@5
  int size; // [sp+24h] [bp-1Ch]@4

  v1 = fopen(filename, "rb");
  if ( !v1 )
    goto LABEL_23;
  v2 = malloc(0x1000u);
  v3 = v2;
  if ( fread(v2, 0x1000u, 1u, v1) )
  {
    v4 = 0;
    v5 = (int)((char *)v2 + *((_DWORD *)v2 + 15));
    v17 = *(_WORD *)(v5 + 6) - 1;
    do
    {
      v13 = v17 - v4;
      if ( v17 - v4 == -1 )
      {
        v3 = v2;
        goto LABEL_19;
      }
      size = 40 * v13;
      v16 = v5;
      v6 = v4;
      v7 = strcmp((const char *)(v5 + 40 * v13 + 248), ".rsrc");
      v5 = v16;
      v4 = v6 + 1;
    }
    while ( v7 );
    v8 = v16 + size;
    fseek(v1, *(_DWORD *)(v16 + size + 268), 0);
    v9 = *(_DWORD *)(v16 + size + 264);
    v18 = *(_DWORD *)(v8 + 260);
    free(v2);
    v3 = malloc(v9);
    v10 = v3;
    if ( fread(v3, v9, 1u, v1) )
    {
      for ( i = 0; i < *((_WORD *)v3 + 7); ++i )
      {
        if ( *((_WORD *)v3 + 4 * i + 8) == 16 && *((_BYTE *)v3 + 8 * (i + 2) + 3) >= 0 )
        {
          v12 = *(_DWORD *)((char *)v3
                          + *(_DWORD *)((char *)v3
                                      + *(_DWORD *)((char *)v3
                                                  + (*(_DWORD *)((char *)v3
                                                               + (*((_DWORD *)v3 + 2 * (i + 2) + 1) & 0x7FFFFFFF)
                                                               + 20) & 0x7FFFFFFF)
                                                  + 20))
                          - v18
                          + 48);
          fclose(v1);
          free(v10);
          return v12;
        }
      }
    }
  }
LABEL_19:
  fclose(v1);
  if ( v3 )
  {
    v14 = v3;
    v12 = -1;
    free(v14);
  }
  else
  {
LABEL_23:
    v12 = -1;
  }
  return v12;
}

//----- (0804DFD3) --------------------------------------------------------
void *__usercall sub_804DFD3<eax>(const char *a1<eax>, size_t *a2<edx>)
{
  void *v2; // ebx@1
  FILE *v3; // esi@1
  void *v4; // edi@2
  int v5; // ecx@3
  int v6; // eax@3
  int v7; // edx@4
  int v8; // ebx@5
  void *v9; // ST10_4@12
  int v11; // [sp+Ch] [bp-24h]@3
  size_t *v12; // [sp+10h] [bp-20h]@1

  v2 = 0;
  v12 = a2;
  v3 = fopen(a1, "rb");
  if ( v3 )
  {
    v4 = malloc(0x1000u);
    v2 = v4;
    if ( fread(v4, 0x1000u, 1u, v3) )
    {
      v5 = 0;
      v6 = (int)((char *)v4 + *((_DWORD *)v4 + 15));
      v11 = *(_WORD *)(v6 + 6);
      while ( v5 < v11 )
      {
        v7 = *(_DWORD *)(v6 + 284);
        v6 += 40;
        if ( v7 & 0x20000020 )
        {
          v8 = (int)((char *)v4 + 40 * v5 + *((_DWORD *)v4 + 15));
          fseek(v3, *(_DWORD *)(v8 + 268), 0);
          *v12 = *(_DWORD *)(v8 + 264);
          free(v4);
          v2 = malloc(*v12 + 256);
          if ( !fread(v2, *v12, 1u, v3) )
            break;
          fclose(v3);
          return v2;
        }
        ++v5;
      }
    }
    fclose(v3);
    if ( v2 )
    {
      v9 = v2;
      v2 = 0;
      free(v9);
    }
  }
  return v2;
}

//----- (0804E0D7) --------------------------------------------------------
void *__usercall sub_804E0D7<eax>(const char *a1<eax>, size_t *a2<edx>, int a3<ecx>)
{
  void *v3; // edi@1
  size_t *v4; // ebx@1
  FILE *v5; // eax@1
  int v6; // ecx@1
  FILE *v7; // esi@1
  int v8; // eax@4
  __int64 v9; // qax@7
  int v10; // ST28_4@8
  void *result; // eax@12
  void *v12; // [sp-8h] [bp-58h]@6
  int v13; // [sp+14h] [bp-3Ch]@1
  char ptr; // [sp+24h] [bp-2Ch]@2
  int v15; // [sp+28h] [bp-28h]@4
  int v16; // [sp+2Ch] [bp-24h]@7
  int v17; // [sp+34h] [bp-1Ch]@1

  v3 = 0;
  v4 = a2;
  v17 = *MK_FP(__GS__, 20);
  v13 = a3;
  v5 = fopen(a1, "rb");
  v7 = v5;
  if ( !v5 )
    goto LABEL_12;
  if ( !fread(&ptr, 0x10u, 1u, v5) )
    goto LABEL_14;
  if ( v13 )
  {
    HIDWORD(v9) = *(_DWORD *)&ptr ^ v15;
    LODWORD(v9) = (v16 ^ *(_DWORD *)&ptr) - (*(_DWORD *)&ptr ^ v15);
    *v4 = v9;
    if ( v9 > 0 )
    {
      v10 = HIDWORD(v9);
      v3 = malloc(v9 + 256);
      fseek(v7, v10 + 16, 0);
      if ( !fread(v3, *v4, 1u, v7) )
      {
        v12 = v3;
        goto LABEL_10;
      }
LABEL_11:
      fclose(v7);
      goto LABEL_12;
    }
  }
  else
  {
    v8 = v15 ^ *(_DWORD *)&ptr;
    *v4 = v15 ^ *(_DWORD *)&ptr;
    if ( v8 > 0 )
    {
      v3 = malloc(v8 + 256);
      if ( !fread(v3, *v4, 1u, v7) )
      {
        v12 = v3;
LABEL_10:
        free(v12);
        goto LABEL_14;
      }
      goto LABEL_11;
    }
  }
LABEL_14:
  v3 = 0;
  fclose(v7);
LABEL_12:
  result = v3;
  if ( *MK_FP(__GS__, 20) != v17 )
    __stack_chk_fail(v6, *MK_FP(__GS__, 20) ^ v17);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804E1FD) --------------------------------------------------------
int __cdecl sub_804E1FD(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ebx@5
  int v4; // eax@6
  int result; // eax@7
  int v6; // ecx@7
  char v7[64]; // [sp+14h] [bp-248h]@2
  char v8; // [sp+54h] [bp-208h]@7
  char v9; // [sp+114h] [bp-148h]@7
  char v10[128]; // [sp+197h] [bp-C5h]@4
  char v11[16]; // [sp+217h] [bp-45h]@1
  char v12[16]; // [sp+227h] [bp-35h]@1
  char v13; // [sp+237h] [bp-25h]@6
  int v14; // [sp+240h] [bp-1Ch]@1

  v14 = *MK_FP(__GS__, 20);
  sub_804A9D7(ptr, (int)v12, dword_805B4A4);
  sub_804A9D7(dword_805B49C, (int)v11, dword_805B4A8);
  v2 = 0;
  do
  {
    v7[2 * v2] = byte_80584D1[(unsigned __int8)v12[v2] >> 4];
    v7[2 * v2 + 1] = byte_80584D1[v12[v2] & 0xF];
    ++v2;
  }
  while ( v2 != 16 );
  LOBYTE(v2) = 0;
  v7[32] = 0;
  do
  {
    v10[2 * v2] = byte_80584D1[(unsigned __int8)v11[v2] >> 4];
    v10[2 * v2 + 1] = byte_80584D1[v11[v2] & 0xF];
    ++v2;
  }
  while ( v2 != 16 );
  v10[32] = 0;
  v3 = 0;
  do
  {
    __sprintf_chk(&v13, 1, 9, "%02x", *(_BYTE *)(a1 + v3));
    __strcat_chk(v7, &v13, 256);
    v4 = *(_BYTE *)(a1 + v3 + 1);
    v3 += 2;
    __sprintf_chk(&v13, 1, 9, "%02x", v4);
    __strcat_chk(v10, &v13, 128);
  }
  while ( v3 != 16 );
  __strcat_chk(v7, v10, 256);
  sub_804DB51((int)&v9);
  sub_804DC36((int)v7, 0x40u, 96, (int)&v9);
  sub_804DC36((int)&v8, 0x20u, 96, (int)&v9);
  result = sub_804DBCC((int)&v9, a2);
  if ( *MK_FP(__GS__, 20) != v14 )
    __stack_chk_fail(v6, *MK_FP(__GS__, 20) ^ v14);
  return result;
}
// 8048DD0: using guessed type int __cdecl __strcat_chk(_DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 8048F90: using guessed type int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);
// 805B4A4: using guessed type int dword_805B4A4;
// 805B4A8: using guessed type int dword_805B4A8;
// 804E1FD: using guessed type char var_35[16];
// 804E1FD: using guessed type char var_248[64];
// 804E1FD: using guessed type char var_45[16];
// 804E1FD: using guessed type char var_C5[128];

//----- (0804E3AD) --------------------------------------------------------
int __cdecl sub_804E3AD(const void *a1, int a2)
{
  const void *v2; // ebx@1
  void *v3; // eax@1
  int v4; // edx@1
  int v5; // ST24_4@2
  const void *v6; // eax@2
  _UNKNOWN *v7; // eax@3
  int v8; // edx@3
  int v9; // ecx@4
  int result; // eax@5
  unsigned int v11; // [sp+2Ch] [bp-C8h]@1
  int v12; // [sp+30h] [bp-C4h]@1
  void *ptr; // [sp+34h] [bp-C0h]@1
  unsigned int v14; // [sp+38h] [bp-BCh]@1
  char v15; // [sp+48h] [bp-ACh]@3
  char v16; // [sp+49h] [bp-ABh]@1
  int v17; // [sp+D8h] [bp-1Ch]@1

  v2 = a1;
  v17 = *MK_FP(__GS__, 20);
  v14 = (unsigned int)dword_805B4AC >> 3;
  v11 = ((unsigned int)dword_805B4AC >> 3) + 16;
  v3 = malloc(((unsigned int)dword_805B4AC >> 3) + 16);
  v4 = (int)&v16;
  ptr = v3;
  memcpy(v3, a1, 0x10u);
  v12 = 0;
  do
  {
    memcpy((char *)ptr + 16, (char *)::ptr + v12, v14);
    v5 = v4;
    v6 = sub_8049FC5(ptr, v11);
    *(_BYTE *)(v5 - 1) = *(_BYTE *)v2;
    memcpy((void *)v5, v6, 0x10u);
    LOBYTE(v6) = *((_BYTE *)v2 + 1);
    v2 = (char *)v2 + 2;
    *(_BYTE *)(v5 + 16) = (_BYTE)v6;
    v4 = v5 + 18;
    v12 += v14;
  }
  while ( (int *)(v5 + 18) != (int *)((char *)&v17 + 1) );
  free(ptr);
  v7 = sub_8049FC5(&v15, 0x90u);
  v8 = 0;
  do
  {
    *(_BYTE *)(a2 + 2 * v8) = byte_80584D1[(unsigned __int8)(*((_BYTE *)v7 + v8) >> 4)];
    v9 = *((_BYTE *)v7 + v8) & 0xF;
    LOBYTE(v9) = byte_80584D1[v9];
    *(_BYTE *)(a2 + 2 * v8++ + 1) = v9;
  }
  while ( v8 != 16 );
  *(_BYTE *)(a2 + 32) = 0;
  result = *MK_FP(__GS__, 20) ^ v17;
  if ( *MK_FP(__GS__, 20) != v17 )
    __stack_chk_fail(v9, 16);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805B4AC: using guessed type int dword_805B4AC;

//----- (0804E50D) --------------------------------------------------------
int __cdecl sub_804E50D(int a1, int a2)
{
  unsigned int v2; // esi@1
  int v3; // ebx@1
  int v4; // ST14_4@2
  const void *v5; // ebx@4
  unsigned int i; // eax@4
  unsigned int v7; // ST44_4@5
  int result; // eax@7
  int v9; // edx@7
  int v10; // ecx@7
  char v11; // [sp+38h] [bp-17Ch]@7
  char v12; // [sp+B8h] [bp-FCh]@1
  char v13; // [sp+110h] [bp-A4h]@4
  char v14; // [sp+120h] [bp-94h]@5
  char v15; // [sp+160h] [bp-54h]@7
  char v16; // [sp+178h] [bp-3Ch]@7
  char v17; // [sp+182h] [bp-32h]@7
  int v18; // [sp+192h] [bp-22h]@7
  __int16 v19; // [sp+196h] [bp-1Eh]@7
  int v20; // [sp+198h] [bp-1Ch]@1

  v2 = 0;
  v20 = *MK_FP(__GS__, 20);
  sub_804C34E((int)&v12);
  v3 = (int)ptr;
  while ( v2 < (unsigned int)dword_805B4A4 >> 6 )
  {
    ++v2;
    v4 = v3;
    v3 += 64;
    sub_804C383((int)&v12, v4, 0x40u, dword_805B4A4);
  }
  sub_804C383((int)&v12, v3, dword_805B4A4 & 0x3F, dword_805B4A4);
  sub_804AFE8((int)&v13);
  v5 = dword_805B49C;
  for ( i = 0; i < (unsigned int)dword_805B4A8 >> 6; i = v7 + 1 )
  {
    memcpy(&v14, v5, 0x40u);
    v5 = (char *)v5 + 64;
    v7 = i;
    sub_804B01D((int)&v13);
  }
  sub_804BC9B((int)&v13, (int)v5, dword_805B4A8 & 0x3F, dword_805B4A8);
  memcpy(&v15, &v12, 0x18u);
  memcpy(&v16, (const void *)a1, 0xAu);
  memcpy(&v17, &v13, 0x10u);
  v18 = *(_DWORD *)(a1 + 10);
  v19 = *(_WORD *)(a1 + 14);
  sub_804DB51((int)&v11);
  sub_804DC36((int)&v15, 0x38u, 56, (int)&v11);
  result = sub_804DBCC((int)&v11, a2);
  if ( *MK_FP(__GS__, 20) != v20 )
    __stack_chk_fail(v10, v9);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805B4A4: using guessed type int dword_805B4A4;
// 805B4A8: using guessed type int dword_805B4A8;

//----- (0804E681) --------------------------------------------------------
int __cdecl sub_804E681(int a1, int a2)
{
  int v2; // edi@1
  unsigned int i; // edx@1
  int v4; // ST14_4@2
  unsigned int v5; // ST38_4@2
  int v6; // edx@4
  int v7; // ecx@4
  int result; // eax@4
  char v9; // [sp+24h] [bp-120h]@4
  char v10; // [sp+A4h] [bp-A0h]@1
  char v11; // [sp+F4h] [bp-50h]@4
  int v12; // [sp+108h] [bp-3Ch]@4
  __int16 v13; // [sp+10Ch] [bp-38h]@4
  char v14; // [sp+10Eh] [bp-36h]@4
  char v15; // [sp+11Eh] [bp-26h]@4
  int v16; // [sp+128h] [bp-1Ch]@1

  v16 = *MK_FP(__GS__, 20);
  sub_804AFE8((int)&v10);
  v2 = (int)ptr;
  for ( i = 0; i < (unsigned int)dword_805B4A4 >> 6; i = v5 + 1 )
  {
    v4 = v2;
    v2 += 64;
    v5 = i;
    sub_804BC9B((int)&v10, v4, 0x40u, dword_805B4A4);
  }
  sub_804BC9B((int)&v10, v2, dword_805B4A4 & 0x3F, dword_805B4A4);
  sub_804AF94(dword_805B49C, (int)&v11, dword_805B4A8);
  memcpy(&v14, &v10, 0x10u);
  v12 = *(_DWORD *)a1;
  v13 = *(_WORD *)(a1 + 4);
  memcpy(&v15, (const void *)(a1 + 6), 0xAu);
  sub_804DB51((int)&v9);
  sub_804DC36((int)&v11, 0x34u, 52, (int)&v9);
  sub_804DBCC((int)&v9, a2);
  result = *MK_FP(__GS__, 20) ^ v16;
  if ( *MK_FP(__GS__, 20) != v16 )
    __stack_chk_fail(v7, v6);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805B4A4: using guessed type int dword_805B4A4;
// 805B4A8: using guessed type int dword_805B4A8;

//----- (0804E77E) --------------------------------------------------------
int __cdecl sub_804E77E(int a1, int a2)
{
  int v2; // edx@1
  int v3; // ecx@1
  int result; // eax@1
  char v5; // [sp+18h] [bp-D4h]@1
  char v6; // [sp+98h] [bp-54h]@1
  int v7; // [sp+ACh] [bp-40h]@1
  __int16 v8; // [sp+B0h] [bp-3Ch]@1
  char v9; // [sp+B2h] [bp-3Ah]@1
  char v10; // [sp+C6h] [bp-26h]@1
  int v11; // [sp+D0h] [bp-1Ch]@1

  v11 = *MK_FP(__GS__, 20);
  sub_804AF94(ptr, (int)&v9, dword_805B4A4);
  sub_804AF94(dword_805B49C, (int)&v6, dword_805B4A8);
  v7 = *(_DWORD *)a1;
  v8 = *(_WORD *)(a1 + 4);
  memcpy(&v10, (const void *)(a1 + 6), 0xAu);
  sub_804DB51((int)&v5);
  sub_804DC36((int)&v6, 0x38u, 56, (int)&v5);
  sub_804DBCC((int)&v5, a2);
  result = *MK_FP(__GS__, 20) ^ v11;
  if ( *MK_FP(__GS__, 20) != v11 )
    __stack_chk_fail(v3, v2);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805B4A4: using guessed type int dword_805B4A4;
// 805B4A8: using guessed type int dword_805B4A8;

//----- (0804E82F) --------------------------------------------------------
int __cdecl sub_804E82F(int a1, int a2)
{
  int v2; // eax@1
  unsigned int v3; // edx@1
  int v4; // ST28_4@2
  unsigned int v5; // ST24_4@2
  int result; // eax@4
  int v7; // edx@4
  int v8; // ecx@4
  char v9; // [sp+30h] [bp-134h]@4
  char v10; // [sp+70h] [bp-F4h]@4
  char v11; // [sp+AEh] [bp-B6h]@4
  char v12; // [sp+AFh] [bp-B5h]@4
  char v13; // [sp+B0h] [bp-B4h]@1
  char v14; // [sp+C8h] [bp-9Ch]@2
  char v15; // [sp+108h] [bp-5Ch]@4
  int v16; // [sp+120h] [bp-44h]@4
  int v17; // [sp+124h] [bp-40h]@4
  char v18; // [sp+128h] [bp-3Ch]@4
  int v19; // [sp+13Ch] [bp-28h]@4
  int v20; // [sp+140h] [bp-24h]@4
  int v21; // [sp+144h] [bp-20h]@4
  int v22; // [sp+148h] [bp-1Ch]@1

  v22 = *MK_FP(__GS__, 20);
  sub_804C34E((int)&v13);
  v2 = (int)dword_805B49C;
  v3 = 0;
  while ( v3 < (unsigned int)dword_805B4A8 >> 6 )
  {
    memcpy(&v14, (const void *)v2, 0x40u);
    v4 = v2;
    v5 = v3;
    sub_804C1D1((int)&v13);
    v3 = v5 + 1;
    v2 = v4 + 64;
  }
  sub_804C383((int)&v13, v2, dword_805B4A8 & 0x3F, dword_805B4A8);
  sub_804AF94(ptr, (int)&v18, dword_805B4A4);
  memcpy(&v15, &v13, 0x18u);
  v16 = *(_DWORD *)a1;
  v17 = *(_DWORD *)(a1 + 4);
  v19 = *(_DWORD *)(a1 + 8);
  v7 = *(_DWORD *)(a1 + 12);
  v21 = 128;
  v20 = v7;
  sub_804DB51((int)&v9);
  memcpy(&v10, &v15, 0x40u);
  sub_804C480((int)&v9);
  memset(&v10, 0, 0x40u);
  v11 = 1;
  v12 = -32;
  sub_804C480((int)&v9);
  result = sub_804DBCC((int)&v9, a2);
  if ( *MK_FP(__GS__, 20) != v22 )
    __stack_chk_fail(v8, v7);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805B4A4: using guessed type int dword_805B4A4;
// 805B4A8: using guessed type int dword_805B4A8;

//----- (0804E9B3) --------------------------------------------------------
int __usercall sub_804E9B3<eax>(int a1<eax>, unsigned int a2<edx>, unsigned int a3<ecx>, int a4)
{
  unsigned int v4; // esi@1
  int v5; // ebx@1
  unsigned int i; // eax@1
  __int64 v7; // qax@4
  int v8; // ebx@4
  int v10; // [sp+Ch] [bp-804Ch]@5
  unsigned int v11; // [sp+20h] [bp-8038h]@1
  unsigned int v12; // [sp+24h] [bp-8034h]@1
  unsigned __int8 v13; // [sp+2Bh] [bp-802Dh]@4
  int v14; // [sp+2Ch] [bp-802Ch]@5
  char v15[32768]; // [sp+3Ch] [bp-801Ch]@1
  int v16; // [sp+803Ch] [bp-1Ch]@1

  v4 = a2;
  v5 = a1;
  v16 = *MK_FP(__GS__, 20);
  v12 = a1 + a3 + 1;
  v11 = a2 + a4;
  memset(v15, 538976288, sizeof(v15));
  for ( i = 0; i < a3; ++i )
    *(_BYTE *)(v5 + i) = ~*(_BYTE *)(v5 + i);
  LOBYTE(a3) = *(_BYTE *)v5;
  v7 = 0LL;
  v8 = v5 + 1;
  v13 = a3;
LABEL_14:
  if ( v8 < v12 )
  {
    a3 = 0;
    v14 = v7;
    v10 = 0;
    while ( 1 )
    {
      if ( (unsigned __int8)(1 << v10) & v13 )
      {
        HIDWORD(v7) = v7 ^ (HIDWORD(v7) << 7);
        LOBYTE(a3) = v15[HIDWORD(v7)];
      }
      else
      {
        LOBYTE(a3) = *(_BYTE *)v8++;
        if ( v8 >= v12 )
          break;
        HIDWORD(v7) = v7 ^ (HIDWORD(v7) << 7);
        v15[HIDWORD(v7)] = a3;
      }
      *(_BYTE *)v4++ = a3;
      if ( v4 >= v11 )
        break;
      ++v10;
      LODWORD(v7) = (unsigned __int8)a3;
      HIDWORD(v7) = v14;
      if ( v10 == 8 )
      {
        LOBYTE(a3) = *(_BYTE *)v8++;
        v13 = a3;
        goto LABEL_14;
      }
      v14 = (unsigned __int8)a3;
    }
  }
  if ( *MK_FP(__GS__, 20) != v16 )
    __stack_chk_fail(a3, HIDWORD(v7));
  return v7;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804E9B3: using guessed type char var_801C[32768];

//----- (0804EAD1) --------------------------------------------------------
signed int __cdecl sub_804EAD1(const char *filename, unsigned int a2, int a3)
{
  __int32 v3; // ecx@1
  signed int result; // eax@1
  void *ptr; // [sp+14h] [bp-Ch]@1

  v3 = sub_804963D(&ptr, filename);
  result = -1;
  if ( v3 >= 0 )
  {
    sub_804E9B3((int)ptr, a2, v3, a3);
    free(ptr);
    result = 0;
  }
  return result;
}

//----- (0804EB10) --------------------------------------------------------
signed int __cdecl sub_804EB10(const char *a1)
{
  char *v1; // esi@1
  void *v2; // eax@4
  unsigned int v3; // ecx@4
  signed int v4; // edx@4
  void *v5; // eax@6
  signed int result; // eax@11
  int v7; // [sp+Ch] [bp-91Ch]@7
  char dest; // [sp+80Ch] [bp-11Ch]@1
  int v9; // [sp+90Ch] [bp-1Ch]@1

  v9 = *MK_FP(__GS__, 20);
  sub_804DE0D();
  __strcpy_chk(&dest, a1, 256);
  v1 = strrchr(&dest, 47) + 1;
  if ( v1 == (char *)1 )
    v1 = &dest;
  strcpy(v1, "8021x.exe");
  ptr = sub_804DFD3(&dest, (size_t *)&dword_805B4A4);
  if ( ptr || (v2 = sub_804E0D7(a1, (size_t *)&dword_805B4A4, 0), v4 = -1, (ptr = v2) != 0) )
  {
    dword_805B4AC = dword_805B4A4;
    strcpy(v1, "W32N55.dll");
    dword_805B49C = sub_804DFD3(&dest, (size_t *)&dword_805B4A8);
    if ( dword_805B49C || (v5 = sub_804E0D7(a1, (size_t *)&dword_805B4A8, 1), v4 = -2, (dword_805B49C = v5) != 0) )
    {
      strcpy(v1, "SuConfig.dat");
      if ( sub_804EAD1(&dest, (unsigned int)&v7, 2048) || sub_804955C((int)&v7, "PUBLIC", "Title", "", &dest, 0x100u) )
      {
        v4 = 1;
      }
      else
      {
        memcpy((char *)ptr + dword_805B4A4, &dest, strlen(&dest));
        dword_805B4A4 += strlen(&dest);
        v4 = 0;
        memcpy((char *)dword_805B49C + dword_805B4A8, &dest, strlen(&dest));
        v3 = strlen(&dest);
        dword_805B4A8 += v3;
      }
    }
  }
  result = v4;
  if ( *MK_FP(__GS__, 20) != v9 )
    __stack_chk_fail(v3, *MK_FP(__GS__, 20) ^ v9);
  return result;
}
// 8048EC0: using guessed type int __cdecl __strcpy_chk(_DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805B4A4: using guessed type int dword_805B4A4;
// 805B4A8: using guessed type int dword_805B4A8;
// 805B4AC: using guessed type int dword_805B4AC;

//----- (0804ECD0) --------------------------------------------------------
char *__cdecl sub_804ECD0()
{
  char *result; // eax@1

  result = (char *)handle;
  if ( handle )
  {
    dlclose(handle);
    result = dlerror();
    handle = 0;
  }
  return result;
}

//----- (0804ECFC) --------------------------------------------------------
signed int __cdecl sub_804ECFC(int a1, int a2, int a3)
{
  __uid_t v3; // eax@1
  int v4; // eax@1
  void *v5; // esi@7
  char *v6; // eax@7
  char *v7; // ecx@7
  void *v8; // ebx@8
  char *v9; // edx@13
  int v11; // ST18_4@18
  int v12; // ST1C_4@18
  const char *v13; // [sp-Ch] [bp-24h]@12
  char *v14; // [sp-8h] [bp-20h]@12
  char *v15; // [sp-4h] [bp-1Ch]@12

  v3 = getuid();
  v4 = seteuid(v3);
  if ( !dword_805B4B0 )
  {
    if ( !handle )
    {
      handle = dlopen("libnotify.so", 1);
      dlerror();
      if ( !handle )
      {
        handle = dlopen("libnotify.so.1", 1);
        dlerror();
      }
    }
    if ( !handle )
    {
      __printf_chk(1, "!! libnotify\n", handle, handle);
LABEL_17:
      seteuid(0);
      return -1;
    }
    v5 = dlsym(handle, "notify_init");
    v6 = dlerror();
    if ( v6
      || (v8 = dlsym(handle, "notify_notification_new"), (v6 = dlerror()) != 0)
      || (dword_805B4C4 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))dlsym(handle, "notify_notification_show"),
          (v6 = dlerror()) != 0)
      || (dword_805B4BC = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD))dlsym(handle, "notify_notification_update"),
          (v6 = dlerror()) != 0)
      || (dword_805B4C0 = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD))dlsym(
                                                                             handle,
                                                                             "notify_notification_set_timeout"),
          (v6 = dlerror()) != 0) )
    {
      v15 = v7;
      v14 = v6;
      v13 = "!! libnotify: %s\n";
LABEL_16:
      __printf_chk(1, v13, v14, v15);
      sub_804ECD0();
      goto LABEL_17;
    }
    if ( !((int (__cdecl *)(_DWORD))v5)("mentohust")
      || (v4 = ((int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD))v8)("MentoHUST", 0, 0, 0), (dword_805B4B0 = v4) == 0) )
    {
      v15 = v9;
      v14 = v9;
      v13 = "!! libnotify\n";
      goto LABEL_16;
    }
  }
  dword_805B4C0(dword_805B4B0, a3, v4, v4);
  dword_805B4BC(dword_805B4B0, a1, a2, 0);
  dword_805B4C4(dword_805B4B0, 0, v11, v12);
  seteuid(0);
  return 0;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 805B4B0: using guessed type int dword_805B4B0;
// 805B4BC: using guessed type int (__cdecl *dword_805B4BC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 805B4C0: using guessed type int (__cdecl *dword_805B4C0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 805B4C4: using guessed type int (__stdcall *dword_805B4C4)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0804EEE1) --------------------------------------------------------
char *__cdecl sub_804EEE1()
{
  char *result; // eax@1

  result = (char *)dword_805B4B8;
  if ( dword_805B4B8 )
  {
    dlclose(dword_805B4B8);
    result = dlerror();
    dword_805B4B8 = 0;
  }
  return result;
}

//----- (0804EF0D) --------------------------------------------------------
signed int __cdecl sub_804EF0D()
{
  int v0; // esi@1
  const char *v1; // ST00_4@2
  char *v2; // eax@6
  int v3; // edx@16
  char v5[28]; // [sp+Ch] [bp-1Ch]@1

  memcpy(v5, off_805875C, 0x14u);
  v0 = 0;
  do
  {
    if ( dword_805B4B8 )
      break;
    v1 = *(const char **)&v5[4 * v0++];
    dword_805B4B8 = dlopen(v1, 1);
    dlerror();
  }
  while ( v0 != 5 );
  if ( !dword_805B4B8 )
  {
    __printf_chk(1, "!! libpcap\n", dword_805B4B8, dword_805B4B8);
    return -1;
  }
  dword_805BA90 = (int (__cdecl *)(_DWORD, _DWORD))dlsym(dword_805B4B8, "pcap_findalldevs");
  v2 = dlerror();
  if ( v2
    || (dword_805BAA8 = (int (__fastcall *)(_DWORD, _DWORD))dlsym(dword_805B4B8, "pcap_freealldevs"),
        (v2 = dlerror()) != 0)
    || (dword_805BA9C = (int)dlsym(dword_805B4B8, "pcap_open_live"), (v2 = dlerror()) != 0)
    || (dword_805BAA4 = (int)dlsym(dword_805B4B8, "pcap_compile"), (v2 = dlerror()) != 0)
    || (dword_805BAB0 = (int)dlsym(dword_805B4B8, "pcap_setfilter"), (v2 = dlerror()) != 0)
    || (dword_805BAA0 = (int)dlsym(dword_805B4B8, "pcap_geterr"), (v2 = dlerror()) != 0)
    || (dword_805BAB4 = (int)dlsym(dword_805B4B8, "pcap_freecode"), (v2 = dlerror()) != 0)
    || (dword_805BAB8 = (int)dlsym(dword_805B4B8, "pcap_loop"), (v2 = dlerror()) != 0)
    || (dword_805BA98 = (int (__cdecl *)(_DWORD))dlsym(dword_805B4B8, "pcap_close"), (v2 = dlerror()) != 0)
    || (dword_805BAAC = (int (__cdecl *)(_DWORD))dlsym(dword_805B4B8, "pcap_breakloop"), (v2 = dlerror()) != 0)
    || (dword_805BA94 = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD))dlsym(dword_805B4B8, "pcap_sendpacket"),
        v2 = dlerror(),
        v3 = 0,
        v2) )
  {
    __printf_chk(1, "!! libpcap: %s\n", v2, v0);
    sub_804EEE1();
    return -1;
  }
  return v3;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 805875C: using guessed type char *off_805875C[5];
// 805BA90: using guessed type int (__cdecl *dword_805BA90)(_DWORD, _DWORD);
// 805BA94: using guessed type int (__cdecl *dword_805BA94)(_DWORD, _DWORD, _DWORD, _DWORD);
// 805BA98: using guessed type int (__cdecl *dword_805BA98)(_DWORD);
// 805BA9C: using guessed type int dword_805BA9C;
// 805BAA0: using guessed type int dword_805BAA0;
// 805BAA4: using guessed type int dword_805BAA4;
// 805BAA8: using guessed type int (__fastcall *dword_805BAA8)(_DWORD, _DWORD);
// 805BAAC: using guessed type int (__cdecl *dword_805BAAC)(_DWORD);
// 805BAB0: using guessed type int dword_805BAB0;
// 805BAB4: using guessed type int dword_805BAB4;
// 805BAB8: using guessed type int dword_805BAB8;
// 804EF0D: using guessed type char var_1C[28];

//----- (0804F12C) --------------------------------------------------------
int __usercall sub_804F12C<eax>(int a1<eax>)
{
  int v1; // edx@1
  int v2; // ebx@1
  int v3; // esi@1
  unsigned __int8 v4; // cl@2
  unsigned __int8 v5; // bl@4
  int v6; // esi@4
  int v7; // ecx@4
  signed int v8; // ecx@6
  int result; // eax@7
  char v10; // [sp+Ch] [bp-21Ch]@1
  char v11[511]; // [sp+Dh] [bp-21Bh]@2
  int v12; // [sp+20Ch] [bp-1Ch]@1

  v12 = *MK_FP(__GS__, 20);
  v1 = 0;
  v2 = a1 + 22;
  memcpy(&v10, &unk_8058C30, 0x200u);
  v3 = a1 + 21;
  do
  {
    v4 = *(_BYTE *)(a1 + v1++) ^ *(_BYTE *)v3;
    *(_BYTE *)v3 = *(_BYTE *)v2 ^ v11[2 * v4];
    *(_BYTE *)v2 = *(&v10 + 2 * v4);
  }
  while ( v1 != 21 );
  LOBYTE(v1) = 0;
  do
  {
    v5 = *(_BYTE *)(a1 + v1);
    v6 = 0;
    v7 = 0;
    do
    {
      ++v6;
      v7 = v5 & 1 | 2 * v7;
      v5 >>= 1;
    }
    while ( v6 != 8 );
    v8 = ~v7;
    *(_BYTE *)(a1 + v1++) = v8;
  }
  while ( v1 != 23 );
  result = *MK_FP(__GS__, 20) ^ v12;
  if ( *MK_FP(__GS__, 20) != v12 )
    __stack_chk_fail(v8, 23);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804F12C: using guessed type char var_21B[511];

//----- (0804F1C4) --------------------------------------------------------
int __cdecl sub_804F1C4(int a1)
{
  int v1; // ecx@1
  int v2; // edx@1
  int v3; // edi@2
  int v4; // eax@2
  char v5; // bl@3
  int v7; // [sp+0h] [bp-10h]@0

  v1 = a1 + *(_BYTE *)(a1 + 27) + 157;
  v2 = 0;
  do
  {
    v3 = 0;
    BYTE3(v7) = *(_BYTE *)v1;
    v4 = 0;
    do
    {
      v5 = BYTE3(v7);
      ++v3;
      BYTE3(v7) >>= 1;
      v4 = v5 & 1 | 2 * v4;
    }
    while ( v3 != 8 );
    ++v1;
    *((_BYTE *)&dword_805B4D8 + v2++) = ~(_BYTE)v4;
  }
  while ( v2 != 4 );
  dword_805B4D8 = _byteswap_ulong(dword_805B4D8);
  return v7;
}
// 805B4D8: using guessed type int dword_805B4D8;

//----- (0804F21C) --------------------------------------------------------
int __cdecl sub_804F21C(int a1)
{
  unsigned __int32 v1; // ecx@1
  unsigned __int32 v2; // edx@1
  int result; // eax@1
  unsigned __int8 v4; // cl@2
  int v5; // edx@2
  int v6; // edx@4
  unsigned __int8 v7; // cl@4
  int v8; // [sp+0h] [bp-28h]@2
  int v9; // [sp+8h] [bp-20h]@2
  int v10; // [sp+8h] [bp-20h]@4
  unsigned __int32 v11; // [sp+14h] [bp-14h]@1
  unsigned __int32 v12; // [sp+18h] [bp-10h]@1

  v1 = _byteswap_ulong(dword_805B4DC + dword_805B4D8);
  v2 = _byteswap_ulong(dword_805B4DC++);
  result = 0;
  v12 = v1;
  v11 = v2;
  do
  {
    v4 = *((_BYTE *)&v12 + result);
    v5 = 0;
    v9 = 0;
    v8 = result;
    do
    {
      ++v9;
      v5 = v4 & 1 | 2 * v5;
      v4 >>= 1;
    }
    while ( v9 != 8 );
    *(_BYTE *)(a1 + result + 24) = ~(_BYTE)v5;
    v6 = 0;
    v7 = *((_BYTE *)&v11 + result);
    v10 = 0;
    do
    {
      ++v10;
      v6 = v7 & 1 | 2 * v6;
      v7 >>= 1;
    }
    while ( v10 != 8 );
    *(_BYTE *)(a1 + result++ + 34) = ~(_BYTE)v6;
  }
  while ( v8 != 3 );
  return result;
}
// 805B4D8: using guessed type int dword_805B4D8;
// 805B4DC: using guessed type int dword_805B4DC;

//----- (0804F2B5) --------------------------------------------------------
int __cdecl sub_804F2B5(int a1)
{
  int result; // eax@1
  int v2; // edx@1

  result = a1;
  *(_DWORD *)(a1 + 24) = dword_805BA6C;
  *(_DWORD *)(a1 + 28) = dword_805BA70;
  v2 = dword_805BA74;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 32) = v2;
  return result;
}
// 805BA6C: using guessed type int dword_805BA6C;
// 805BA70: using guessed type int dword_805BA70;
// 805BA74: using guessed type int dword_805BA74;

//----- (0804F2DF) --------------------------------------------------------
signed int __usercall sub_804F2DF<eax>(char a1<al>, const void *a2<edx>, unsigned int a3<ecx>)
{
  const void *v3; // esi@1
  size_t i; // edx@1
  signed int result; // eax@5

  v3 = a2;
  for ( i = size + 70; i < size - a3 + dword_805B4CC - 8; i += *(_BYTE *)(i + 5) + 4 )
  {
    if ( *(_BYTE *)i == 26 )
      i += 2;
    if ( *(_BYTE *)(i + 4) == a1 )
    {
      result = 0;
      memcpy((void *)(i + *(_BYTE *)(i + 5) + 4 - a3), v3, a3);
      return result;
    }
  }
  return -1;
}

//----- (0804F337) --------------------------------------------------------
_UNKNOWN *__cdecl sub_804F337(char a1, const void *a2, unsigned int a3)
{
  signed int v3; // ecx@1
  char *v4; // edi@1
  char v5; // zf@3
  int v6; // ebx@4
  unsigned int v7; // ecx@4
  _UNKNOWN *result; // eax@6
  int v9; // ecx@6
  int v10; // [sp+8h] [bp-80h]@4
  char v11; // [sp+1Ch] [bp-6Ch]@4
  char v12; // [sp+1Dh] [bp-6Bh]@4
  int v13; // [sp+6Ch] [bp-1Ch]@1

  v3 = -1;
  v4 = &byte_805B1EC;
  v13 = *MK_FP(__GS__, 20);
  do
  {
    if ( !v3 )
      break;
    v5 = *v4++ == 0;
    --v3;
  }
  while ( !v5 );
  v11 = a1;
  v10 = ~v3;
  __memcpy_chk(&v12, &byte_805B1EC, ~v3 - 1, 79);
  v6 = v10;
  v7 = 3;
  if ( dword_805BA80 % 3u == 2 )
  {
    LOBYTE(v7) = 10;
    memcpy(&v11 + v10, "xxghlmxhzb", v7);
    v6 = v10 + 10;
  }
  memcpy(&v11 + v6, a2, a3);
  result = sub_8049FC5(&v11, a3 + v6);
  if ( *MK_FP(__GS__, 20) != v13 )
    __stack_chk_fail(v9, *MK_FP(__GS__, 20) ^ v13);
  return result;
}
// 8048DA0: using guessed type int __cdecl __memcpy_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805BA80: using guessed type int dword_805BA80;

//----- (0804F3E1) --------------------------------------------------------
signed int __usercall sub_804F3E1<eax>(signed int a1<eax>)
{
  signed int v1; // esi@1
  FILE *v2; // eax@1
  FILE *v3; // ebx@1
  signed int result; // eax@6
  char v5; // [sp+17h] [bp-9h]@1

  v1 = a1;
  v5 = 0;
  v2 = fopen(&filename, "rb");
  v3 = v2;
  if ( !v2 )
  {
LABEL_8:
    __printf_chk(1, "!! %s\n", &filename, v3);
    dword_805B4D0 -= 2;
    if ( dword_805B4D0 != 1 || (signed int)dword_805B4CC > 470 )
    {
      result = -1;
    }
    else
    {
      free((void *)size);
      dword_805B4CC = 471;
      size = (size_t)malloc(0x1D7u);
      result = -1;
    }
    return result;
  }
  fseek(v2, dword_805B674 + (dword_805B4CC - 23) * v1 % 2, 0);
  if ( !fread((void *)(size + 23), dword_805B4CC - 23, 1u, v3) )
  {
    fclose(v3);
    goto LABEL_8;
  }
  fclose(v3);
  if ( dword_805BA84 == 1 )
    v5 = 1;
  sub_804F2DF(24, &v5, 1u);
  sub_804F2DF(45, &dword_805BAD0, 6u);
  result = 0;
  if ( dword_805B4D0 == 3 )
  {
    *(_WORD *)(size + 59) = word_805BABC;
    result = 0;
  }
  return result;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 805B4D0: using guessed type int dword_805B4D0;
// 805B674: using guessed type int dword_805B674;
// 805BA84: using guessed type int dword_805BA84;
// 805BABC: using guessed type __int16 word_805BABC;
// 805BAD0: using guessed type int dword_805BAD0;

//----- (0804F529) --------------------------------------------------------
int __cdecl sub_804F529()
{
  int v0; // edx@7
  int v1; // ecx@7
  int result; // eax@10
  char v3; // [sp+Bh] [bp-22Dh]@2
  char v4; // [sp+Ch] [bp-22Ch]@2
  char v5; // [sp+1CCh] [bp-6Ch]@2
  int v6; // [sp+22Ch] [bp-Ch]@1

  v6 = *MK_FP(__GS__, 20);
  if ( dword_805B4D0 > 1 )
  {
    if ( sub_804F3E1(0) == -1 )
      sub_804F529();
  }
  else
  {
    memcpy(&v5, &unk_8058BD0, 0x60u);
    v3 = 0;
    memcpy(&v4, &unk_8058A10, 0x1C0u);
    if ( dword_805BA84 == 1 )
      v3 = 1;
    if ( dword_805B4D0 == 1 )
    {
      memcpy((void *)(size + 23), &v4, 0x1C0u);
      *(_WORD *)(size + 59) = word_805BABC;
    }
    else
    {
      memcpy((void *)(size + 23), &v5, 0x60u);
    }
    sub_804F2DF(24, &v3, 1u);
    sub_804F2DF(45, &dword_805BAD0, 6u);
  }
  result = *MK_FP(__GS__, 20) ^ v6;
  if ( *MK_FP(__GS__, 20) != v6 )
    __stack_chk_fail(v1, v0);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805B4D0: using guessed type int dword_805B4D0;
// 805BA84: using guessed type int dword_805BA84;
// 805BABC: using guessed type __int16 word_805BABC;

//----- (0804F612) --------------------------------------------------------
#error "804F6B7: positive sp value has been found (funcsize=48)"

//----- (0804F6B8) --------------------------------------------------------
int __cdecl sub_804F6B8()
{
  FILE *v0; // eax@3
  int v1; // edx@3
  FILE *v2; // edi@3
  int v3; // eax@8
  int v4; // edx@12
  int v5; // ecx@12
  int result; // eax@12
  char ptr; // [sp+Ch] [bp-1Ch]@4
  int v8; // [sp+14h] [bp-14h]@7
  int v9; // [sp+1Ch] [bp-Ch]@1

  v9 = *MK_FP(__GS__, 20);
  if ( !filename )
    strcpy(&filename, off_8058E30);
  sub_804F612();
  v0 = fopen(&filename, "rb");
  v2 = v0;
  if ( v0 )
  {
    if ( fread(&ptr, 0x10u, 1u, v0) && !memcmp(&ptr, "HUST", 4u) )
    {
      dword_805B674 = (*(_DWORD *)&ptr ^ v8) + 16;
      fseek(v2, 0, 2);
      dword_805B4CC = ftell(v2);
      fclose(v2);
      v1 = dword_805B674;
      if ( dword_805B674 > 15 )
      {
        v3 = (signed int)(dword_805B4CC - dword_805B674) / 2;
        v1 = v3 + 23;
        dword_805B4CC = v3 + 23;
        if ( (unsigned int)(v3 - 105) <= 0x317 )
        {
          dword_805B4D0 += 2;
          goto LABEL_12;
        }
      }
    }
    else
    {
      fclose(v2);
    }
  }
  if ( byte_805B23E[strlen(&filename) + 1] != 47 )
    __printf_chk(1, "!! %s\n", &filename, v1);
  dword_805B4CC = (unsigned int)dword_805B4D0 < 1 ? 128 : 471;
LABEL_12:
  size = (size_t)malloc(dword_805B4CC);
  result = *MK_FP(__GS__, 20) ^ v9;
  if ( *MK_FP(__GS__, 20) != v9 )
    __stack_chk_fail(v5, v4);
  return result;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804F612: using guessed type int sub_804F612(void);
// 805B4D0: using guessed type int dword_805B4D0;
// 805B674: using guessed type int dword_805B674;

//----- (0804F81D) --------------------------------------------------------
_UNKNOWN *__cdecl sub_804F81D(int a1, signed int a2)
{
  signed int v2; // ebx@1
  _UNKNOWN *v3; // edi@3
  signed int v4; // esi@3
  int v5; // eax@4
  _UNKNOWN *v6; // ST00_4@4
  _UNKNOWN *result; // eax@6

  v2 = a2;
  if ( a2 > 128 )
    v2 = 128;
  v3 = &unk_805B4E0;
  v4 = 0;
  while ( v4 < v2 )
  {
    v5 = *(_BYTE *)(a1 + v4++);
    v6 = v3;
    v3 = (char *)v3 + 3;
    __sprintf_chk(v6, 1, -1, "%02x:", v5);
  }
  result = &unk_805B4E0;
  *((_BYTE *)&dword_805B4DC + 3 * v2 + 3) = 0;
  return result;
}
// 8048F90: using guessed type int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);
// 805B4DC: using guessed type int dword_805B4DC;

//----- (0804F87B) --------------------------------------------------------
signed int __usercall sub_804F87B<eax>(int a1<eax>)
{
  int v1; // esi@1
  _UNKNOWN *v2; // eax@1
  int v3; // edx@1
  int v4; // ecx@1
  signed int v5; // edi@1
  int v6; // ecx@2
  signed int result; // eax@2
  int v8; // ST0C_4@3
  signed int v9; // eax@3
  char v10; // [sp+Bh] [bp-9Dh]@3
  int v11; // [sp+8Ch] [bp-1Ch]@1

  v1 = a1;
  v11 = *MK_FP(__GS__, 20);
  __printf_chk(1, "** :\t%d.%d\n", *(_BYTE *)(size + 59), *(_BYTE *)(size + 60));
  v2 = sub_804F81D(v1, 16);
  __printf_chk(1, "** MD5:\t%s\n", v2);
  v5 = sub_804EB10(&filename);
  if ( v5 == -1 )
  {
    __printf_chk(1, "!! 8021x.exe\n", v4, v4);
    result = 1;
  }
  else
  {
    v8 = v3;
    sub_804E3AD((const void *)v1, (int)&v10);
    __printf_chk(1, "** V2:\t%s\n", &v10, v8);
    v9 = sub_804F2DF(23, &v10, 0x20u);
    if ( v5 == -2 )
    {
      __printf_chk(1, "!! W32N55.dll\n", v9, v9);
      sub_804DE0D();
      result = 2;
    }
    else
    {
      sub_804DD86(v1, (int)&v10);
      __printf_chk(1, "** V3:\t%s\n", &v10, v5);
      sub_804F2DF(77, &v10, 0x80u);
      sub_804DE0D();
      result = 0;
    }
  }
  if ( *MK_FP(__GS__, 20) != v11 )
    __stack_chk_fail(v6, *MK_FP(__GS__, 20) ^ v11);
  return result;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804F996) --------------------------------------------------------
signed int __cdecl sub_804F996(int a1)
{
  signed int result; // eax@2

  if ( dword_805B4D0 > 1 )
  {
    if ( sub_804F3E1(1) != -1 )
    {
LABEL_6:
      result = sub_804F87B(a1);
      goto LABEL_7;
    }
    result = sub_804F996(a1);
  }
  else
  {
    result = sub_804F529();
    if ( dword_805B4D0 == 1 )
      goto LABEL_6;
  }
LABEL_7:
  dword_805B4DC = 4139;
  return result;
}
// 804F996: using guessed type _DWORD __cdecl sub_804F996(_DWORD);
// 805B4D0: using guessed type int dword_805B4D0;
// 805B4DC: using guessed type int dword_805B4DC;

//----- (0804F9EA) --------------------------------------------------------
_UNKNOWN *__cdecl sub_804F9EA(int a1)
{
  __sprintf_chk(&unk_805B664, 1, 16, "%d.%d.%d.%d", (unsigned __int8)a1, BYTE1(a1), BYTE2(a1), BYTE3(a1));
  return &unk_805B664;
}
// 8048F90: using guessed type int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0804FA1E) --------------------------------------------------------
signed int __usercall sub_804FA1E<eax>(int a1<edi>)
{
  int v1; // eax@1
  int v2; // ecx@1
  int v3; // ebx@1
  int v4; // edx@3
  __int16 v5; // ax@5
  int v6; // eax@9
  _UNKNOWN *v7; // eax@22
  _UNKNOWN *v8; // eax@22
  _UNKNOWN *v9; // eax@22
  size_t v10; // ecx@22
  size_t v11; // edi@22
  int v12; // ecx@28
  signed int result; // eax@28
  const char *v14; // [sp-8h] [bp-54h]@2
  char *v15; // [sp-4h] [bp-50h]@2
  int v16; // [sp+0h] [bp-4Ch]@2
  char v17; // [sp+10h] [bp-3Ch]@3
  int v18; // [sp+22h] [bp-2Ah]@4
  __int16 v19; // [sp+26h] [bp-26h]@4
  int v20; // [sp+30h] [bp-1Ch]@1

  v20 = *MK_FP(__GS__, 20);
  v1 = socket(2, 2, 0);
  v3 = v1;
  if ( v1 < 0 )
  {
    v16 = v1;
    v15 = (char *)v1;
    v14 = "!! !\n";
LABEL_28:
    __printf_chk(1, v14, v15, v16);
    result = -1;
    goto LABEL_31;
  }
  v16 = v2;
  __strcpy_chk(&v17, &dest, 16);
  if ( ioctl(v3, 0x8927u, &v17, v16) < 0 )
  {
    close(v3);
    v15 = &dest;
    v14 = "!! %sMAC!\n";
    goto LABEL_28;
  }
  dword_805BAD0 = v18;
  word_805BAD4 = v19;
  if ( !dword_805BA80 )
  {
    dword_805BAC8 = dword_80589C0;
    v5 = dword_80589C4;
LABEL_8:
    word_805BACC = v5;
    goto LABEL_9;
  }
  if ( dword_805BA80 == 1 )
  {
    dword_805BAC8 = dword_80589C8;
    v5 = dword_80589CC;
    goto LABEL_8;
  }
LABEL_9:
  LOBYTE(dword_805BAC0) = -2;
  v6 = ioctl(v3, 0x8915u, &v17, v4);
  if ( v6 >= 0 )
  {
    dword_805B4D4 = *(int *)((char *)&v18 + 2);
    if ( dword_805BA74 && (dword_805BA80 % 3u != 2 || BYTE3(dword_805BA74) != 2) )
      LOBYTE(dword_805BAC0) = -1;
  }
  else
  {
    __printf_chk(1, "!! %sIP!\n", &dest, v6);
  }
  if ( (dword_805BA84 || dword_805BA6C == -1) && (dword_805BA6C = dword_805B4D4, dword_805BA84) || dword_805BA70 == -1 )
  {
    if ( ioctl(v3, 0x891Bu, &v17, a1) >= 0 )
      dword_805BA70 = *(int *)((char *)&v18 + 2);
    else
      __printf_chk(1, "!! %s!\n", &dest, &v17);
  }
  close(v3);
  v7 = sub_804F81D((int)&dword_805BAD0, 6);
  __printf_chk(1, "** MAC:\t%s\n", v7);
  v8 = sub_804F9EA(dword_805BA6C);
  __printf_chk(1, "** IP:\t%s\n", v8);
  v9 = sub_804F9EA(dword_805BA70);
  __printf_chk(1, "** :\t%s\n", v9);
  v10 = dword_805B4CC;
  v11 = size;
  while ( v10 )
  {
    *(_BYTE *)v11++ = 0;
    --v10;
  }
  *(_BYTE *)(size + 2) = 19;
  *(_BYTE *)(size + 3) = 17;
  if ( dword_805BA84 )
    *(_BYTE *)(size + 4) = 1;
  *(_DWORD *)(size + 5) = dword_805BA6C;
  *(_DWORD *)(size + 9) = dword_805BA70;
  *(_DWORD *)(size + 13) = dword_805BA74;
  *(_DWORD *)(size + 17) = dword_805BA78;
  sub_804F12C(size);
  result = 0;
LABEL_31:
  if ( *MK_FP(__GS__, 20) != v20 )
    __stack_chk_fail(v12, *MK_FP(__GS__, 20) ^ v20);
  return result;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048EC0: using guessed type int __cdecl __strcpy_chk(_DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 80589C0: using guessed type int dword_80589C0;
// 80589C4: using guessed type int dword_80589C4;
// 80589C8: using guessed type int dword_80589C8;
// 80589CC: using guessed type int dword_80589CC;
// 805B4D4: using guessed type int dword_805B4D4;
// 805BA6C: using guessed type int dword_805BA6C;
// 805BA70: using guessed type int dword_805BA70;
// 805BA74: using guessed type int dword_805BA74;
// 805BA78: using guessed type int dword_805BA78;
// 805BA80: using guessed type int dword_805BA80;
// 805BA84: using guessed type int dword_805BA84;
// 805BAC0: using guessed type int dword_805BAC0;
// 805BAC8: using guessed type int dword_805BAC8;
// 805BACC: using guessed type __int16 word_805BACC;
// 805BAD4: using guessed type __int16 word_805BAD4;

//----- (0804FCA7) --------------------------------------------------------
char *__cdecl sub_804FCA7(char *inbuf, size_t inbytesleft)
{
  char *v2; // ebx@1
  size_t v3; // esi@1
  iconv_t v4; // edi@1
  size_t v5; // ST2C_4@2
  void *v6; // ST10_4@3
  char *outbuf; // [sp+20h] [bp-20h]@2
  size_t cd; // [sp+24h] [bp-1Ch]@1

  v2 = 0;
  v3 = (3 * inbytesleft >> 1) + 1;
  cd = (3 * inbytesleft >> 1) + 1;
  v4 = iconv_open("utf-8", "gbk");
  if ( v4 != (iconv_t)-1 )
  {
    outbuf = (char *)malloc(v3);
    v2 = outbuf;
    v5 = iconv(v4, &inbuf, &inbytesleft, &outbuf, &cd);
    iconv_close(v4);
    if ( v5 == -1 )
    {
      v6 = v2;
      v2 = 0;
      free(v6);
    }
    else
    {
      v2[v3 - cd] = 0;
    }
  }
  return v2;
}

//----- (0804FD31) --------------------------------------------------------
int __cdecl sub_804FD31(const char *filename)
{
  int v1; // edx@1
  int v2; // edx@2
  int v3; // ecx@2
  signed int v4; // ecx@3
  int *v5; // edi@3
  char v6; // zf@5
  char *v7; // eax@6
  void *v8; // ebx@6
  int result; // eax@8
  int inbuf; // [sp+10h] [bp-80Ch]@1
  int v11; // [sp+810h] [bp-Ch]@1

  v11 = *MK_FP(__GS__, 20);
  if ( sub_804EAD1(filename, (unsigned int)&inbuf, 2048) )
  {
    __printf_chk(1, "!! SuConfig.dat\n", v1, v1);
  }
  else
  {
    v4 = -1;
    v5 = &inbuf;
    do
    {
      if ( !v4 )
        break;
      v6 = *(_BYTE *)v5 == 0;
      v5 = (int *)((char *)v5 + 1);
      --v4;
    }
    while ( !v6 );
    v7 = sub_804FCA7((char *)&inbuf, ~v3 - 1);
    v8 = v7;
    if ( v7 )
    {
      __printf_chk(1, "%s\n", v7, v5);
      free(v8);
    }
  }
  result = *MK_FP(__GS__, 20) ^ v11;
  if ( *MK_FP(__GS__, 20) != v11 )
    __stack_chk_fail(v3, v2);
  return result;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);

//----- (0804FDC1) --------------------------------------------------------
signed int __fastcall sub_804FDC1(int a1)
{
  signed int v1; // edx@1
  int v2; // eax@2
  int v3; // esi@2
  int v4; // edi@3
  int v5; // eax@5
  signed int result; // eax@14
  struct pollfd fds; // [sp+4h] [bp-74h]@3
  char buf; // [sp+Ch] [bp-6Ch]@1
  struct sockaddr addr; // [sp+4Ch] [bp-2Ch]@2
  int v10; // [sp+5Ch] [bp-1Ch]@1

  v1 = 0;
  v10 = *MK_FP(__GS__, 20);
  memcpy(&buf, &unk_80589D0, 0x40u);
  if ( dword_805BA7C )
  {
    LOBYTE(a1) = 4;
    memset(&addr, 0, 4 * a1);
    addr.sa_family = 2;
    *(_DWORD *)&addr.sa_data[2] = dword_805BA7C;
    v2 = socket(2, 3, 1);
    v3 = v2;
    if ( v2 >= 0 )
    {
      fds.fd = v2;
      v4 = 1000;
      fds.events = 1;
      while ( sendto(v3, &buf, 0x40u, 0, &addr, 0x10u) >= 0 )
      {
        v5 = poll(&fds, 1u, v4);
        if ( v5 == -1 )
          break;
        if ( v5 > 0 )
        {
          close(v3);
          v1 = 0;
          goto LABEL_14;
        }
        v4 += 1000;
        if ( v4 == 4000 )
        {
          close(v3);
          v1 = -1;
          goto LABEL_14;
        }
      }
    }
    perror("!! Ping");
    if ( v3 != -1 )
      close(v3);
    dword_805BA7C = 0;
    v1 = 0;
  }
LABEL_14:
  result = v1;
  if ( *MK_FP(__GS__, 20) != v10 )
    __stack_chk_fail(*MK_FP(__GS__, 20) ^ v10, v1);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 805BA7C: using guessed type int dword_805BA7C;

//----- (0804FED8) --------------------------------------------------------
int __usercall sub_804FED8<eax>(__time_t a1<eax>)
{
  struct itimerval new; // [sp+4h] [bp-18h]@1

  new.it_value.tv_sec = a1;
  new.it_interval.tv_sec = a1;
  new.it_value.tv_usec = 0;
  new.it_interval.tv_usec = 0;
  return setitimer(0, &new, 0);
}

//----- (0804FF04) --------------------------------------------------------
int __cdecl sub_804FF04()
{
  if ( (unsigned int)dword_805BA80 > 2 )
    dword_805BA80 -= 3;
  dword_805B678 = 1;
  dword_805B680 = -1;
  sub_804FED8(dword_805B448);
  return 0;
}
// 805B448: using guessed type int dword_805B448;
// 805B678: using guessed type int dword_805B678;
// 805B680: using guessed type int dword_805B680;
// 805BA80: using guessed type int dword_805BA80;

//----- (0804FF3E) --------------------------------------------------------
__int16 __usercall sub_804FF3E<ax>(unsigned int a1<eax>)
{
  __int16 result; // ax@1

  memset(&dword_805B684, 0, 0x3E8u);
  dword_805B690 = _byteswap_ulong(a1);
  dword_805B684 = dword_805BAC8;
  word_805B688 = word_805BACC;
  dword_805B68A = dword_805BAD0;
  result = word_805BAD4;
  word_805B68E = word_805BAD4;
  return result;
}
// 805B684: using guessed type int dword_805B684;
// 805B688: using guessed type __int16 word_805B688;
// 805B68A: using guessed type int dword_805B68A;
// 805B68E: using guessed type __int16 word_805B68E;
// 805B690: using guessed type int dword_805B690;
// 805BAC8: using guessed type int dword_805BAC8;
// 805BACC: using guessed type __int16 word_805BACC;
// 805BAD0: using guessed type int dword_805BAD0;
// 805BAD4: using guessed type __int16 word_805BAD4;

//----- (0804FF8D) --------------------------------------------------------
int __usercall sub_804FF8D<eax>(int a1<ecx>, int a2<edi>, signed int a3)
{
  signed int v3; // eax@1
  int v4; // edx@2
  int v5; // esi@5
  int result; // eax@17
  unsigned int v8; // eax@25
  char *v9; // edi@27
  signed int v10; // ecx@27
  signed int v11; // ecx@33
  char v12; // zf@35
  int v13; // ebx@36
  __int16 v14; // ax@38
  int v15; // ebx@39
  char *v16; // edi@41
  signed int v17; // ecx@41
  signed int v18; // ebx@44
  __int16 v19; // ax@44
  void *v20; // eax@44
  signed int v21; // ecx@45
  int v22; // ebx@48
  unsigned int v23; // edx@48
  __int16 v24; // ax@50
  __int16 v25; // ax@54
  char v26; // dl@54
  size_t v27; // ecx@55
  int v28; // esi@61
  signed int v29; // ecx@69
  int *v30; // edi@69
  signed int v31; // ecx@73
  int v32; // edi@74
  signed int v33; // ecx@81
  char *v34; // edi@82
  signed int v35; // [sp-10h] [bp-78h]@22
  const char *v36; // [sp-Ch] [bp-74h]@10
  int v37; // [sp-8h] [bp-70h]@10
  signed int v38; // [sp-8h] [bp-70h]@52
  int v39; // [sp-4h] [bp-6Ch]@0
  int v40; // [sp-4h] [bp-6Ch]@10
  signed int v41; // [sp+Ch] [bp-5Ch]@48
  int v42; // [sp+10h] [bp-58h]@67
  __int16 v43; // [sp+14h] [bp-54h]@68
  int v44; // [sp+16h] [bp-52h]@68
  __int16 v45; // [sp+1Ah] [bp-4Eh]@68
  char v46; // [sp+1Ch] [bp-4Ch]@67
  char v47; // [sp+1Dh] [bp-4Bh]@67
  char v48; // [sp+1Fh] [bp-49h]@67
  char v49; // [sp+20h] [bp-48h]@67
  char v50; // [sp+22h] [bp-46h]@67
  char v51; // [sp+23h] [bp-45h]@67
  char v52; // [sp+25h] [bp-43h]@68
  int v53; // [sp+26h] [bp-42h]@68
  __int16 v54; // [sp+2Ah] [bp-3Eh]@68
  int v55; // [sp+2Ch] [bp-3Ch]@68
  int v56; // [sp+30h] [bp-38h]@68
  __int16 v57; // [sp+34h] [bp-34h]@68
  int v58; // [sp+36h] [bp-32h]@68
  int v59; // [sp+4Ch] [bp-1Ch]@1

  v3 = a3;
  v59 = *MK_FP(__GS__, 20);
  while ( 2 )
  {
    while ( 1 )
    {
      v4 = dword_805B678;
      if ( dword_805B678 == v3 )
      {
        ++dword_805B680;
      }
      else
      {
        dword_805B678 = v3;
        dword_805B680 = 0;
      }
      v5 = dword_805B680;
      if ( v3 == 4 )
        break;
      if ( dword_805B680 <= 2 )
        break;
      if ( v3 == 2 )
      {
        v40 = v4;
        v37 = v4;
        v36 = ">> !\n";
        goto LABEL_15;
      }
      if ( v3 <= 2 )
      {
        if ( v3 != 1 )
        {
LABEL_17:
          result = sub_804FF04();
          goto LABEL_92;
        }
        v40 = a1;
        v37 = a1;
        v36 = ">> !\n";
LABEL_15:
        __printf_chk(1, v36, v37, v40);
        goto LABEL_17;
      }
      if ( v3 == 3 )
      {
        v40 = 3;
        v37 = 3;
        v36 = ">> !\n";
        goto LABEL_15;
      }
      if ( v3 != 6 )
        goto LABEL_17;
      __printf_chk(1, ">> !\n", a2, a2);
      v3 = 4;
    }
    switch ( v3 )
    {
      case 5:
        sub_804FED8(0);
        __printf_chk(1, ">> IP...\n", v5, v5);
        system(&command);
        __printf_chk(1, ">> \n");
        dword_805BA84 += 3;
        if ( sub_804FA1E(a2) == -1 )
          exit(1);
        if ( dword_805BA84 == 5 )
          v35 = 4;
        else
          v35 = 1;
        result = sub_804FF8D(a1, a2, v35);
        goto LABEL_92;
      case 1:
        v8 = dword_805BA80 / 3u;
        if ( dword_805BA80 % 3u == 2 )
        {
          if ( !dword_805B680 )
          {
            __printf_chk(1, ">> ...\n", dword_805BA80 % 3u, dword_805BA80 % 3u);
            v9 = &byte_805B696;
            v10 = 42;
            dword_805B690 = 16879240;
            word_805B694 = 0;
            dword_805B684 = dword_80589C0;
            word_805B688 = dword_80589C4;
            dword_805B68A = dword_805BAD0;
            word_805B68E = word_805BAD4;
            while ( v10 )
            {
              *v9++ = -91;
              --v10;
            }
            v8 = sub_804FED8(dword_805B440);
          }
          goto LABEL_85;
        }
        if ( dword_805B680 )
          goto LABEL_57;
        __printf_chk(1, ">> ...\n", v8, v8);
        sub_804F529();
        sub_804FF3E(0x888E0101u);
        __memcpy_chk(&byte_805B696, size, dword_805B4CC, 982);
        goto LABEL_56;
      case 2:
        v11 = -1;
        a2 = (int)&byte_805B1A8;
        do
        {
          if ( !v11 )
            break;
          v12 = *(_BYTE *)a2++ == 0;
          --v11;
        }
        while ( !v12 );
        v13 = ~v11 - 1;
        if ( dword_805BA80 % 3u == 2 )
        {
          if ( !dword_805B680 )
          {
            __printf_chk(1, ">> ...\n", a2, a2);
            v14 = __ROR__(v13 + 30, 8);
            HIWORD(dword_805B690) = 1;
            word_805B698 = v14;
            word_805B694 = v14;
            byte_805B696 = 2;
            byte_805B69A[0] = 1;
            byte_805B69B = 1;
            sub_804F2B5((int)&dword_805B684);
            dword_805B6AC = 808334128;
            dword_805B6B0 = 892350002;
            __memcpy_chk(&unk_805B6B4, &byte_805B1A8, v13, 952);
            sub_804FED8(dword_805B440);
          }
          v15 = v13 + 48;
          v39 = v5;
          byte_805B697 = *(_BYTE *)(dword_805B67C + 19);
          goto LABEL_52;
        }
        if ( dword_805B680 )
          goto LABEL_57;
        v16 = &byte_805B1A8;
        __printf_chk(1, ">> ...\n", v13, v13);
        sub_804FF3E(0x888E0100u);
        v17 = -1;
        do
        {
          if ( !v17 )
            break;
          v12 = *v16++ == 0;
          --v17;
        }
        while ( !v12 );
        byte_805B696 = 2;
        v18 = ~v17;
        v19 = __ROR__(~(_WORD)v17 - 1 + 5, 8);
        word_805B694 = v19;
        word_805B698 = v19;
        byte_805B697 = *(_BYTE *)(dword_805B67C + 19);
        byte_805B69A[0] = 1;
        __memcpy_chk(&byte_805B69B, &byte_805B1A8, ~v17 - 1, 977);
        v20 = &byte_805B69A[v18];
        goto LABEL_55;
      case 3:
        v21 = -1;
        a2 = (int)&byte_805B1A8;
        do
        {
          if ( !v21 )
            break;
          v12 = *(_BYTE *)a2++ == 0;
          --v21;
        }
        while ( !v12 );
        v41 = ~v21;
        v22 = ~v21 - 1;
        v23 = dword_805BA80 % 3u;
        if ( dword_805BA80 % 3u == 2 )
        {
          if ( !dword_805B680 )
          {
            __printf_chk(1, ">> ...\n", 3, 3);
            v24 = __ROR__(v22 + 22, 8);
            word_805B698 = v24;
            word_805B694 = v24;
            HIWORD(dword_805B690) = 1;
            byte_805B696 = 2;
            LOBYTE(v23) = *(_BYTE *)(dword_805B67C + 19);
            byte_805B69A[0] = 4;
            byte_805B69B = 16;
            byte_805B697 = v23;
            memcpy(
              &unk_805B69C,
              sub_804F337(
                *(_BYTE *)(dword_805B67C + 19),
                (const void *)(dword_805B67C + 24),
                *(_BYTE *)(dword_805B67C + 23)),
              0x10u);
            __memcpy_chk(&dword_805B6AC, &byte_805B1A8, v22, 960);
            sub_804FED8(dword_805B440);
          }
          v15 = v22 + 40;
          v39 = v23;
LABEL_52:
          v38 = v15;
          goto LABEL_87;
        }
        if ( !dword_805B680 )
        {
          __printf_chk(1, ">> ...\n", dword_805BA80 / 3u, dword_805BA80 / 3u);
          sub_804F996(dword_805B67C + 24);
          sub_804FF3E(0x888E0100u);
          v25 = __ROR__(v22 + 22, 8);
          word_805B694 = v25;
          word_805B698 = v25;
          byte_805B696 = 2;
          v26 = *(_BYTE *)(dword_805B67C + 19);
          byte_805B69A[0] = 4;
          byte_805B69B = 16;
          byte_805B697 = v26;
          memcpy(
            &unk_805B69C,
            sub_804F337(
              *(_BYTE *)(dword_805B67C + 19),
              (const void *)(dword_805B67C + 24),
              *(_BYTE *)(dword_805B67C + 23)),
            0x10u);
          __memcpy_chk(&dword_805B6AC, &byte_805B1A8, v22, 960);
          v20 = (char *)&unk_805B6AB + v41;
LABEL_55:
          v27 = dword_805B4CC;
          memcpy(v20, (const void *)size, dword_805B4CC);
          a2 = (int)((char *)v20 + v27);
LABEL_56:
          sub_804FED8(dword_805B440);
        }
LABEL_57:
        v39 = a2;
        goto LABEL_90;
      case 6:
        if ( !dword_805B680 )
          sub_804FED8(dword_805B444);
        goto LABEL_91;
      case 4:
        if ( !dword_805BA7C
          || (v28 = dword_805B444 * dword_805B680, (unsigned int)(dword_805B444 * dword_805B680) <= 0x3C) )
          goto LABEL_66;
        if ( sub_804FDC1(a1) == -1 )
        {
          __printf_chk(1, ">> !\n", v28, v28);
          v3 = 1;
          continue;
        }
        dword_805B680 = 1;
LABEL_66:
        if ( (_BYTE)dword_805BAC0 != -2 )
        {
          memset(&v42, 0, 0x3Cu);
          v46 = 8;
          v47 = 6;
          v48 = 1;
          v49 = 8;
          v50 = 6;
          v51 = 4;
          if ( (_BYTE)dword_805BAC0 != -1 )
          {
            v44 = dword_805BAD0;
            v53 = dword_805BAD0;
            v43 = word_805BAC4;
            v45 = word_805BAD4;
            v54 = word_805BAD4;
            v57 = word_805BAC4;
            v42 = dword_805BAC0;
            v52 = 2;
            v55 = dword_805B4D4;
            v56 = dword_805BAC0;
            v58 = dword_805BA74;
            dword_805BA94(status, &v42, 60, dword_805BAD0);
          }
          v29 = 6;
          v42 = -1;
          v43 = -1;
          v45 = word_805BAD4;
          v54 = word_805BAD4;
          v44 = dword_805BAD0;
          v53 = dword_805BAD0;
          v30 = &v56;
          v55 = dword_805B4D4;
          while ( v29 )
          {
            *(_BYTE *)v30 = 0;
            v30 = (int *)((char *)v30 + 1);
            --v29;
          }
          v52 = 1;
          v58 = dword_805BA74;
          dword_805BA94(status, &v42, 42, 0);
        }
        v31 = 3;
        if ( dword_805BA80 % 3u == 2 )
        {
          v32 = (int)&byte_805B696;
          LOBYTE(v31) = 42;
          HIWORD(dword_805B690) = 1537;
          word_805B694 = 0;
          while ( v31 )
          {
            *(_BYTE *)v32++ = -91;
            --v31;
          }
          sub_804FF8D(0, v32, 6);
LABEL_86:
          v38 = 60;
        }
        else
        {
          if ( !dword_805B680 )
          {
            memcpy(&v42, &unk_8058FA8, 0x1Du);
            __printf_chk(1, ">> ...\n", dword_805BA80 % 3u, dword_805BA80 % 3u);
            sub_804FF3E(0x888E01BFu);
            memcpy(&word_805B694, &v42, 0x1Du);
            sub_804FED8(dword_805B444);
          }
          sub_804F21C((int)&dword_805B684);
          v38 = 45;
        }
LABEL_87:
        result = dword_805BA94(status, &dword_805B684, v38, v39);
LABEL_92:
        if ( *MK_FP(__GS__, 20) != v59 )
          __stack_chk_fail(a1, *MK_FP(__GS__, 20) ^ v59);
        return result;
      case 0:
        sub_804FED8(0);
        v33 = 3;
        v8 = dword_805BA80 / 3u;
        if ( dword_805BA80 % 3u == 2 )
        {
          LOBYTE(v33) = 42;
          LOBYTE(v8) = -91;
          v34 = &byte_805B696;
          HIWORD(dword_805B690) = 513;
          word_805B694 = 0;
          while ( v33 )
          {
            *v34++ = -91;
            --v33;
          }
LABEL_85:
          v39 = v8;
          goto LABEL_86;
        }
        sub_804F529();
        sub_804FF3E(0x888E0102u);
        __memcpy_chk(&byte_805B696, size, dword_805B4CC, 982);
LABEL_90:
        v38 = 1000;
        goto LABEL_87;
      default:
LABEL_91:
        result = 0;
        goto LABEL_92;
    }
  }
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048DA0: using guessed type int __cdecl __memcpy_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 804F996: using guessed type _DWORD __cdecl sub_804F996(_DWORD);
// 80589C0: using guessed type int dword_80589C0;
// 80589C4: using guessed type int dword_80589C4;
// 805B440: using guessed type int dword_805B440;
// 805B444: using guessed type int dword_805B444;
// 805B4D4: using guessed type int dword_805B4D4;
// 805B678: using guessed type int dword_805B678;
// 805B67C: using guessed type int dword_805B67C;
// 805B680: using guessed type int dword_805B680;
// 805B684: using guessed type int dword_805B684;
// 805B688: using guessed type __int16 word_805B688;
// 805B68A: using guessed type int dword_805B68A;
// 805B68E: using guessed type __int16 word_805B68E;
// 805B690: using guessed type int dword_805B690;
// 805B694: using guessed type __int16 word_805B694;
// 805B696: using guessed type char byte_805B696;
// 805B697: using guessed type char byte_805B697;
// 805B698: using guessed type __int16 word_805B698;
// 805B69B: using guessed type char byte_805B69B;
// 805B6AC: using guessed type int dword_805B6AC;
// 805B6B0: using guessed type int dword_805B6B0;
// 805BA74: using guessed type int dword_805BA74;
// 805BA7C: using guessed type int dword_805BA7C;
// 805BA80: using guessed type int dword_805BA80;
// 805BA84: using guessed type int dword_805BA84;
// 805BA94: using guessed type int (__cdecl *dword_805BA94)(_DWORD, _DWORD, _DWORD, _DWORD);
// 805BAC0: using guessed type int dword_805BAC0;
// 805BAC4: using guessed type __int16 word_805BAC4;
// 805BAD4: using guessed type __int16 word_805BAD4;

//----- (08050700) --------------------------------------------------------
#error "80507EE: positive sp value has been found (funcsize=76)"

//----- (080507EF) --------------------------------------------------------
signed int __cdecl sub_80507EF()
{
  int v0; // eax@1
  const char *v1; // edx@1
  int v2; // ecx@1
  int v3; // esi@2
  int v4; // edi@4
  int v5; // ebx@4
  int v6; // ecx@11
  signed int result; // eax@11
  int v8; // edx@17
  signed int i; // eax@17
  const char *v10; // ST04_4@20
  int v11; // ST00_4@20
  const char *v12; // [sp-4h] [bp-144h]@3
  int *v13; // [sp+0h] [bp-140h]@0
  int v14; // [sp+4h] [bp-13Ch]@0
  const char *v15; // [sp+14h] [bp-12Ch]@6
  int v16; // [sp+1Ch] [bp-124h]@7
  int v17; // [sp+20h] [bp-120h]@1
  int v18; // [sp+24h] [bp-11Ch]@1
  int v19; // [sp+124h] [bp-1Ch]@1

  v19 = *MK_FP(__GS__, 20);
  v0 = dword_805BA90(&v17, &v18) + 1;
  if ( !v0 || (v3 = v17) == 0 )
  {
    v14 = (int)v1;
    v13 = &v18;
    v12 = "!! : %s\n";
LABEL_11:
    __printf_chk(1, v12, v13, v14);
    result = -1;
    goto LABEL_21;
  }
  v4 = 0;
  v5 = 0;
  do
  {
    ++v5;
    if ( !(*(_BYTE *)(v3 + 16) & 1) )
    {
      v14 = v0;
      v13 = (int *)v0;
      v15 = *(const char **)(v3 + 4);
      v0 = strcmp(v15, "any");
      v1 = v15;
      if ( v0 )
      {
        ++v4;
        v0 = __printf_chk(1, "** [%d]:\t%s\n", v5, v15);
        v16 = v5;
      }
    }
    v3 = *(_DWORD *)v3;
  }
  while ( v3 );
  if ( !v4 )
  {
    dword_805BAA8(v2, v1);
    v12 = "!! \n";
    goto LABEL_11;
  }
  if ( v4 != 1 )
  {
    __printf_chk(1, "?? [1-%d]: ", v5, v0);
    __isoc99_scanf("%d", &v16);
    if ( v16 > 0 )
    {
      if ( v16 > v5 )
        v16 = v5;
    }
    else
    {
      v16 = 1;
    }
  }
  __printf_chk(1, "** [%d]\n", v16, v5);
  v8 = v17;
  for ( i = v16; i > 1; --i )
    v8 = *(_DWORD *)v8;
  v10 = *(const char **)(v8 + 4);
  v16 = i;
  strncpy(&dest, v10, 0xFu);
  dword_805BAA8(v6, v11);
  result = 0;
LABEL_21:
  if ( *MK_FP(__GS__, 20) != v19 )
    __stack_chk_fail(v6, *MK_FP(__GS__, 20) ^ v19);
  return result;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 8048F50: using guessed type int __isoc99_scanf(const char *, ...);
// 805BA90: using guessed type int (__cdecl *dword_805BA90)(_DWORD, _DWORD);
// 805BAA8: using guessed type int (__fastcall *dword_805BAA8)(_DWORD, _DWORD);

//----- (08050962) --------------------------------------------------------
signed int __usercall sub_8050962<eax>(int a1<eax>)
{
  int v1; // edx@1
  unsigned int v2; // kr04_4@1
  signed int result; // eax@1
  int v4; // ecx@1
  int v5; // edi@1
  int i; // esi@2
  int v7; // esi@6
  signed int v8; // eax@6
  unsigned __int8 v9; // bl@12
  char *v10; // [sp+Ch] [bp-7Ch]@5
  unsigned __int8 v11; // [sp+10h] [bp-78h]@12
  unsigned __int8 v12; // [sp+23h] [bp-65h]@8
  unsigned __int8 v13; // [sp+24h] [bp-64h]@12
  unsigned __int8 v14; // [sp+25h] [bp-63h]@13
  char v15[70]; // [sp+26h] [bp-62h]@3
  int v16; // [sp+6Ch] [bp-1Ch]@1

  v1 = a1;
  v16 = *MK_FP(__GS__, 20);
  v2 = strlen(&byte_805B1EC) + 1;
  result = -1;
  v4 = v2 - 1;
  v5 = v2 - 1;
  if ( v2 - 1 <= 0x49 )
  {
    for ( i = 0; i != v4; ++i )
      v15[i] = *(&byte_805B1EC + i) ^ byte_8059C24[i];
    v10 = v15;
    while ( v5 > 0 )
    {
      v7 = v5;
      v4 = 0;
      v8 = 0;
      do
      {
        if ( v7 <= 0 )
        {
          *(&v12 + v4) = 0;
        }
        else
        {
          ++v8;
          *(&v12 + v4) = v10[v4];
        }
        ++v4;
        --v7;
      }
      while ( v4 != 3 );
      v5 -= 3;
      if ( v8 )
      {
        v9 = v12;
        *(_BYTE *)v1 = byte_8059BE0[v12 >> 2];
        v11 = v13;
        v4 = (v13 >> 4) | 16 * (v9 & 3);
        *(_BYTE *)(v1 + 1) = byte_8059BE0[v4];
        LOBYTE(v4) = 61;
        if ( v8 != 1 )
        {
          v4 = (v14 >> 6) | 4 * (v11 & 0xF);
          LOBYTE(v4) = byte_8059BE0[v4];
        }
        *(_BYTE *)(v1 + 2) = v4;
        LOBYTE(v4) = 61;
        if ( v8 > 2 )
          LOBYTE(v4) = byte_8059BE0[v14 & 0x3F];
        *(_BYTE *)(v1 + 3) = v4;
        v1 += 4;
      }
      v10 += 3;
    }
    *(_BYTE *)v1 = 0;
    result = 0;
  }
  if ( *MK_FP(__GS__, 20) != v16 )
    __stack_chk_fail(v4, *MK_FP(__GS__, 20) ^ v16);
  return result;
}
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 8050962: using guessed type char var_62[70];

//----- (08050A90) --------------------------------------------------------
void __usercall sub_8050A90(char *a1<edi>, char a2, int a3)
{
  signed int v3; // eax@2
  signed int v4; // ecx@4
  unsigned int v5; // eax@4
  int v6; // esi@4
  unsigned int v7; // edx@4
  int v8; // ebx@6
  unsigned int v9; // edi@6
  char v10; // al@11
  signed int v11; // edx@23
  char *v12; // ST14_4@33
  signed int v13; // ebx@33
  signed int v14; // esi@34
  char *v15; // ebx@35
  char v16; // dl@37
  signed int v17; // ecx@48
  char v18; // zf@50
  signed int v19; // ecx@54
  char *v20; // ebx@71
  signed int v21; // ecx@71
  char *v22; // ST10_4@116
  char *v23; // ST14_4@116
  int v24; // eax@117
  int v25; // edx@119
  int v26; // ecx@119
  int v27; // ecx@135
  char **v28; // esi@144
  _UNKNOWN *v29; // eax@145
  _UNKNOWN *v30; // eax@147
  _UNKNOWN *v31; // eax@149
  int v32; // ecx@150
  int v33; // ST1C_4@152
  int v34; // edx@152
  int v35; // edx@159
  int v36; // ecx@159
  int v37; // edx@168
  const char *v38; // eax@171
  const char *v39; // eax@171
  const char *v40; // eax@171
  const char *v41; // eax@171
  const char *v42; // eax@171
  int v43; // [sp-10h] [bp-F8h]@43
  char *v44; // [sp-10h] [bp-F8h]@59
  const char *v45; // [sp-10h] [bp-F8h]@118
  const char *v46; // [sp-Ch] [bp-F4h]@59
  int v47; // [sp-Ch] [bp-F4h]@109
  const char *v48; // [sp-Ch] [bp-F4h]@172
  size_t v49; // [sp-8h] [bp-F0h]@59
  int v50; // [sp-8h] [bp-F0h]@109
  char *v51; // [sp-4h] [bp-ECh]@169
  char v52; // [sp+8h] [bp-E0h]@39
  bool v53; // [sp+14h] [bp-D4h]@34
  signed int i; // [sp+18h] [bp-D0h]@34
  int v55; // [sp+1Ch] [bp-CCh]@2
  int v56; // [sp+1Ch] [bp-CCh]@6
  int v57[4]; // [sp+2Ch] [bp-BCh]@144
  __int16 v58; // [sp+3Ch] [bp-ACh]@119
  __int16 v59; // [sp+3Eh] [bp-AAh]@119
  int v60; // [sp+40h] [bp-A8h]@119
  int v61; // [sp+44h] [bp-A4h]@119
  __pid_t pid; // [sp+48h] [bp-A0h]@123
  int v63[3]; // [sp+4Ch] [bp-9Ch]@144
  int v64; // [sp+58h] [bp-90h]@30
  int v65; // [sp+5Ch] [bp-8Ch]@30
  void *stream; // [sp+60h] [bp-88h]@1
  char src; // [sp+65h] [bp-83h]@3
  char v68[86]; // [sp+66h] [bp-82h]@21
  char dest; // [sp+BCh] [bp-2Ch]@29
  int v70; // [sp+CCh] [bp-1Ch]@1

  v70 = *MK_FP(__GS__, 20);
  __printf_chk(
    1,
    "\nMentoHUST\t: %s\nCopyright (C) 2009-2010 HustMoon Studio\n\nBug report to %s\n\n",
    "0.3.4",
    "http://code.google.com/p/mentohust/issues/list");
  if ( sub_804963D(&stream, off_8059BDC) >= 0 )
  {
    sub_804955C((int)stream, "MentoHUST", "Username", "", &byte_805B1A8, 0x41u);
    sub_804955C((int)stream, "MentoHUST", "Password", "", &src, 0x57u);
    if ( src == 32 )
    {
      v4 = 0;
      v5 = 0;
      v6 = 0;
      v7 = 0;
      while ( 1 )
      {
        LOBYTE(v56) = v68[v6];
        if ( !v68[v6] )
          break;
        if ( (_BYTE)v56 == 61 )
        {
          ++v4;
          if ( v4 > 2 )
            goto LABEL_29;
        }
        else
        {
          v8 = 0;
          v56 = (char)v56;
          v9 = v5;
          while ( 1 )
          {
            v10 = byte_8059BE0[v8];
            if ( !v10 )
              break;
            if ( (unsigned __int8)v10 == v56 )
              break;
            ++v8;
          }
          v5 = v9;
          if ( v8 == 64 )
            goto LABEL_29;
          v7 += v8;
        }
        if ( (v6 & 3) == 3 )
        {
          *(&byte_805B1EC + v5++) = v7 >> 16;
          if ( v4 > 1 || (*(&byte_805B1EC + v5) = BYTE1(v7), ++v5, v4) )
            v4 = 0;
          else
            *(&byte_805B1EC + v5++) = v7;
          v7 = 0;
        }
        v7 <<= 6;
        ++v6;
      }
      if ( v5 <= 0x49 )
      {
        v11 = 0;
        if ( !(v6 & 3) )
        {
          while ( v11 < (signed int)v5 )
          {
            *(&byte_805B1EC + v11) ^= byte_8059C24[v11];
            ++v11;
          }
          *(&byte_805B1EC + v5) = 0;
        }
      }
    }
    else
    {
      strncpy(&byte_805B1EC, &src, 0x40u);
      sub_8050962((int)v68);
      src = 32;
      sub_804920F((int *)&stream, "MentoHUST", "Password", &src);
      sub_80490A4(stream, off_8059BDC);
    }
LABEL_29:
    sub_804955C((int)stream, "MentoHUST", "Nic", "", &::dest, 0x10u);
    sub_804955C((int)stream, "MentoHUST", "Datafile", "", &filename, 0xFFu);
    sub_804955C((int)stream, "MentoHUST", "DhcpScript", "", &command, 0xFFu);
    sub_804955C((int)stream, "MentoHUST", "Version", "", &dest, 0x10u);
    if ( strlen(&dest) > 2 && __isoc99_sscanf(&dest, "%u.%u", &v64, &v65) != -1 && v64 )
    {
      LOBYTE(word_805BABC) = v64;
      dword_805B4D0 = 1;
      HIBYTE(word_805BABC) = v65;
    }
    sub_804955C((int)stream, "MentoHUST", "IP", "255.255.255.255", &dest, 0x10u);
    dword_805BA6C = inet_addr(&dest);
    sub_804955C((int)stream, "MentoHUST", "Mask", "255.255.255.255", &dest, 0x10u);
    dword_805BA70 = inet_addr(&dest);
    sub_804955C((int)stream, "MentoHUST", "Gateway", "0.0.0.0", &dest, 0x10u);
    dword_805BA74 = inet_addr(&dest);
    sub_804955C((int)stream, "MentoHUST", "DNS", "0.0.0.0", &dest, 0x10u);
    a1 = v12;
    dword_805BA78 = inet_addr(&dest);
    sub_804955C((int)stream, "MentoHUST", "PingHost", "0.0.0.0", &dest, 0x10u);
    v13 = 100;
    dword_805BA7C = inet_addr(&dest);
    dword_805B440 = sub_80495D3((int)stream, "MentoHUST", "Timeout", 8) % 100;
    dword_805B444 = sub_80495D3((int)stream, "MentoHUST", "EchoInterval", 30) % 1000;
    LOBYTE(v13) = 4;
    dword_805B448 = sub_80495D3((int)stream, "MentoHUST", "RestartWait", 15) % 100;
    dword_805BA80 = sub_80495D3((int)stream, "MentoHUST", "StartMode", 0) % 3;
    dword_805BA84 = sub_80495D3((int)stream, "MentoHUST", "DhcpMode", 0) % v13;
    dword_805B1A4 = sub_80495D3((int)stream, "MentoHUST", "ShowNotify", 5) % 21;
    v55 = sub_80495D3((int)stream, "MentoHUST", "DaemonMode", 0) % v13;
    dword_805B44C = sub_80495D3((int)stream, "MentoHUST", "MaxFail", 8);
    free(stream);
    v3 = 0;
  }
  else
  {
    v55 = 0;
    v3 = -1;
  }
  v14 = 0;
  v53 = v3 != 0;
  for ( i = 1; ; ++i )
  {
    v15 = (char *)a2;
    if ( i >= a2 )
      goto LABEL_107;
    a1 = (char *)i;
    v15 = *(char **)(a3 + 4 * i);
    if ( *v15 != 47 && *v15 != 45 )
      continue;
    v16 = v15[1];
    if ( v16 == 63 || v16 == 104 || (v52 = v15[1], !strcmp(v15, "--help")) )
    {
      __printf_chk(
        1,
        ":\t%s [-][]\n:\t-h \n\t-k -k() ()\n\t-w \n\t-u \n\t-p \n\t-n \n\t-i IP[IP]\n\t-m []\n\t-g [0.0.0.0]\n\t-s DNS[0.0.0.0]\n\t-o Ping[0.0.0.0]\n\t-t ()[8]\n\t-e ()[30]\n\t-r ()[15]\n\t-l [08]\n\t-a : 0() 1() 2() [0]\n\t-d DHCP: 0() 1() 2() 3() [0]\n\t-b : 0() 1() 2() 3() [0]\n\t-y : 0() 1~20() [5]\n\t-v [0.00xrgsu]\n\t-f []\n\t-c DHCP[dhclient]\n\t-q SuConfig.dat(-q/path/SuConfig.dat)\n,
        *(_DWORD *)a3,
        *(_DWORD *)a3);
LABEL_43:
      v43 = 0;
      goto LABEL_44;
    }
    if ( v52 == 113 )
    {
      sub_804FD31(v15 + 2);
      goto LABEL_43;
    }
    if ( v52 == 119 )
    {
      v53 = 1;
      continue;
    }
    if ( v52 == 107 )
      break;
    v19 = -1;
    a1 = v15;
    do
    {
      if ( !v19 )
        break;
      v18 = *a1++ == 0;
      --v19;
    }
    while ( !v18 );
    if ( (unsigned int)(~v19 - 1) > 2 )
    {
      if ( v52 == 117 )
      {
        v49 = 64;
        v46 = v15 + 2;
        v44 = &byte_805B1A8;
LABEL_62:
        strncpy(v44, v46, v49);
        continue;
      }
      if ( v52 == 112 )
      {
        v49 = 64;
        v46 = v15 + 2;
        v44 = &byte_805B1EC;
        goto LABEL_62;
      }
      if ( v52 == 110 )
      {
        v49 = 15;
        v46 = v15 + 2;
        v44 = &::dest;
        goto LABEL_62;
      }
      if ( v52 == 102 )
      {
        v49 = 254;
        v46 = v15 + 2;
        v44 = &filename;
        goto LABEL_62;
      }
      if ( v52 == 99 )
      {
        v49 = 254;
        v46 = v15 + 2;
        v44 = &command;
        goto LABEL_62;
      }
      switch ( v52 )
      {
        case 118:
          v20 = v15 + 2;
          v21 = -1;
          a1 = v20;
          do
          {
            if ( !v21 )
              break;
            v18 = *a1++ == 0;
            --v21;
          }
          while ( !v18 );
          if ( (unsigned int)(~v21 - 1) > 2 && __isoc99_sscanf(v20, "%u.%u", &v64, &v65) != -1 )
          {
            if ( v64 )
            {
              LOBYTE(word_805BABC) = v64;
              dword_805B4D0 = 1;
              HIBYTE(word_805BABC) = v65;
            }
            else
            {
              dword_805B4D0 = 0;
            }
          }
          break;
        case 105:
          dword_805BA6C = inet_addr(v15 + 2);
          break;
        case 109:
          dword_805BA70 = inet_addr(v15 + 2);
          break;
        case 103:
          dword_805BA74 = inet_addr(v15 + 2);
          break;
        case 115:
          dword_805BA78 = inet_addr(v15 + 2);
          break;
        case 111:
          dword_805BA7C = inet_addr(v15 + 2);
          break;
        case 116:
          dword_805B440 = atoi(v15 + 2) % 100;
          break;
        case 101:
          dword_805B444 = atoi(v15 + 2) % 1000;
          break;
        case 114:
          dword_805B448 = atoi(v15 + 2) % 100;
          break;
        case 97:
          dword_805BA80 = atoi(v15 + 2) % 3;
          break;
        case 100:
          dword_805BA84 = atoi(v15 + 2) % 4;
          break;
        case 121:
          dword_805B1A4 = atoi(v15 + 2) % 21;
          break;
        case 98:
          v55 = atoi(v15 + 2) % 4;
          break;
        case 108:
          dword_805B44C = atoi(v15 + 2);
          break;
      }
    }
LABEL_105:
    ;
  }
  v17 = -1;
  a1 = v15;
  do
  {
    if ( !v17 )
      break;
    v18 = *a1++ == 0;
    --v17;
  }
  while ( !v18 );
  if ( (unsigned int)(~v17 - 1) > 2 )
  {
    v14 = 2;
    goto LABEL_105;
  }
  v14 = 1;
LABEL_107:
  if ( sub_804EF0D() == -1 )
  {
    if ( dword_805B1A4 )
    {
      v50 = 1000 * dword_805B1A4;
      v47 = (int)"libpcap, ";
LABEL_162:
      if ( sub_804ECFC((int)"MentoHUST - ", v47, v50) < 0 )
        dword_805B1A4 = 0;
    }
    goto LABEL_164;
  }
  if ( !::dest )
  {
    v53 = 1;
    if ( sub_80507EF() == -1 )
    {
      if ( dword_805B1A4 )
      {
        v50 = 1000 * dword_805B1A4;
        v47 = (int)"";
        goto LABEL_162;
      }
LABEL_164:
      v43 = 1;
LABEL_44:
      exit(v43);
    }
  }
  if ( !byte_805B1A8 || !byte_805B1EC )
  {
    __printf_chk(1, "?? : ");
    __isoc99_scanf("%s", &byte_805B1A8, a1, a1);
    __printf_chk(1, "?? : ");
    __isoc99_scanf("%s", &byte_805B1EC);
    __printf_chk(1, "?? (0 1 2): ");
    a1 = v22;
    __isoc99_scanf("%u", &dword_805BA80);
    v15 = v23;
    dword_805BA80 %= 3u;
    __printf_chk(1, "?? DHCP(0 1 2 3): ");
    __isoc99_scanf("%u", &dword_805BA84);
    dword_805BA84 &= 3u;
    v53 = 1;
  }
  v24 = open(off_8059C70, 66, 420, a1);
  fd = v24;
  if ( v24 < 0 )
  {
    v45 = "!! ";
    goto LABEL_137;
  }
  v60 = 0;
  v59 = 0;
  v61 = 0;
  v58 = 1;
  if ( fcntl(v24, 5, &v58, v15) < 0 )
  {
    v45 = "!! ";
    goto LABEL_137;
  }
  if ( v14 )
  {
    if ( v58 == 2 )
    {
      __printf_chk(1, "!! MentoHUST\n", a1, a1);
    }
    else
    {
      __printf_chk(1, ">> MentoHUST(PID=%d).\n", pid, v26);
      if ( kill(pid, 2) == -1 )
        perror("!! ");
    }
    if ( v14 == 1 )
      goto LABEL_43;
  }
  else
  {
    if ( v58 != 2 )
    {
      __printf_chk(1, "!! MentoHUST(PID=%d)!\n");
      goto LABEL_164;
    }
  }
  if ( v55 )
  {
    __printf_chk(1, ">> -k\n", v25, v25);
    if ( daemon(0, (v55 + 1) % 2) )
    {
      perror("!! ");
    }
    else
    {
      if ( v55 == 3 )
      {
        v15 = off_8059C74;
        freopen(off_8059C74, "w", stdout);
        setvbuf(stdout, 0, 1, 0x2000u);
        freopen(v15, "a", stderr);
      }
    }
  }
  v58 = 1;
  pid = getpid();
  if ( fcntl(fd, 7, &v58, v27) < 0 )
  {
    v45 = "!! ";
LABEL_137:
    perror(v45);
    if ( dword_805B1A4 )
    {
      v50 = 1000 * dword_805B1A4;
      v47 = (int)"root";
      goto LABEL_162;
    }
    goto LABEL_164;
  }
  if ( dword_805BA80 % 3u == 2 && !dword_805BA74 )
  {
    dword_805BA74 = dword_805BA6C;
    BYTE3(dword_805BA74) = 2;
  }
  if ( !command )
    __strcpy_chk(&command, off_8059BD8[0], 255);
  sub_804F6B8();
  memcpy(v63, off_8059C88, sizeof(v63));
  memcpy(v57, off_8059C78, sizeof(v57));
  v28 = &off_8059C78[4];
  __printf_chk(1, "** :\t%s\n", &byte_805B1A8);
  __printf_chk(1, "** : \t%s\n", &::dest, &v58);
  if ( dword_805BA74 )
  {
    v29 = sub_804F9EA(dword_805BA74);
    __printf_chk(1, "** :\t%s\n", v29);
  }
  if ( dword_805BA78 )
  {
    v30 = sub_804F9EA(dword_805BA78);
    __printf_chk(1, "** DNS:\t%s\n", v30);
  }
  if ( dword_805BA7C )
  {
    v31 = sub_804F9EA(dword_805BA7C);
    __printf_chk(1, "** :\t%s\n", v31);
  }
  __printf_chk(1, "** :\t%u\n", dword_805B440);
  __printf_chk(1, "** :\t%u\n", dword_805B444);
  __printf_chk(1, "** :\t%u\n", dword_805B448, v28);
  if ( dword_805B44C )
    __printf_chk(1, "** :\t%u\n", dword_805B44C, v15);
  v33 = v32;
  __printf_chk(1, "** :\t%s\n", v63[dword_805BA80]);
  __printf_chk(1, "** DHCP:\t%s\n", v57[dword_805BA84], v33);
  if ( dword_805B1A4 )
    __printf_chk(1, "** :\t%d\n", dword_805B1A4, v34);
  if ( dword_805B4D0 > 1 )
    __printf_chk(1, "** :\t%s\n", &filename, &v58);
  if ( dword_805BA84 )
    __printf_chk(1, "** DHCP:\t%s\n", &command, v28);
  if ( sub_804FA1E((int)&v58) == -1 || sub_8050700() == -1 )
  {
    if ( dword_805B1A4 )
    {
      v50 = 1000 * dword_805B1A4;
      v47 = (int)"MAC";
      goto LABEL_162;
    }
    goto LABEL_164;
  }
  if ( v53 )
  {
    if ( sub_804963D(&stream, off_8059BDC) < 0 )
    {
      stream = malloc(1u);
      *(_BYTE *)stream = 0;
    }
    sub_804920F((int *)&stream, "MentoHUST", "DhcpScript", &command);
    sub_804920F((int *)&stream, "MentoHUST", "DataFile", &filename);
    if ( dword_805B4D0 )
    {
      __sprintf_chk(&dest, 1, 10, "%u.%u", (unsigned __int8)word_805BABC, HIBYTE(word_805BABC), v37, v37);
      v51 = &dest;
    }
    else
    {
      v51 = "0.00";
    }
    sub_804920F((int *)&stream, "MentoHUST", "Version", v51);
    sub_80494FC((int *)&stream, "MentoHUST", "ShowNotify", dword_805B1A4);
    sub_80494FC((int *)&stream, "MentoHUST", "DaemonMode", v55);
    sub_80494FC((int *)&stream, "MentoHUST", "DhcpMode", dword_805BA84);
    sub_80494FC((int *)&stream, "MentoHUST", "StartMode", dword_805BA80);
    sub_80494FC((int *)&stream, "MentoHUST", "MaxFail", dword_805B44C);
    sub_80494FC((int *)&stream, "MentoHUST", "RestartWait", dword_805B448);
    sub_80494FC((int *)&stream, "MentoHUST", "EchoInterval", dword_805B444);
    sub_80494FC((int *)&stream, "MentoHUST", "Timeout", dword_805B440);
    v38 = (const char *)sub_804F9EA(dword_805BA7C);
    sub_804920F((int *)&stream, "MentoHUST", "PingHost", v38);
    v39 = (const char *)sub_804F9EA(dword_805BA78);
    sub_804920F((int *)&stream, "MentoHUST", "DNS", v39);
    v40 = (const char *)sub_804F9EA(dword_805BA74);
    sub_804920F((int *)&stream, "MentoHUST", "Gateway", v40);
    v41 = (const char *)sub_804F9EA(dword_805BA70);
    sub_804920F((int *)&stream, "MentoHUST", "Mask", v41);
    v42 = (const char *)sub_804F9EA(dword_805BA6C);
    sub_804920F((int *)&stream, "MentoHUST", "IP", v42);
    sub_804920F((int *)&stream, "MentoHUST", "Nic", &::dest);
    sub_8050962((int)v68);
    src = 32;
    sub_804920F((int *)&stream, "MentoHUST", "Password", &src);
    sub_804920F((int *)&stream, "MentoHUST", "Username", &byte_805B1A8);
    if ( sub_80490A4(stream, off_8059BDC) )
      v48 = "!! %s\n";
    else
      v48 = "** %s.\n";
    __printf_chk(1, v48);
    free(stream);
  }
  if ( *MK_FP(__GS__, 20) != v70 )
    __stack_chk_fail(v36, v35);
}
// 8048D10: using guessed type int __isoc99_sscanf(_DWORD, const char *, ...);
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048EC0: using guessed type int __cdecl __strcpy_chk(_DWORD, _DWORD, _DWORD);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 8048F50: using guessed type int __isoc99_scanf(const char *, ...);
// 8048F90: using guessed type int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);
// 8050700: using guessed type int sub_8050700(void);
// 8059BD8: using guessed type char *off_8059BD8[2];
// 8059C78: using guessed type char *off_8059C78[7];
// 8059C88: using guessed type char *off_8059C88[3];
// 805B1A4: using guessed type int dword_805B1A4;
// 805B440: using guessed type int dword_805B440;
// 805B444: using guessed type int dword_805B444;
// 805B448: using guessed type int dword_805B448;
// 805B44C: using guessed type int dword_805B44C;
// 805B4D0: using guessed type int dword_805B4D0;
// 805BA6C: using guessed type int dword_805BA6C;
// 805BA70: using guessed type int dword_805BA70;
// 805BA74: using guessed type int dword_805BA74;
// 805BA78: using guessed type int dword_805BA78;
// 805BA7C: using guessed type int dword_805BA7C;
// 805BA80: using guessed type int dword_805BA80;
// 805BA84: using guessed type int dword_805BA84;
// 805BABC: using guessed type __int16 word_805BABC;
// 8050A90: using guessed type char var_82[86];
// 8050A90: using guessed type int var_9C[3];
// 8050A90: using guessed type int var_BC[4];

//----- (08051C26) --------------------------------------------------------
int __usercall sub_8051C26<eax>(int a1<ecx>, int a2<edi>, int a3)
{
  int result; // eax@2
  int v4; // [sp-10h] [bp-18h]@6

  if ( a3 != 14 )
  {
    dword_805BAAC(status);
    v4 = 0;
    goto LABEL_8;
  }
  result = sub_804FF8D(a1, a2, dword_805B678) + 1;
  if ( !result )
  {
    dword_805BAAC(status);
    __printf_chk(1, "!! , \n");
    if ( dword_805B1A4 )
    {
      if ( sub_804ECFC(
             (int)"MentoHUST - ",
             (int)", ",
             1000 * dword_805B1A4) < 0 )
        dword_805B1A4 = 0;
    }
    v4 = 1;
LABEL_8:
    exit(v4);
  }
  return result;
}
// 805BAAC: invalid function type has been ignored
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 805B1A4: using guessed type int dword_805B1A4;
// 805B678: using guessed type int dword_805B678;
// 805BAAC: using guessed type int (__cdecl *dword_805BAAC)(_DWORD);

//----- (08051CBB) --------------------------------------------------------
void __usercall sub_8051CBB(int a1<eax>, unsigned int a2<edx>)
{
  size_t v2; // esi@2
  const char *i; // ebx@2
  int v4; // eax@3
  int v5; // esi@5
  unsigned int v6; // kr04_4@7
  int v7; // eax@10
  int v8; // edx@11
  size_t v9; // edi@11
  int v10; // edx@12
  int v11; // edi@12
  void *v12; // eax@20
  const char *v13; // edx@20
  char *v14; // eax@24
  int v15; // ebx@24
  int src; // [sp+4h] [bp-24h]@20
  int inbytesleft; // [sp+8h] [bp-20h]@1
  size_t inbyteslefta; // [sp+8h] [bp-20h]@19
  int inbuf; // [sp+Ch] [bp-1Ch]@1
  char *inbufa; // [sp+Ch] [bp-1Ch]@20

  inbuf = a1;
  inbytesleft = *(_BYTE *)(a1 + 27);
  if ( *(_BYTE *)(a1 + 27) )
  {
    v4 = 0;
    for ( i = (const char *)(inbuf + 28); ; ++i )
    {
      v5 = inbytesleft - v4++;
      if ( *i != 10 )
      {
        if ( *i != 13 )
          break;
      }
    }
    v6 = strlen(i) + 1;
    if ( v6 - 1 < v5 )
      v5 = v6 - 1;
    v2 = i != 0 ? v5 : 0;
  }
  else
  {
    v2 = 0;
    i = 0;
  }
  v7 = inbytesleft + 172;
  if ( inbytesleft + 172 < a2 )
  {
    v10 = a2 - v7;
    v11 = *(_BYTE *)(inbuf + v7 - 1) - 2;
    if ( v11 > (unsigned int)v10 )
      v11 = v10;
    v8 = v7 + inbuf;
    while ( *(_BYTE *)v8 == 10 || *(_BYTE *)v8 == 13 )
    {
      ++v8;
      --v11;
    }
    v9 = v8 != 0 ? v11 : 0;
  }
  else
  {
    v8 = 0;
    v9 = 0;
  }
  inbyteslefta = v2 + v9;
  if ( v2 + v9 )
  {
    src = v8;
    v12 = malloc(v2 + v9);
    v13 = (const char *)src;
    inbufa = (char *)v12;
    if ( v2 )
    {
      strncpy((char *)v12, i, v2);
      v13 = (const char *)src;
    }
    if ( v9 )
    {
      v2 += (size_t)inbufa;
      strncpy((char *)v2, v13, v9);
    }
    v14 = sub_804FCA7(inbufa, inbyteslefta);
    v15 = (int)v14;
    if ( v14 )
    {
      if ( *v14 )
      {
        __printf_chk(1, "$$ :\t%s\n", v14, v2);
        if ( dword_805B1A4 )
        {
          if ( sub_804ECFC((int)"MentoHUST - ", v15, 1000 * dword_805B1A4) < 0 )
            dword_805B1A4 = 0;
        }
      }
      free((void *)v15);
    }
    free(inbufa);
  }
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 805B1A4: using guessed type int dword_805B1A4;

//----- (08051E1A) --------------------------------------------------------
int __fastcall sub_8051E1A(int a1, size_t a2, int a3, int a4, int a5)
{
  int v5; // eax@3
  int v6; // ST1C_4@9
  _UNKNOWN *v7; // eax@9
  unsigned int v8; // kr04_4@26
  unsigned __int16 v9; // dx@26
  char *v10; // eax@29
  int v11; // ebx@29
  int v12; // ST1C_4@55
  _UNKNOWN *v13; // eax@55
  _UNKNOWN *v14; // eax@55
  int v15; // ebx@58
  _UNKNOWN *v16; // eax@59
  _UNKNOWN *v17; // eax@60
  int result; // eax@62
  signed int v19; // [sp-10h] [bp-68h]@13
  char command; // [sp+Ah] [bp-4Eh]@55
  int v21; // [sp+3Ch] [bp-1Ch]@1

  v21 = *MK_FP(__GS__, 20);
  LOBYTE(a2) = *(_BYTE *)(a5 + 12);
  if ( (_BYTE)a2 != -120 || *(_BYTE *)(a5 + 13) != -114 )
  {
    if ( (_BYTE)dword_805BAC0 != -2 )
    {
      if ( (_BYTE)a2 == 8 )
      {
        if ( *(_BYTE *)(a5 + 13) == 6 )
        {
          a2 = *(_DWORD *)(a5 + 28);
          if ( a2 == dword_805BA74 )
          {
            if ( (_BYTE)dword_805BAC0 == -1 )
            {
              dword_805BAC0 = *(_DWORD *)(a5 + 22);
              v12 = a1;
              word_805BAC4 = *(_WORD *)(a5 + 26);
              v13 = sub_804F81D((int)&dword_805BAC0, 6);
              __printf_chk(1, "** MAC:\t%s\n", v13, v12);
              sub_804F81D((int)&dword_805BAC0, 6);
              v14 = sub_804F9EA(dword_805BA74);
              __sprintf_chk(&command, 1, 50, "arp -s %s %s", v14);
              system(&command);
            }
            else
            {
              if ( *(_BYTE *)(a5 + 21) == 2 )
              {
                if ( !memcmp(&dword_805B4D4, (const void *)(a5 + 38), 4u) )
                {
                  v15 = a5 + 22;
                  if ( memcmp(&dword_805BAC0, (const void *)(a5 + 22), 6u) )
                  {
                    v16 = sub_804F81D(v15, 6);
                    __printf_chk(1, "** ARP:\t%s\n", v16, a4);
                    if ( dword_805B1A4 )
                    {
                      v17 = sub_804F81D(v15, 6);
                      __sprintf_chk(&command, 1, 50, ": %s", v17);
                      if ( sub_804ECFC((int)"MentoHUST - ARP", (int)&command, 1000 * dword_805B1A4) < 0 )
                        dword_805B1A4 = 0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    goto LABEL_62;
  }
  v5 = memcmp(&dword_805BAC8, (const void *)(a5 + 6), 6u);
  if ( v5 && (unsigned int)dword_805BA80 > 2 )
    goto LABEL_62;
  dword_805B67C = a5;
  LOBYTE(v5) = *(_BYTE *)(a5 + 15);
  if ( (_BYTE)v5 )
  {
    if ( (_BYTE)v5 != 5 )
      goto LABEL_62;
    goto LABEL_35;
  }
  LOBYTE(a2) = *(_BYTE *)(a5 + 18);
  if ( (_BYTE)a2 != 1 )
  {
    if ( (_BYTE)a2 != 3 )
    {
      if ( (_BYTE)a2 != 4 )
        goto LABEL_62;
      if ( dword_805B678 != 6 && dword_805B678 != 4 )
      {
        if ( *(_BYTE *)(a5 + 27) || (a1 = 3, dword_805BA80 % 3u == 2) )
        {
          __printf_chk(1, ">> !\n", a5 + 6, a5 + 6);
          if ( dword_805BA80 % 3u != 2 )
            sub_8051CBB(a5, *(_DWORD *)(a4 + 8));
          if ( dword_805B44C )
          {
            ++dword_805BA8C;
            if ( dword_805BA8C >= (unsigned int)dword_805B44C )
            {
              __printf_chk(1, ">> %u\n", dword_805B44C, a5);
              exit(0);
            }
          }
          sub_804FF04();
          goto LABEL_62;
        }
      }
      else
      {
        __printf_chk(1, ">> !\n", a2, a2);
      }
      v19 = 1;
      goto LABEL_16;
    }
    __printf_chk(1, ">> !\n", v5, v5);
    a1 = 3;
    dword_805BA8C = 0;
    if ( dword_805BA80 % 3u != 2 )
    {
      sub_804F1C4(a5);
      sub_8051CBB(a5, *(_DWORD *)(a4 + 8));
    }
    if ( (unsigned int)(dword_805BA84 - 1) <= 1 )
    {
      v19 = 5;
      goto LABEL_16;
    }
    a1 = 3;
    if ( dword_805BA80 % 3u == 2 )
    {
      v19 = 6;
      goto LABEL_16;
    }
LABEL_35:
    v19 = 4;
    goto LABEL_16;
  }
  LOBYTE(a2) = *(_BYTE *)(a5 + 22);
  if ( (_BYTE)a2 == 1 )
  {
    if ( (unsigned int)dword_805BA80 <= 2 )
    {
      dword_805BAC8 = *(_DWORD *)(a5 + 6);
      v6 = a1;
      word_805BACC = *(_WORD *)(a5 + 10);
      v7 = sub_804F81D((int)&dword_805BAC8, 6);
      __printf_chk(1, "** MAC:\t%s\n", v7, v6);
      dword_805BA80 += 3;
    }
    if ( dword_805BA80 == 3 && !memcmp((const void *)(a5 + 23), "User name", 9u) )
      dword_805BA80 = 5;
    v19 = 2;
    goto LABEL_16;
  }
  if ( (_BYTE)a2 == 4 )
  {
    v19 = 3;
LABEL_16:
    sub_804FF8D(a1, a5 + 6, v19);
    goto LABEL_62;
  }
  if ( *(_BYTE *)(a5 + 22) == 2 )
  {
    v8 = strlen((const char *)(a5 + 23)) + 1;
    v9 = __ROR__(*(_WORD *)(a5 + 20), 8);
    a2 = v9 - 5;
    a1 = v8 - 1;
    if ( v8 - 1 < a2 )
      a2 = v8 - 1;
    if ( (signed int)a2 > 0 )
    {
      v10 = sub_804FCA7((char *)(a5 + 23), a2);
      v11 = (int)v10;
      if ( v10 )
      {
        __printf_chk(1, "$$ :\t%s\n", v10, a5 + 23);
        if ( dword_805B1A4 && sub_804ECFC((int)"MentoHUST - ", v11, 1000 * dword_805B1A4) < 0 )
          dword_805B1A4 = 0;
        free((void *)v11);
      }
    }
  }
LABEL_62:
  result = *MK_FP(__GS__, 20) ^ v21;
  if ( *MK_FP(__GS__, 20) != v21 )
    __stack_chk_fail(a1, (_WORD)a2);
  return result;
}
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 8048F10: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 8048F90: using guessed type int __sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);
// 805B1A4: using guessed type int dword_805B1A4;
// 805B44C: using guessed type int dword_805B44C;
// 805B4D4: using guessed type int dword_805B4D4;
// 805B678: using guessed type int dword_805B678;
// 805B67C: using guessed type int dword_805B67C;
// 805BA74: using guessed type int dword_805BA74;
// 805BA80: using guessed type int dword_805BA80;
// 805BA84: using guessed type int dword_805BA84;
// 805BA8C: using guessed type int dword_805BA8C;
// 805BAC0: using guessed type int dword_805BAC0;
// 805BAC4: using guessed type __int16 word_805BAC4;
// 805BAC8: using guessed type int dword_805BAC8;
// 805BACC: using guessed type __int16 word_805BACC;

//----- (08052279) --------------------------------------------------------
int __usercall sub_8052279<eax>(int a1<ecx>, int a2<edi>)
{
  int v2; // edx@9

  if ( dword_805B678 )
    sub_804FF8D(a1, a2, 0);
  if ( status )
    dword_805BA98(status);
  if ( size )
    free((void *)size);
  if ( fd >= 0 )
    close(fd);
  sub_804ECD0();
  sub_804EEE1();
  return __printf_chk(1, ">> \n", v2, v2);
}
// 805BA98: invalid function type has been ignored
// 8048D20: using guessed type int __printf_chk(_DWORD, const char *, ...);
// 805B678: using guessed type int dword_805B678;
// 805BA98: using guessed type int (__cdecl *dword_805BA98)(_DWORD);

//----- (08052300) --------------------------------------------------------
void __cdecl sub_8052300()
{
  ;
}

//----- (08052310) --------------------------------------------------------
int *__cdecl sub_8052310()
{
  init_proc();
  return &dword_805AF00;
}
// 805AF00: using guessed type int dword_805AF00;

//----- (0805236A) --------------------------------------------------------
void __cdecl sub_805236A()
{
  ;
}

//----- (08052370) --------------------------------------------------------
int __cdecl sub_8052370(int a1)
{
  _UNKNOWN *v1; // eax@1

  v1 = &unk_805B0E0;
  if ( &unk_805B0E0 )
    v1 = (_UNKNOWN *)unk_805B0E0;
  return __cxa_atexit(a1, 0, v1);
}
// 8048CA0: using guessed type int __cdecl __cxa_atexit(_DWORD, _DWORD, _DWORD);

//----- (080523B0) --------------------------------------------------------
void (*__cdecl sub_80523B0())(void)
{
  void (*result)(void); // eax@1
  int *v1; // ebx@2

  result = (void (*)(void))dword_805AF00;
  if ( dword_805AF00 != -1 )
  {
    v1 = &dword_805AF00;
    do
    {
      --v1;
      result();
      result = (void (*)(void))*v1;
    }
    while ( *v1 != -1 );
  }
  return result;
}
// 805AF00: using guessed type int dword_805AF00;

//----- (080523DC) --------------------------------------------------------
void __cdecl term_proc()
{
  sub_8049020();
}

#error "There were 3 decompilation failure(s) on 92 function(s)"
